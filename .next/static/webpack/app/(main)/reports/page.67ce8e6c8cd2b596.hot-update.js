"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/(main)/reports/page",{

/***/ "(app-pages-browser)/./src/lib/firebase/services/reports.service.ts":
/*!******************************************************!*\
  !*** ./src/lib/firebase/services/reports.service.ts ***!
  \******************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ReportsService: function() { return /* binding */ ReportsService; },\n/* harmony export */   reportsService: function() { return /* binding */ reportsService; }\n/* harmony export */ });\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"(app-pages-browser)/./node_modules/firebase/firestore/dist/esm/index.esm.js\");\n/* harmony import */ var _lib_firebase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/firebase */ \"(app-pages-browser)/./src/lib/firebase.ts\");\n/* harmony import */ var _base_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./base.service */ \"(app-pages-browser)/./src/lib/firebase/services/base.service.ts\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/constants */ \"(app-pages-browser)/./src/constants/index.ts\");\n/* harmony import */ var _barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! __barrel_optimize__?names=endOfDay,format,getHours,startOfDay!=!date-fns */ \"(app-pages-browser)/./node_modules/date-fns/esm/format/index.js\");\n/* harmony import */ var _barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! __barrel_optimize__?names=endOfDay,format,getHours,startOfDay!=!date-fns */ \"(app-pages-browser)/./node_modules/date-fns/esm/startOfDay/index.js\");\n/* harmony import */ var _barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! __barrel_optimize__?names=endOfDay,format,getHours,startOfDay!=!date-fns */ \"(app-pages-browser)/./node_modules/date-fns/esm/endOfDay/index.js\");\n/* harmony import */ var _barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! __barrel_optimize__?names=endOfDay,format,getHours,startOfDay!=!date-fns */ \"(app-pages-browser)/./node_modules/date-fns/esm/getHours/index.js\");\n\n\n\n\n\n// A helper to create an empty daily report structure\nconst createEmptyDailyReport = (reportDateStr, reportTimestamp)=>{\n    return {\n        id: reportDateStr,\n        reportDate: reportDateStr,\n        reportTimestamp: reportTimestamp,\n        generatedAt: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.now(),\n        generatedBy: \"system\",\n        isFinalized: false,\n        salesMetrics: {\n            totalOrders: 0,\n            completedOrders: 0,\n            cancelledOrders: 0,\n            pendingOrders: 0,\n            totalRevenue: 0,\n            totalQuantitySold: 0,\n            averageOrderValue: 0,\n            paymentMethods: {},\n            hourlyBreakdown: Array.from({\n                length: 24\n            }, (_, i)=>({\n                    hour: i,\n                    orders: 0,\n                    revenue: 0\n                }))\n        },\n        productPerformance: {\n            totalProductsSold: 0,\n            uniqueProductsSold: 0,\n            topProducts: [],\n            categoryBreakdown: {},\n            topVariants: []\n        },\n        staffPerformance: {\n            activeStaff: 0,\n            staffMetrics: [],\n            topSalesPerson: {\n                staffId: \"\",\n                staffName: \"\",\n                revenue: 0\n            }\n        },\n        customerMetrics: {\n            totalCustomers: 0,\n            newCustomers: 0,\n            returningCustomers: 0,\n            vipCustomers: 0,\n            customerSegments: {}\n        },\n        inventoryMetrics: {\n            itemsSold: 0,\n            stockMovements: 0,\n            lowStockAlerts: 0,\n            outOfStockItems: 0,\n            topMovingItems: []\n        },\n        returnMetrics: {\n            totalReturns: 0,\n            returnValue: 0,\n            returnRate: 0,\n            exchangeCount: 0,\n            refundAmount: 0,\n            returnReasons: {}\n        },\n        financialSummary: {\n            grossRevenue: 0,\n            discountAmount: 0,\n            taxAmount: 0,\n            netRevenue: 0,\n            totalCost: 0,\n            grossProfit: 0,\n            grossProfitMargin: 0\n        },\n        comparativeMetrics: {\n            previousDay: {\n                revenueGrowth: 0,\n                orderGrowth: 0,\n                customerGrowth: 0\n            },\n            previousWeek: {\n                revenueGrowth: 0,\n                orderGrowth: 0,\n                averageOrderValueGrowth: 0\n            },\n            monthToDate: {\n                totalRevenue: 0,\n                totalOrders: 0,\n                targetProgress: 0\n            }\n        },\n        operationalMetrics: {\n            averageItemsPerOrder: 0,\n            ordersPerStaff: 0,\n            revenuePerStaff: 0,\n            peakHours: []\n        },\n        qualityMetrics: {\n            customerComplaints: 0,\n            warrantyIssues: 0,\n            productDefects: 0\n        },\n        createdAt: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.now(),\n        updatedAt: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.now(),\n        createdBy: \"system\",\n        updatedBy: \"system\"\n    };\n};\nclass ReportsService extends _base_service__WEBPACK_IMPORTED_MODULE_2__.BaseService {\n    /**\r\n   * Gets a daily report for a specific date. If the report doesn't exist,\r\n   * it generates a new one, saves it, and returns it.\r\n   * This is the primary method to be called from the frontend.\r\n   * @param reportDate The date for which to get or generate the report.\r\n   * @param userId The ID of the user triggering the action.\r\n   */ async getOrGenerateDailyReport(reportDate) {\n        let userId = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : \"system\";\n        const reportDateStr = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(reportDate, \"yyyy-MM-dd\");\n        const reportRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, this.collectionName, reportDateStr);\n        try {\n            // First, try to fetch the existing report.\n            const reportDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(reportRef);\n            if (reportDoc.exists()) {\n                console.log(\"Fetched daily report for \".concat(reportDateStr, \" from cache.\"));\n                return {\n                    success: true,\n                    data: {\n                        id: reportDoc.id,\n                        ...reportDoc.data()\n                    }\n                };\n            }\n            console.log(\"Report for \".concat(reportDateStr, \" not found. Generating new report...\"));\n            // If it doesn't exist, proceed with generation.\n            const dailyReport = createEmptyDailyReport(reportDateStr, firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(reportDate));\n            dailyReport.generatedBy = userId;\n            dailyReport.createdBy = userId;\n            dailyReport.updatedBy = userId;\n            const start = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(reportDate);\n            const end = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(reportDate);\n            // 1. Fetch all sales orders for the given day\n            const ordersRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, _constants__WEBPACK_IMPORTED_MODULE_3__.COLLECTIONS.SALES_ORDERS);\n            const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(ordersRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"orderDate\", \">=\", firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(start)), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"orderDate\", \"<=\", firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(end)));\n            const orderSnapshots = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n            const orders = orderSnapshots.docs.map((doc)=>({\n                    id: doc.id,\n                    ...doc.data()\n                }));\n            // If there are no orders, we still save an empty report to cache this fact.\n            if (orders.length === 0) {\n                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(reportRef, dailyReport);\n                return {\n                    success: true,\n                    data: dailyReport\n                };\n            }\n            // 2. Fetch all order items for these orders\n            let allItems = [];\n            for (const order of orders){\n                const itemsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, _constants__WEBPACK_IMPORTED_MODULE_3__.COLLECTIONS.SALES_ORDERS, order.id, _constants__WEBPACK_IMPORTED_MODULE_3__.SUBCOLLECTIONS.ORDER_ITEMS);\n                const itemsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(itemsRef);\n                itemsSnapshot.forEach((doc)=>{\n                    allItems.push({\n                        id: doc.id,\n                        ...doc.data()\n                    });\n                });\n            }\n            // 3. Process data and populate the report object (Full logic is preserved)\n            const completedOrders = orders.filter((o)=>o.status === \"completed\");\n            // === Sales Metrics ===\n            const sm = dailyReport.salesMetrics;\n            sm.totalOrders = orders.length;\n            sm.completedOrders = completedOrders.length;\n            sm.cancelledOrders = orders.filter((o)=>o.status === \"cancelled\").length;\n            sm.pendingOrders = orders.filter((o)=>o.status.startsWith(\"pending\")).length;\n            sm.totalRevenue = completedOrders.reduce((sum, o)=>sum + o.totalAmount, 0);\n            sm.totalQuantitySold = completedOrders.reduce((sum, o)=>sum + o.totalQuantity, 0);\n            sm.averageOrderValue = sm.completedOrders > 0 ? sm.totalRevenue / sm.completedOrders : 0;\n            orders.forEach((order)=>{\n                // Payment methods\n                const pm = order.paymentMethod;\n                if (!sm.paymentMethods[pm]) {\n                    sm.paymentMethods[pm] = {\n                        orderCount: 0,\n                        totalAmount: 0,\n                        percentage: 0\n                    };\n                }\n                sm.paymentMethods[pm].orderCount++;\n                if (order.status === \"completed\") {\n                    sm.paymentMethods[pm].totalAmount += order.totalAmount;\n                }\n                // Hourly breakdown\n                const hour = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(order.orderDate.toDate());\n                sm.hourlyBreakdown[hour].orders++;\n                if (order.status === \"completed\") {\n                    sm.hourlyBreakdown[hour].revenue += order.totalAmount;\n                }\n            });\n            // Calculate payment method percentages\n            if (sm.totalRevenue > 0) {\n                Object.keys(sm.paymentMethods).forEach((key)=>{\n                    sm.paymentMethods[key].percentage = sm.paymentMethods[key].totalAmount / sm.totalRevenue * 100;\n                });\n            }\n            // === Financial Summary ===\n            const fs = dailyReport.financialSummary;\n            fs.grossRevenue = completedOrders.reduce((sum, o)=>sum + o.subtotalAmount, 0);\n            fs.discountAmount = completedOrders.reduce((sum, o)=>sum + o.discountAmount, 0);\n            fs.taxAmount = completedOrders.reduce((sum, o)=>sum + o.taxAmount, 0);\n            fs.netRevenue = completedOrders.reduce((sum, o)=>sum + o.totalAmount, 0);\n            fs.totalCost = allItems.filter((item)=>completedOrders.some((o)=>o.id === item.salesOrderId)).reduce((sum, item)=>sum + item.unitCost, 0);\n            fs.grossProfit = fs.grossRevenue - fs.totalCost;\n            fs.grossProfitMargin = fs.grossRevenue > 0 ? fs.grossProfit / fs.grossRevenue * 100 : 0;\n            // === Product Performance ===\n            const pp = dailyReport.productPerformance;\n            const soldItems = allItems.filter((item)=>completedOrders.some((o)=>o.id === item.salesOrderId));\n            pp.totalProductsSold = soldItems.length;\n            const productSales = {};\n            const variantSales = {};\n            soldItems.forEach((item)=>{\n                // Product aggregation\n                if (!productSales[item.productId]) {\n                    productSales[item.productId] = {\n                        productId: item.productId,\n                        productName: item.productName,\n                        quantitySold: 0,\n                        revenue: 0,\n                        profit: 0\n                    };\n                }\n                productSales[item.productId].quantitySold += item.quantity;\n                productSales[item.productId].revenue += item.finalPrice;\n                productSales[item.productId].profit += item.finalPrice - item.unitCost;\n                // Variant aggregation\n                if (!variantSales[item.variantId]) {\n                    variantSales[item.variantId] = {\n                        variantId: item.variantId,\n                        productName: item.productName,\n                        colorName: item.colorName,\n                        storageCapacity: item.storageCapacity,\n                        quantitySold: 0,\n                        revenue: 0\n                    };\n                }\n                variantSales[item.variantId].quantitySold += item.quantity;\n                variantSales[item.variantId].revenue += item.finalPrice;\n            });\n            pp.uniqueProductsSold = Object.keys(productSales).length;\n            pp.topProducts = Object.values(productSales).sort((a, b)=>b.revenue - a.revenue).slice(0, 10) // Top 10\n            .map((p)=>({\n                    ...p,\n                    profitMargin: p.revenue > 0 ? p.profit / p.revenue * 100 : 0\n                }));\n            pp.topVariants = Object.values(variantSales).sort((a, b)=>b.revenue - a.revenue).slice(0, 10);\n            // === Staff Performance ===\n            const sp = dailyReport.staffPerformance;\n            const staffMetrics = {};\n            completedOrders.forEach((order)=>{\n                if (!staffMetrics[order.staffId]) {\n                    staffMetrics[order.staffId] = {\n                        staffId: order.staffId,\n                        staffName: order.staffName || \"Unknown\",\n                        ordersProcessed: 0,\n                        revenue: 0,\n                        customers: new Set()\n                    };\n                }\n                const metric = staffMetrics[order.staffId];\n                metric.ordersProcessed++;\n                metric.revenue += order.totalAmount;\n                if (order.customerId) {\n                    metric.customers.add(order.customerId);\n                }\n            });\n            sp.activeStaff = Object.keys(staffMetrics).length;\n            sp.staffMetrics = Object.values(staffMetrics).map((m)=>({\n                    staffId: m.staffId,\n                    staffName: m.staffName,\n                    ordersProcessed: m.ordersProcessed,\n                    revenue: m.revenue,\n                    customerCount: m.customers.size,\n                    averageOrderValue: m.ordersProcessed > 0 ? m.revenue / m.ordersProcessed : 0\n                }));\n            if (sp.staffMetrics.length > 0) {\n                const topSeller = Object.values(staffMetrics).sort((a, b)=>b.revenue - a.revenue)[0];\n                sp.topSalesPerson = {\n                    staffId: topSeller.staffId,\n                    staffName: topSeller.staffName,\n                    revenue: topSeller.revenue\n                };\n            }\n            // === Customer Metrics ===\n            const cm = dailyReport.customerMetrics;\n            const customerIds = new Set();\n            completedOrders.forEach((o)=>{\n                if (o.customerId) customerIds.add(o.customerId);\n            });\n            cm.totalCustomers = customerIds.size;\n            // === Save Report ===\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(reportRef, dailyReport, {\n                merge: true\n            });\n            return {\n                success: true,\n                data: dailyReport\n            };\n        } catch (error) {\n            console.error(\"Error getting or generating daily report for \".concat(reportDateStr, \":\"), error);\n            return this.handleError(error);\n        }\n    }\n    /**\r\n   * Generates and saves a daily sales report for a given date.\r\n   * This operation can be resource-intensive and should be run in a trusted environment (e.g., backend, cloud function).\r\n   * @param reportDate The date for which to generate the report.\r\n   * @param userId The ID of the user triggering the generation.\r\n   */ async generateDailyReport(reportDate) {\n        let userId = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : \"system\";\n        try {\n            const reportDateStr = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(reportDate, \"yyyy-MM-dd\");\n            const reportTimestamp = firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(reportDate);\n            const dailyReport = createEmptyDailyReport(reportDateStr, reportTimestamp);\n            dailyReport.generatedBy = userId;\n            dailyReport.createdBy = userId;\n            dailyReport.updatedBy = userId;\n            const start = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(reportDate);\n            const end = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(reportDate);\n            // 1. Fetch all sales orders for the given day\n            const ordersRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, _constants__WEBPACK_IMPORTED_MODULE_3__.COLLECTIONS.SALES_ORDERS);\n            const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(ordersRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"orderDate\", \">=\", firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(start)), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"orderDate\", \"<=\", firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(end)));\n            const orderSnapshots = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n            const orders = orderSnapshots.docs.map((doc)=>({\n                    id: doc.id,\n                    ...doc.data()\n                }));\n            if (orders.length === 0) {\n                // No sales, save an empty report\n                const emptyReportRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, this.collectionName, reportDateStr);\n                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(emptyReportRef, dailyReport);\n                return {\n                    success: true,\n                    data: dailyReport\n                };\n            }\n            // 2. Fetch all order items for these orders\n            let allItems = [];\n            for (const order of orders){\n                const itemsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, _constants__WEBPACK_IMPORTED_MODULE_3__.COLLECTIONS.SALES_ORDERS, order.id, _constants__WEBPACK_IMPORTED_MODULE_3__.SUBCOLLECTIONS.ORDER_ITEMS);\n                const itemsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(itemsRef);\n                itemsSnapshot.forEach((doc)=>{\n                    allItems.push({\n                        id: doc.id,\n                        ...doc.data()\n                    });\n                });\n            }\n            // 3. Process data and populate the report object\n            const completedOrders = orders.filter((o)=>o.status === \"completed\");\n            // === Sales Metrics ===\n            const sm = dailyReport.salesMetrics;\n            sm.totalOrders = orders.length;\n            sm.completedOrders = completedOrders.length;\n            sm.cancelledOrders = orders.filter((o)=>o.status === \"cancelled\").length;\n            sm.pendingOrders = orders.filter((o)=>o.status.startsWith(\"pending\")).length;\n            sm.totalRevenue = completedOrders.reduce((sum, o)=>sum + o.totalAmount, 0);\n            sm.totalQuantitySold = completedOrders.reduce((sum, o)=>sum + o.totalQuantity, 0);\n            sm.averageOrderValue = sm.completedOrders > 0 ? sm.totalRevenue / sm.completedOrders : 0;\n            orders.forEach((order)=>{\n                // Payment methods\n                const pm = order.paymentMethod;\n                if (!sm.paymentMethods[pm]) {\n                    sm.paymentMethods[pm] = {\n                        orderCount: 0,\n                        totalAmount: 0,\n                        percentage: 0\n                    };\n                }\n                sm.paymentMethods[pm].orderCount++;\n                if (order.status === \"completed\") {\n                    sm.paymentMethods[pm].totalAmount += order.totalAmount;\n                }\n                // Hourly breakdown\n                const hour = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(order.orderDate.toDate());\n                sm.hourlyBreakdown[hour].orders++;\n                if (order.status === \"completed\") {\n                    sm.hourlyBreakdown[hour].revenue += order.totalAmount;\n                }\n            });\n            // Calculate payment method percentages\n            if (sm.totalRevenue > 0) {\n                Object.keys(sm.paymentMethods).forEach((key)=>{\n                    sm.paymentMethods[key].percentage = sm.paymentMethods[key].totalAmount / sm.totalRevenue * 100;\n                });\n            }\n            // === Financial Summary ===\n            const fs = dailyReport.financialSummary;\n            fs.grossRevenue = completedOrders.reduce((sum, o)=>sum + o.subtotalAmount, 0);\n            fs.discountAmount = completedOrders.reduce((sum, o)=>sum + o.discountAmount, 0);\n            fs.taxAmount = completedOrders.reduce((sum, o)=>sum + o.taxAmount, 0);\n            fs.netRevenue = completedOrders.reduce((sum, o)=>sum + o.totalAmount, 0);\n            fs.totalCost = allItems.filter((item)=>completedOrders.some((o)=>o.id === item.salesOrderId)).reduce((sum, item)=>sum + item.unitCost, 0);\n            fs.grossProfit = fs.grossRevenue - fs.totalCost;\n            fs.grossProfitMargin = fs.grossRevenue > 0 ? fs.grossProfit / fs.grossRevenue * 100 : 0;\n            // === Product Performance ===\n            const pp = dailyReport.productPerformance;\n            const soldItems = allItems.filter((item)=>completedOrders.some((o)=>o.id === item.salesOrderId));\n            pp.totalProductsSold = soldItems.length;\n            const productSales = {};\n            const variantSales = {};\n            soldItems.forEach((item)=>{\n                // Product aggregation\n                if (!productSales[item.productId]) {\n                    productSales[item.productId] = {\n                        productId: item.productId,\n                        productName: item.productName,\n                        quantitySold: 0,\n                        revenue: 0,\n                        profit: 0\n                    };\n                }\n                productSales[item.productId].quantitySold += item.quantity;\n                productSales[item.productId].revenue += item.finalPrice;\n                productSales[item.productId].profit += item.finalPrice - item.unitCost;\n                // Variant aggregation\n                if (!variantSales[item.variantId]) {\n                    variantSales[item.variantId] = {\n                        variantId: item.variantId,\n                        productName: item.productName,\n                        colorName: item.colorName,\n                        storageCapacity: item.storageCapacity,\n                        quantitySold: 0,\n                        revenue: 0\n                    };\n                }\n                variantSales[item.variantId].quantitySold += item.quantity;\n                variantSales[item.variantId].revenue += item.finalPrice;\n            });\n            pp.uniqueProductsSold = Object.keys(productSales).length;\n            pp.topProducts = Object.values(productSales).sort((a, b)=>b.revenue - a.revenue).slice(0, 10) // Top 10\n            .map((p)=>({\n                    ...p,\n                    profitMargin: p.revenue > 0 ? p.profit / p.revenue * 100 : 0,\n                    profit: p.profit\n                }));\n            pp.topVariants = Object.values(variantSales).sort((a, b)=>b.revenue - a.revenue).slice(0, 10);\n            // === Staff Performance ===\n            const sp = dailyReport.staffPerformance;\n            const staffMetrics = {};\n            completedOrders.forEach((order)=>{\n                if (!staffMetrics[order.staffId]) {\n                    staffMetrics[order.staffId] = {\n                        staffId: order.staffId,\n                        staffName: order.staffName || \"Unknown\",\n                        ordersProcessed: 0,\n                        revenue: 0,\n                        customers: new Set()\n                    };\n                }\n                const metric = staffMetrics[order.staffId];\n                metric.ordersProcessed++;\n                metric.revenue += order.totalAmount;\n                if (order.customerId) {\n                    metric.customers.add(order.customerId);\n                }\n            });\n            sp.activeStaff = Object.keys(staffMetrics).length;\n            sp.staffMetrics = Object.values(staffMetrics).map((m)=>({\n                    staffId: m.staffId,\n                    staffName: m.staffName,\n                    ordersProcessed: m.ordersProcessed,\n                    revenue: m.revenue,\n                    customerCount: m.customers.size,\n                    averageOrderValue: m.ordersProcessed > 0 ? m.revenue / m.ordersProcessed : 0\n                }));\n            if (sp.staffMetrics.length > 0) {\n                const topSeller = Object.values(staffMetrics).sort((a, b)=>b.revenue - a.revenue)[0];\n                sp.topSalesPerson = {\n                    staffId: topSeller.staffId,\n                    staffName: topSeller.staffName,\n                    revenue: topSeller.revenue\n                };\n            }\n            // === Customer Metrics ===\n            // This is a simplified version. For accurate new/returning, we need to check customer's history.\n            const cm = dailyReport.customerMetrics;\n            const customerIds = new Set();\n            completedOrders.forEach((o)=>{\n                if (o.customerId) customerIds.add(o.customerId);\n            });\n            cm.totalCustomers = customerIds.size;\n            // This requires fetching each customer doc, can be slow. A better approach is to use a summary field on the customer doc\n            // or use a separate analytics service/cloud function. For now, this is omitted for performance reasons.\n            // cm.newCustomers = ...\n            // cm.returningCustomers = ...\n            // === Save Report ===\n            const reportRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, this.collectionName, reportDateStr);\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(reportRef, dailyReport, {\n                merge: true\n            });\n            return {\n                success: true,\n                data: dailyReport\n            };\n        } catch (error) {\n            console.error(\"Error generating daily report:\", error);\n            return this.handleError(error);\n        }\n    }\n    constructor(){\n        super(_constants__WEBPACK_IMPORTED_MODULE_3__.COLLECTIONS.REPORTS);\n    }\n}\nconst reportsService = new ReportsService();\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9saWIvZmlyZWJhc2Uvc2VydmljZXMvcmVwb3J0cy5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFVNEI7QUFDUTtBQUlaO0FBTWtDO0FBUXhDO0FBRWxCLHFEQUFxRDtBQUNyRCxNQUFNZ0IseUJBQXlCLENBQzdCQyxlQUNBQztJQUVBLE9BQU87UUFDTEMsSUFBSUY7UUFDSkcsWUFBWUg7UUFDWkMsaUJBQWlCQTtRQUNqQkcsYUFBYWhCLHlEQUFTQSxDQUFDaUIsR0FBRztRQUMxQkMsYUFBYTtRQUNiQyxhQUFhO1FBQ2JDLGNBQWM7WUFDWkMsYUFBYTtZQUNiQyxpQkFBaUI7WUFDakJDLGlCQUFpQjtZQUNqQkMsZUFBZTtZQUNmQyxjQUFjO1lBQ2RDLG1CQUFtQjtZQUNuQkMsbUJBQW1CO1lBQ25CQyxnQkFBZ0IsQ0FBQztZQUNqQkMsaUJBQWlCQyxNQUFNQyxJQUFJLENBQUM7Z0JBQUVDLFFBQVE7WUFBRyxHQUFHLENBQUNDLEdBQUdDLElBQU87b0JBQ3JEQyxNQUFNRDtvQkFDTkUsUUFBUTtvQkFDUkMsU0FBUztnQkFDWDtRQUNGO1FBQ0FDLG9CQUFvQjtZQUNsQkMsbUJBQW1CO1lBQ25CQyxvQkFBb0I7WUFDcEJDLGFBQWEsRUFBRTtZQUNmQyxtQkFBbUIsQ0FBQztZQUNwQkMsYUFBYSxFQUFFO1FBQ2pCO1FBQ0FDLGtCQUFrQjtZQUNoQkMsYUFBYTtZQUNiQyxjQUFjLEVBQUU7WUFDaEJDLGdCQUFnQjtnQkFBRUMsU0FBUztnQkFBSUMsV0FBVztnQkFBSVosU0FBUztZQUFFO1FBQzNEO1FBQ0FhLGlCQUFpQjtZQUNmQyxnQkFBZ0I7WUFDaEJDLGNBQWM7WUFDZEMsb0JBQW9CO1lBQ3BCQyxjQUFjO1lBQ2RDLGtCQUFrQixDQUFDO1FBQ3JCO1FBQ0FDLGtCQUFrQjtZQUNoQkMsV0FBVztZQUNYQyxnQkFBZ0I7WUFDaEJDLGdCQUFnQjtZQUNoQkMsaUJBQWlCO1lBQ2pCQyxnQkFBZ0IsRUFB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LFNBQVNxSSxVQUFVckksT0FBTztvQkFDMUJDLFdBQVdvSSxVQUFVcEksU0FBUztvQkFDOUJaLFNBQVNnSixVQUFVaEosT0FBTztnQkFDNUI7WUFDRjtZQUVBLDJCQUEyQjtZQUMzQixpR0FBaUc7WUFDakcsTUFBTWlKLEtBQUt4RSxZQUFZNUQsZUFBZTtZQUN0QyxNQUFNcUksY0FBYyxJQUFJVDtZQUN4QnhKLGdCQUFnQnVHLE9BQU8sQ0FBQ0csQ0FBQUE7Z0JBQ3RCLElBQUdBLEVBQUVnRCxVQUFVLEVBQUVPLFlBQVlOLEdBQUcsQ0FBQ2pELEVBQUVnRCxVQUFVO1lBQy9DO1lBQ0FNLEdBQUduSSxjQUFjLEdBQUdvSSxZQUFZSCxJQUFJO1lBQ3BDLHlIQUF5SDtZQUN6SCx3R0FBd0c7WUFDeEcsd0JBQXdCO1lBQ3hCLDhCQUE4QjtZQUU5QixzQkFBc0I7WUFDdEIsTUFBTTlFLFlBQVkxRyx1REFBR0EsQ0FBQ08sNkNBQUVBLEVBQUUsSUFBSSxDQUFDb0csY0FBYyxFQUFFM0Y7WUFDL0MsTUFBTVYsMERBQU1BLENBQUNvRyxXQUFXUSxhQUFhO2dCQUFFMEUsT0FBTztZQUFLO1lBRW5ELE9BQU87Z0JBQUU1RSxTQUFTO2dCQUFNQyxNQUFNQztZQUFZO1FBQzVDLEVBQUUsT0FBTzJFLE9BQU87WUFDZC9FLFFBQVErRSxLQUFLLENBQUMsa0NBQWtDQTtZQUNoRCxPQUFPLElBQUksQ0FBQ0MsV0FBVyxDQUFDRDtRQUMxQjtJQUNGO0lBMWVBSSxhQUFjO1FBQ1osS0FBSyxDQUFDeEwsbURBQVdBLENBQUN5TCxPQUFPO0lBQzNCO0FBeWVGO0FBRU8sTUFBTUMsaUJBQWlCLElBQUk1RixpQkFBaUIiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9fTl9FLy4vc3JjL2xpYi9maXJlYmFzZS9zZXJ2aWNlcy9yZXBvcnRzLnNlcnZpY2UudHM/ZjAzNiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge1xyXG4gIGNvbGxlY3Rpb24sXHJcbiAgZG9jLFxyXG4gIGdldERvY3MsXHJcbiAgcXVlcnksXHJcbiAgd2hlcmUsXHJcbiAgVGltZXN0YW1wLFxyXG4gIGdldERvYyxcclxuICBzZXREb2MsXHJcbiAgb3JkZXJCeSxcclxufSBmcm9tIFwiZmlyZWJhc2UvZmlyZXN0b3JlXCI7XHJcbmltcG9ydCB7IGRiIH0gZnJvbSBcIkAvbGliL2ZpcmViYXNlXCI7XHJcbmltcG9ydCB7XHJcbiAgQmFzZVNlcnZpY2UsXHJcbiAgU2VydmljZVJlc3BvbnNlLFxyXG59IGZyb20gXCIuL2Jhc2Uuc2VydmljZVwiO1xyXG5pbXBvcnQge1xyXG4gIEZpcmViYXNlU2FsZXNPcmRlcixcclxuICBGaXJlYmFzZVNhbGVzT3JkZXJJdGVtLFxyXG59IGZyb20gXCJAL2xpYi9maXJlYmFzZS9tb2RlbHMvcG9zLm1vZGVsXCI7XHJcbmltcG9ydCB7IEZpcmViYXNlRGFpbHlSZXBvcnQgfSBmcm9tIFwiQC9saWIvZmlyZWJhc2UvbW9kZWxzL3JlcG9ydHMubW9kZWxcIjtcclxuaW1wb3J0IHsgQ09MTEVDVElPTlMsIFNVQkNPTExFQ1RJT05TIH0gZnJvbSBcIkAvY29uc3RhbnRzXCI7XHJcbmltcG9ydCB7XHJcbiAgZm9ybWF0LFxyXG4gIHN0YXJ0T2ZEYXksXHJcbiAgZW5kT2ZEYXksXHJcbiAgc3ViRGF5cyxcclxuICBnZXRIb3VycyxcclxuICBzdGFydE9mSG91cixcclxufSBmcm9tIFwiZGF0ZS1mbnNcIjtcclxuXHJcbi8vIEEgaGVscGVyIHRvIGNyZWF0ZSBhbiBlbXB0eSBkYWlseSByZXBvcnQgc3RydWN0dXJlXHJcbmNvbnN0IGNyZWF0ZUVtcHR5RGFpbHlSZXBvcnQgPSAoXHJcbiAgcmVwb3J0RGF0ZVN0cjogc3RyaW5nLFxyXG4gIHJlcG9ydFRpbWVzdGFtcDogVGltZXN0YW1wXHJcbik6IEZpcmViYXNlRGFpbHlSZXBvcnQgPT4ge1xyXG4gIHJldHVybiB7XHJcbiAgICBpZDogcmVwb3J0RGF0ZVN0cixcclxuICAgIHJlcG9ydERhdGU6IHJlcG9ydERhdGVTdHIsXHJcbiAgICByZXBvcnRUaW1lc3RhbXA6IHJlcG9ydFRpbWVzdGFtcCxcclxuICAgIGdlbmVyYXRlZEF0OiBUaW1lc3RhbXAubm93KCksXHJcbiAgICBnZW5lcmF0ZWRCeTogXCJzeXN0ZW1cIiwgLy8gT3IgcGFzcyB1c2VySWRcclxuICAgIGlzRmluYWxpemVkOiBmYWxzZSxcclxuICAgIHNhbGVzTWV0cmljczoge1xyXG4gICAgICB0b3RhbE9yZGVyczogMCxcclxuICAgICAgY29tcGxldGVkT3JkZXJzOiAwLFxyXG4gICAgICBjYW5jZWxsZWRPcmRlcnM6IDAsXHJcbiAgICAgIHBlbmRpbmdPcmRlcnM6IDAsXHJcbiAgICAgIHRvdGFsUmV2ZW51ZTogMCxcclxuICAgICAgdG90YWxRdWFudGl0eVNvbGQ6IDAsXHJcbiAgICAgIGF2ZXJhZ2VPcmRlclZhbHVlOiAwLFxyXG4gICAgICBwYXltZW50TWV0aG9kczoge30sXHJcbiAgICAgIGhvdXJseUJyZWFrZG93bjogQXJyYXkuZnJvbSh7IGxlbmd0aDogMjQgfSwgKF8sIGkpID0+ICh7XHJcbiAgICAgICAgaG91cjogaSxcclxuICAgICAgICBvcmRlcnM6IDAsXHJcbiAgICAgICAgcmV2ZW51ZTogMCxcclxuICAgICAgfSkpLFxyXG4gICAgfSxcclxuICAgIHByb2R1Y3RQZXJmb3JtYW5jZToge1xyXG4gICAgICB0b3RhbFByb2R1Y3RzU29sZDogMCxcclxuICAgICAgdW5pcXVlUHJvZHVjdHNTb2xkOiAwLFxyXG4gICAgICB0b3BQcm9kdWN0czogW10sXHJcbiAgICAgIGNhdGVnb3J5QnJlYWtkb3duOiB7fSxcclxuICAgICAgdG9wVmFyaWFudHM6IFtdLFxyXG4gICAgfSxcclxuICAgIHN0YWZmUGVyZm9ybWFuY2U6IHtcclxuICAgICAgYWN0aXZlU3RhZmY6IDAsXHJcbiAgICAgIHN0YWZmTWV0cmljczogW10sXHJcbiAgICAgIHRvcFNhbGVzUGVyc29uOiB7IHN0YWZmSWQ6IFwiXCIsIHN0YWZmTmFtZTogXCJcIiwgcmV2ZW51ZTogMCB9LFxyXG4gICAgfSxcclxuICAgIGN1c3RvbWVyTWV0cmljczoge1xyXG4gICAgICB0b3RhbEN1c3RvbWVyczogMCxcclxuICAgICAgbmV3Q3VzdG9tZXJzOiAwLFxyXG4gICAgICByZXR1cm5pbmdDdXN0b21lcnM6IDAsXHJcbiAgICAgIHZpcEN1c3RvbWVyczogMCxcclxuICAgICAgY3VzdG9tZXJTZWdtZW50czoge30sXHJcbiAgICB9LFxyXG4gICAgaW52ZW50b3J5TWV0cmljczoge1xyXG4gICAgICBpdGVtc1NvbGQ6IDAsXHJcbiAgICAgIHN0b2NrTW92ZW1lbnRzOiAwLFxyXG4gICAgICBsb3dTdG9ja0FsZXJ0czogMCxcclxuICAgICAgb3V0T2ZTdG9ja0l0ZW1zOiAwLFxyXG4gICAgICB0b3BNb3ZpbmdJdGVtczogW10sXHJcbiAgICB9LFxyXG4gICAgcmV0dXJuTWV0cmljczoge1xyXG4gICAgICB0b3RhbFJldHVybnM6IDAsXHJcbiAgICAgIHJldHVyblZhbHVlOiAwLFxyXG4gICAgICByZXR1cm5SYXRlOiAwLFxyXG4gICAgICBleGNoYW5nZUNvdW50OiAwLFxyXG4gICAgICByZWZ1bmRBbW91bnQ6IDAsXHJcbiAgICAgIHJldHVyblJlYXNvbnM6IHt9LFxyXG4gICAgfSxcclxuICAgIGZpbmFuY2lhbFN1bW1hcnk6IHtcclxuICAgICAgZ3Jvc3NSZXZlbnVlOiAwLFxyXG4gICAgICBkaXNjb3VudEFtb3VudDogMCxcclxuICAgICAgdGF4QW1vdW50OiAwLFxyXG4gICAgICBuZXRSZXZlbnVlOiAwLFxyXG4gICAgICB0b3RhbENvc3Q6IDAsXHJcbiAgICAgIGdyb3NzUHJvZml0OiAwLFxyXG4gICAgICBncm9zc1Byb2ZpdE1hcmdpbjogMCxcclxuICAgIH0sXHJcbiAgICBjb21wYXJhdGl2ZU1ldHJpY3M6IHtcclxuICAgICAgcHJldmlvdXNEYXk6IHsgcmV2ZW51ZUdyb3d0aDogMCwgb3JkZXJHcm93dGg6IDAsIGN1c3RvbWVyR3Jvd3RoOiAwIH0sXHJcbiAgICAgIHByZXZpb3VzV2Vlazoge1xyXG4gICAgICAgIHJldmVudWVHcm93dGg6IDAsXHJcbiAgICAgICAgb3JkZXJHcm93dGg6IDAsXHJcbiAgICAgICAgYXZlcmFnZU9yZGVyVmFsdWVHcm93dGg6IDAsXHJcbiAgICAgIH0sXHJcbiAgICAgIG1vbnRoVG9EYXRlOiB7IHRvdGFsUmV2ZW51ZTogMCwgdG90YWxPcmRlcnM6IDAsIHRhcmdldFByb2dyZXNzOiAwIH0sXHJcbiAgICB9LFxyXG4gICAgb3BlcmF0aW9uYWxNZXRyaWNzOiB7XHJcbiAgICAgIGF2ZXJhZ2VJdGVtc1Blck9yZGVyOiAwLFxyXG4gICAgICBvcmRlcnNQZXJTdGFmZjogMCxcclxuICAgICAgcmV2ZW51ZVBlclN0YWZmOiAwLFxyXG4gICAgICBwZWFrSG91cnM6IFtdLFxyXG4gICAgfSxcclxuICAgIHF1YWxpdHlNZXRyaWNzOiB7XHJcbiAgICAgIGN1c3RvbWVyQ29tcGxhaW50czogMCxcclxuICAgICAgd2FycmFudHlJc3N1ZXM6IDAsXHJcbiAgICAgIHByb2R1Y3REZWZlY3RzOiAwLFxyXG4gICAgfSxcclxuICAgIGNyZWF0ZWRBdDogVGltZXN0YW1wLm5vdygpLFxyXG4gICAgdXBkYXRlZEF0OiBUaW1lc3RhbXAubm93KCksXHJcbiAgICBjcmVhdGVkQnk6IFwic3lzdGVtXCIsXHJcbiAgICB1cGRhdGVkQnk6IFwic3lzdGVtXCIsXHJcbiAgfTtcclxufTtcclxuXHJcbmV4cG9ydCBjbGFzcyBSZXBvcnRzU2VydmljZSBleHRlbmRzIEJhc2VTZXJ2aWNlIHtcclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIHN1cGVyKENPTExFQ1RJT05TLlJFUE9SVFMpO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2V0cyBhIGRhaWx5IHJlcG9ydCBmb3IgYSBzcGVjaWZpYyBkYXRlLiBJZiB0aGUgcmVwb3J0IGRvZXNuJ3QgZXhpc3QsXHJcbiAgICogaXQgZ2VuZXJhdGVzIGEgbmV3IG9uZSwgc2F2ZXMgaXQsIGFuZCByZXR1cm5zIGl0LlxyXG4gICAqIFRoaXMgaXMgdGhlIHByaW1hcnkgbWV0aG9kIHRvIGJlIGNhbGxlZCBmcm9tIHRoZSBmcm9udGVuZC5cclxuICAgKiBAcGFyYW0gcmVwb3J0RGF0ZSBUaGUgZGF0ZSBmb3Igd2hpY2ggdG8gZ2V0IG9yIGdlbmVyYXRlIHRoZSByZXBvcnQuXHJcbiAgICogQHBhcmFtIHVzZXJJZCBUaGUgSUQgb2YgdGhlIHVzZXIgdHJpZ2dlcmluZyB0aGUgYWN0aW9uLlxyXG4gICAqL1xyXG4gIGFzeW5jIGdldE9yR2VuZXJhdGVEYWlseVJlcG9ydChcclxuICAgIHJlcG9ydERhdGU6IERhdGUsXHJcbiAgICB1c2VySWQ6IHN0cmluZyA9IFwic3lzdGVtXCJcclxuICApOiBQcm9taXNlPFNlcnZpY2VSZXNwb25zZTxGaXJlYmFzZURhaWx5UmVwb3J0Pj4ge1xyXG4gICAgY29uc3QgcmVwb3J0RGF0ZVN0ciA9IGZvcm1hdChyZXBvcnREYXRlLCBcInl5eXktTU0tZGRcIik7XHJcbiAgICBjb25zdCByZXBvcnRSZWYgPSBkb2MoZGIsIHRoaXMuY29sbGVjdGlvbk5hbWUsIHJlcG9ydERhdGVTdHIpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIC8vIEZpcnN0LCB0cnkgdG8gZmV0Y2ggdGhlIGV4aXN0aW5nIHJlcG9ydC5cclxuICAgICAgY29uc3QgcmVwb3J0RG9jID0gYXdhaXQgZ2V0RG9jKHJlcG9ydFJlZik7XHJcbiAgICAgIGlmIChyZXBvcnREb2MuZXhpc3RzKCkpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhgRmV0Y2hlZCBkYWlseSByZXBvcnQgZm9yICR7cmVwb3J0RGF0ZVN0cn0gZnJvbSBjYWNoZS5gKTtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogdHJ1ZSxcclxuICAgICAgICAgIGRhdGE6IHsgaWQ6IHJlcG9ydERvYy5pZCwgLi4ucmVwb3J0RG9jLmRhdGEoKSB9IGFzIEZpcmViYXNlRGFpbHlSZXBvcnQsXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgY29uc29sZS5sb2coYFJlcG9ydCBmb3IgJHtyZXBvcnREYXRlU3RyfSBub3QgZm91bmQuIEdlbmVyYXRpbmcgbmV3IHJlcG9ydC4uLmApO1xyXG4gICAgICAvLyBJZiBpdCBkb2Vzbid0IGV4aXN0LCBwcm9jZWVkIHdpdGggZ2VuZXJhdGlvbi5cclxuICAgICAgY29uc3QgZGFpbHlSZXBvcnQgPSBjcmVhdGVFbXB0eURhaWx5UmVwb3J0KFxyXG4gICAgICAgIHJlcG9ydERhdGVTdHIsXHJcbiAgICAgICAgVGltZXN0YW1wLmZyb21EYXRlKHJlcG9ydERhdGUpXHJcbiAgICAgICk7XHJcbiAgICAgIGRhaWx5UmVwb3J0LmdlbmVyYXRlZEJ5ID0gdXNlcklkO1xyXG4gICAgICBkYWlseVJlcG9ydC5jcmVhdGVkQnkgPSB1c2VySWQ7XHJcbiAgICAgIGRhaWx5UmVwb3J0LnVwZGF0ZWRCeSA9IHVzZXJJZDtcclxuXHJcbiAgICAgIGNvbnN0IHN0YXJ0ID0gc3RhcnRPZkRheShyZXBvcnREYXRlKTtcclxuICAgICAgY29uc3QgZW5kID0gZW5kT2ZEYXkocmVwb3J0RGF0ZSk7XHJcblxyXG4gICAgICAvLyAxLiBGZXRjaCBhbGwgc2FsZXMgb3JkZXJzIGZvciB0aGUgZ2l2ZW4gZGF5XHJcbiAgICAgIGNvbnN0IG9yZGVyc1JlZiA9IGNvbGxlY3Rpb24oZGIsIENPTExFQ1RJT05TLlNBTEVTX09SREVSUyk7XHJcbiAgICAgIGNvbnN0IHEgPSBxdWVyeShcclxuICAgICAgICBvcmRlcnNSZWYsXHJcbiAgICAgICAgd2hlcmUoXCJvcmRlckRhdGVcIiwgXCI+PVwiLCBUaW1lc3RhbXAuZnJvbURhdGUoc3RhcnQpKSxcclxuICAgICAgICB3aGVyZShcIm9yZGVyRGF0ZVwiLCBcIjw9XCIsIFRpbWVzdGFtcC5mcm9tRGF0ZShlbmQpKVxyXG4gICAgICApO1xyXG4gICAgICBjb25zdCBvcmRlclNuYXBzaG90cyA9IGF3YWl0IGdldERvY3MocSk7XHJcbiAgICAgIGNvbnN0IG9yZGVycyA9IG9yZGVyU25hcHNob3RzLmRvY3MubWFwKFxyXG4gICAgICAgIChkb2MpID0+ICh7IGlkOiBkb2MuaWQsIC4uLmRvYy5kYXRhKCkgfSBhcyBGaXJlYmFzZVNhbGVzT3JkZXIpXHJcbiAgICAgICk7XHJcblxyXG4gICAgICAvLyBJZiB0aGVyZSBhcmUgbm8gb3JkZXJzLCB3ZSBzdGlsbCBzYXZlIGFuIGVtcHR5IHJlcG9ydCB0byBjYWNoZSB0aGlzIGZhY3QuXHJcbiAgICAgIGlmIChvcmRlcnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgYXdhaXQgc2V0RG9jKHJlcG9ydFJlZiwgZGFpbHlSZXBvcnQpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGRhaWx5UmVwb3J0IH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIDIuIEZldGNoIGFsbCBvcmRlciBpdGVtcyBmb3IgdGhlc2Ugb3JkZXJzXHJcbiAgICAgIGxldCBhbGxJdGVtczogRmlyZWJhc2VTYWxlc09yZGVySXRlbVtdID0gW107XHJcbiAgICAgIGZvciAoY29uc3Qgb3JkZXIgb2Ygb3JkZXJzKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbXNSZWYgPSBjb2xsZWN0aW9uKFxyXG4gICAgICAgICAgZGIsXHJcbiAgICAgICAgICBDT0xMRUNUSU9OUy5TQUxFU19PUkRFUlMsXHJcbiAgICAgICAgICBvcmRlci5pZCxcclxuICAgICAgICAgIFNVQkNPTExFQ1RJT05TLk9SREVSX0lURU1TXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjb25zdCBpdGVtc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhpdGVtc1JlZik7XHJcbiAgICAgICAgaXRlbXNTbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHtcclxuICAgICAgICAgIGFsbEl0ZW1zLnB1c2goeyBpZDogZG9jLmlkLCAuLi5kb2MuZGF0YSgpIH0gYXMgRmlyZWJhc2VTYWxlc09yZGVySXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIDMuIFByb2Nlc3MgZGF0YSBhbmQgcG9wdWxhdGUgdGhlIHJlcG9ydCBvYmplY3QgKEZ1bGwgbG9naWMgaXMgcHJlc2VydmVkKVxyXG4gICAgICBjb25zdCBjb21wbGV0ZWRPcmRlcnMgPSBvcmRlcnMuZmlsdGVyKChvKSA9PiBvLnN0YXR1cyA9PT0gXCJjb21wbGV0ZWRcIik7XHJcblxyXG4gICAgICAvLyA9PT0gU2FsZXMgTWV0cmljcyA9PT1cclxuICAgICAgY29uc3Qgc20gPSBkYWlseVJlcG9ydC5zYWxlc01ldHJpY3M7XHJcbiAgICAgIHNtLnRvdGFsT3JkZXJzID0gb3JkZXJzLmxlbmd0aDtcclxuICAgICAgc20uY29tcGxldGVkT3JkZXJzID0gY29tcGxldGVkT3JkZXJzLmxlbmd0aDtcclxuICAgICAgc20uY2FuY2VsbGVkT3JkZXJzID0gb3JkZXJzLmZpbHRlcihcclxuICAgICAgICAobykgPT4gby5zdGF0dXMgPT09IFwiY2FuY2VsbGVkXCJcclxuICAgICAgKS5sZW5ndGg7XHJcbiAgICAgIHNtLnBlbmRpbmdPcmRlcnMgPSBvcmRlcnMuZmlsdGVyKChvKSA9PlxyXG4gICAgICAgIG8uc3RhdHVzLnN0YXJ0c1dpdGgoXCJwZW5kaW5nXCIpXHJcbiAgICAgICkubGVuZ3RoO1xyXG4gICAgICBzbS50b3RhbFJldmVudWUgPSBjb21wbGV0ZWRPcmRlcnMucmVkdWNlKFxyXG4gICAgICAgIChzdW0sIG8pID0+IHN1bSArIG8udG90YWxBbW91bnQsXHJcbiAgICAgICAgMFxyXG4gICAgICApO1xyXG4gICAgICBzbS50b3RhbFF1YW50aXR5U29sZCA9IGNvbXBsZXRlZE9yZGVycy5yZWR1Y2UoXHJcbiAgICAgICAgKHN1bSwgbykgPT4gc3VtICsgby50b3RhbFF1YW50aXR5LFxyXG4gICAgICAgIDBcclxuICAgICAgKTtcclxuICAgICAgc20uYXZlcmFnZU9yZGVyVmFsdWUgPVxyXG4gICAgICAgIHNtLmNvbXBsZXRlZE9yZGVycyA+IDAgPyBzbS50b3RhbFJldmVudWUgLyBzbS5jb21wbGV0ZWRPcmRlcnMgOiAwO1xyXG5cclxuICAgICAgb3JkZXJzLmZvckVhY2goKG9yZGVyKSA9PiB7XHJcbiAgICAgICAgLy8gUGF5bWVudCBtZXRob2RzXHJcbiAgICAgICAgY29uc3QgcG0gPSBvcmRlci5wYXltZW50TWV0aG9kO1xyXG4gICAgICAgIGlmICghc20ucGF5bWVudE1ldGhvZHNbcG1dKSB7XHJcbiAgICAgICAgICBzbS5wYXltZW50TWV0aG9kc1twbV0gPSB7XHJcbiAgICAgICAgICAgIG9yZGVyQ291bnQ6IDAsXHJcbiAgICAgICAgICAgIHRvdGFsQW1vdW50OiAwLFxyXG4gICAgICAgICAgICBwZXJjZW50YWdlOiAwLFxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgc20ucGF5bWVudE1ldGhvZHNbcG1dLm9yZGVyQ291bnQrKztcclxuICAgICAgICBpZiAob3JkZXIuc3RhdHVzID09PSBcImNvbXBsZXRlZFwiKSB7XHJcbiAgICAgICAgICBzbS5wYXltZW50TWV0aG9kc1twbV0udG90YWxBbW91bnQgKz0gb3JkZXIudG90YWxBbW91bnQ7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyBIb3VybHkgYnJlYWtkb3duXHJcbiAgICAgICAgY29uc3QgaG91ciA9IGdldEhvdXJzKG9yZGVyLm9yZGVyRGF0ZS50b0RhdGUoKSk7XHJcbiAgICAgICAgc20uaG91cmx5QnJlYWtkb3duW2hvdXJdLm9yZGVycysrO1xyXG4gICAgICAgIGlmIChvcmRlci5zdGF0dXMgPT09IFwiY29tcGxldGVkXCIpIHtcclxuICAgICAgICAgIHNtLmhvdXJseUJyZWFrZG93bltob3VyXS5yZXZlbnVlICs9IG9yZGVyLnRvdGFsQW1vdW50O1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcbiAgICAgIC8vIENhbGN1bGF0ZSBwYXltZW50IG1ldGhvZCBwZXJjZW50YWdlc1xyXG4gICAgICBpZiAoc20udG90YWxSZXZlbnVlID4gMCkge1xyXG4gICAgICAgIE9iamVjdC5rZXlzKHNtLnBheW1lbnRNZXRob2RzKS5mb3JFYWNoKChrZXkpID0+IHtcclxuICAgICAgICAgIHNtLnBheW1lbnRNZXRob2RzW2tleV0ucGVyY2VudGFnZSA9XHJcbiAgICAgICAgICAgIChzbS5wYXltZW50TWV0aG9kc1trZXldLnRvdGFsQW1vdW50IC8gc20udG90YWxSZXZlbnVlKSAqIDEwMDtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gPT09IEZpbmFuY2lhbCBTdW1tYXJ5ID09PVxyXG4gICAgICBjb25zdCBmcyA9IGRhaWx5UmVwb3J0LmZpbmFuY2lhbFN1bW1hcnk7XHJcbiAgICAgIGZzLmdyb3NzUmV2ZW51ZSA9IGNvbXBsZXRlZE9yZGVycy5yZWR1Y2UoXHJcbiAgICAgICAgKHN1bSwgbykgPT4gc3VtICsgby5zdWJ0b3RhbEFtb3VudCxcclxuICAgICAgICAwXHJcbiAgICAgICk7XHJcbiAgICAgIGZzLmRpc2NvdW50QW1vdW50ID0gY29tcGxldGVkT3JkZXJzLnJlZHVjZShcclxuICAgICAgICAoc3VtLCBvKSA9PiBzdW0gKyBvLmRpc2NvdW50QW1vdW50LFxyXG4gICAgICAgIDBcclxuICAgICAgKTtcclxuICAgICAgZnMudGF4QW1vdW50ID0gY29tcGxldGVkT3JkZXJzLnJlZHVjZSgoc3VtLCBvKSA9PiBzdW0gKyBvLnRheEFtb3VudCwgMCk7XHJcbiAgICAgIGZzLm5ldFJldmVudWUgPSBjb21wbGV0ZWRPcmRlcnMucmVkdWNlKFxyXG4gICAgICAgIChzdW0sIG8pID0+IHN1bSArIG8udG90YWxBbW91bnQsXHJcbiAgICAgICAgMFxyXG4gICAgICApO1xyXG4gICAgICBmcy50b3RhbENvc3QgPSBhbGxJdGVtc1xyXG4gICAgICAgIC5maWx0ZXIoKGl0ZW0pID0+XHJcbiAgICAgICAgICBjb21wbGV0ZWRPcmRlcnMuc29tZSgobykgPT4gby5pZCA9PT0gaXRlbS5zYWxlc09yZGVySWQpXHJcbiAgICAgICAgKVxyXG4gICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgaXRlbS51bml0Q29zdCwgMCk7XHJcbiAgICAgIGZzLmdyb3NzUHJvZml0ID0gZnMuZ3Jvc3NSZXZlbnVlIC0gZnMudG90YWxDb3N0O1xyXG4gICAgICBmcy5ncm9zc1Byb2ZpdE1hcmdpbiA9XHJcbiAgICAgICAgZnMuZ3Jvc3NSZXZlbnVlID4gMCA/IChmcy5ncm9zc1Byb2ZpdCAvIGZzLmdyb3NzUmV2ZW51ZSkgKiAxMDAgOiAwO1xyXG5cclxuICAgICAgLy8gPT09IFByb2R1Y3QgUGVyZm9ybWFuY2UgPT09XHJcbiAgICAgIGNvbnN0IHBwID0gZGFpbHlSZXBvcnQucHJvZHVjdFBlcmZvcm1hbmNlO1xyXG4gICAgICBjb25zdCBzb2xkSXRlbXMgPSBhbGxJdGVtcy5maWx0ZXIoKGl0ZW0pID0+XHJcbiAgICAgICAgY29tcGxldGVkT3JkZXJzLnNvbWUoKG8pID0+IG8uaWQgPT09IGl0ZW0uc2FsZXNPcmRlcklkKVxyXG4gICAgICApO1xyXG4gICAgICBwcC50b3RhbFByb2R1Y3RzU29sZCA9IHNvbGRJdGVtcy5sZW5ndGg7XHJcblxyXG4gICAgICBjb25zdCBwcm9kdWN0U2FsZXM6IHtcclxuICAgICAgICBbcHJvZHVjdElkOiBzdHJpbmddOiB7XHJcbiAgICAgICAgICBwcm9kdWN0SWQ6IHN0cmluZztcclxuICAgICAgICAgIHByb2R1Y3ROYW1lOiBzdHJpbmc7XHJcbiAgICAgICAgICBxdWFudGl0eVNvbGQ6IG51bWJlcjtcclxuICAgICAgICAgIHJldmVudWU6IG51bWJlcjtcclxuICAgICAgICAgIHByb2ZpdDogbnVtYmVyO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0gPSB7fTtcclxuICAgICAgY29uc3QgdmFyaWFudFNhbGVzOiB7XHJcbiAgICAgICAgW3ZhcmlhbnRJZDogc3RyaW5nXToge1xyXG4gICAgICAgICAgdmFyaWFudElkOiBzdHJpbmc7XHJcbiAgICAgICAgICBwcm9kdWN0TmFtZTogc3RyaW5nO1xyXG4gICAgICAgICAgY29sb3JOYW1lOiBzdHJpbmc7XHJcbiAgICAgICAgICBzdG9yYWdlQ2FwYWNpdHk6IHN0cmluZztcclxuICAgICAgICAgIHF1YW50aXR5U29sZDogbnVtYmVyO1xyXG4gICAgICAgICAgcmV2ZW51ZTogbnVtYmVyO1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0gPSB7fTtcclxuXHJcbiAgICAgIHNvbGRJdGVtcy5mb3JFYWNoKChpdGVtKSA9PiB7XHJcbiAgICAgICAgLy8gUHJvZHVjdCBhZ2dyZWdhdGlvblxyXG4gICAgICAgIGlmICghcHJvZHVjdFNhbGVzW2l0ZW0ucHJvZHVjdElkXSkge1xyXG4gICAgICAgICAgcHJvZHVjdFNhbGVzW2l0ZW0ucHJvZHVjdElkXSA9IHtcclxuICAgICAgICAgICAgcHJvZHVjdElkOiBpdGVtLnByb2R1Y3RJZCxcclxuICAgICAgICAgICAgcHJvZHVjdE5hbWU6IGl0ZW0ucHJvZHVjdE5hbWUsXHJcbiAgICAgICAgICAgIHF1YW50aXR5U29sZDogMCxcclxuICAgICAgICAgICAgcmV2ZW51ZTogMCxcclxuICAgICAgICAgICAgcHJvZml0OiAwLFxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcHJvZHVjdFNhbGVzW2l0ZW0ucHJvZHVjdElkXS5xdWFudGl0eVNvbGQgKz0gaXRlbS5xdWFudGl0eTtcclxuICAgICAgICBwcm9kdWN0U2FsZXNbaXRlbS5wcm9kdWN0SWRdLnJldmVudWUgKz0gaXRlbS5maW5hbFByaWNlO1xyXG4gICAgICAgIHByb2R1Y3RTYWxlc1tpdGVtLnByb2R1Y3RJZF0ucHJvZml0ICs9IGl0ZW0uZmluYWxQcmljZSAtIGl0ZW0udW5pdENvc3Q7XHJcblxyXG4gICAgICAgIC8vIFZhcmlhbnQgYWdncmVnYXRpb25cclxuICAgICAgICBpZiAoIXZhcmlhbnRTYWxlc1tpdGVtLnZhcmlhbnRJZF0pIHtcclxuICAgICAgICAgIHZhcmlhbnRTYWxlc1tpdGVtLnZhcmlhbnRJZF0gPSB7XHJcbiAgICAgICAgICAgIHZhcmlhbnRJZDogaXRlbS52YXJpYW50SWQsXHJcbiAgICAgICAgICAgIHByb2R1Y3ROYW1lOiBpdGVtLnByb2R1Y3ROYW1lLFxyXG4gICAgICAgICAgICBjb2xvck5hbWU6IGl0ZW0uY29sb3JOYW1lLFxyXG4gICAgICAgICAgICBzdG9yYWdlQ2FwYWNpdHk6IGl0ZW0uc3RvcmFnZUNhcGFjaXR5LFxyXG4gICAgICAgICAgICBxdWFudGl0eVNvbGQ6IDAsXHJcbiAgICAgICAgICAgIHJldmVudWU6IDAsXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICB2YXJpYW50U2FsZXNbaXRlbS52YXJpYW50SWRdLnF1YW50aXR5U29sZCArPSBpdGVtLnF1YW50aXR5O1xyXG4gICAgICAgIHZhcmlhbnRTYWxlc1tpdGVtLnZhcmlhbnRJZF0ucmV2ZW51ZSArPSBpdGVtLmZpbmFsUHJpY2U7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcHAudW5pcXVlUHJvZHVjdHNTb2xkID0gT2JqZWN0LmtleXMocHJvZHVjdFNhbGVzKS5sZW5ndGg7XHJcbiAgICAgIHBwLnRvcFByb2R1Y3RzID0gT2JqZWN0LnZhbHVlcyhwcm9kdWN0U2FsZXMpXHJcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IGIucmV2ZW51ZSAtIGEucmV2ZW51ZSlcclxuICAgICAgICAuc2xpY2UoMCwgMTApIC8vIFRvcCAxMFxyXG4gICAgICAgIC5tYXAoKHApID0+ICh7XHJcbiAgICAgICAgICAuLi5wLFxyXG4gICAgICAgICAgcHJvZml0TWFyZ2luOiBwLnJldmVudWUgPiAwID8gKHAucHJvZml0IC8gcC5yZXZlbnVlKSAqIDEwMCA6IDAsXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgcHAudG9wVmFyaWFudHMgPSBPYmplY3QudmFsdWVzKHZhcmlhbnRTYWxlcylcclxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5yZXZlbnVlIC0gYS5yZXZlbnVlKVxyXG4gICAgICAgIC5zbGljZSgwLCAxMCk7XHJcblxyXG4gICAgICAvLyA9PT0gU3RhZmYgUGVyZm9ybWFuY2UgPT09XHJcbiAgICAgIGNvbnN0IHNwID0gZGFpbHlSZXBvcnQuc3RhZmZQZXJmb3JtYW5jZTtcclxuICAgICAgY29uc3Qgc3RhZmZNZXRyaWNzOiB7XHJcbiAgICAgICAgW3N0YWZmSWQ6IHN0cmluZ106IHtcclxuICAgICAgICAgIHN0YWZmSWQ6IHN0cmluZztcclxuICAgICAgICAgIHN0YWZmTmFtZTogc3RyaW5nO1xyXG4gICAgICAgICAgb3JkZXJzUHJvY2Vzc2VkOiBudW1iZXI7XHJcbiAgICAgICAgICByZXZlbnVlOiBudW1iZXI7XHJcbiAgICAgICAgICBjdXN0b21lcnM6IFNldDxzdHJpbmc+O1xyXG4gICAgICAgIH07XHJcbiAgICAgIH0gPSB7fTtcclxuXHJcbiAgICAgIGNvbXBsZXRlZE9yZGVycy5mb3JFYWNoKChvcmRlcikgPT4ge1xyXG4gICAgICAgIGlmICghc3RhZmZNZXRyaWNzW29yZGVyLnN0YWZmSWRdKSB7XHJcbiAgICAgICAgICBzdGFmZk1ldHJpY3Nbb3JkZXIuc3RhZmZJZF0gPSB7XHJcbiAgICAgICAgICAgIHN0YWZmSWQ6IG9yZGVyLnN0YWZmSWQsXHJcbiAgICAgICAgICAgIHN0YWZmTmFtZTogb3JkZXIuc3RhZmZOYW1lIHx8IFwiVW5rbm93blwiLFxyXG4gICAgICAgICAgICBvcmRlcnNQcm9jZXNzZWQ6IDAsXHJcbiAgICAgICAgICAgIHJldmVudWU6IDAsXHJcbiAgICAgICAgICAgIGN1c3RvbWVyczogbmV3IFNldCgpLFxyXG4gICAgICAgICAgfTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY29uc3QgbWV0cmljID0gc3RhZmZNZXRyaWNzW29yZGVyLnN0YWZmSWRdO1xyXG4gICAgICAgIG1ldHJpYy5vcmRlcnNQcm9jZXNzZWQrKztcclxuICAgICAgICBtZXRyaWMucmV2ZW51ZSArPSBvcmRlci50b3RhbEFtb3VudDtcclxuICAgICAgICBpZiAob3JkZXIuY3VzdG9tZXJJZCkge1xyXG4gICAgICAgICAgbWV0cmljLmN1c3RvbWVycy5hZGQob3JkZXIuY3VzdG9tZXJJZCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICAgIHNwLmFjdGl2ZVN0YWZmID0gT2JqZWN0LmtleXMoc3RhZmZNZXRyaWNzKS5sZW5ndGg7XHJcbiAgICAgIHNwLnN0YWZmTWV0cmljcyA9IE9iamVjdC52YWx1ZXMoc3RhZmZNZXRyaWNzKS5tYXAoKG0pID0+ICh7XHJcbiAgICAgICAgc3RhZmZJZDogbS5zdGFmZklkLFxyXG4gICAgICAgIHN0YWZmTmFtZTogbS5zdGFmZk5hbWUsXHJcbiAgICAgICAgb3JkZXJzUHJvY2Vzc2VkOiBtLm9yZGVyc1Byb2Nlc3NlZCxcclxuICAgICAgICByZXZlbnVlOiBtLnJldmVudWUsXHJcbiAgICAgICAgY3VzdG9tZXJDb3VudDogbS5jdXN0b21lcnMuc2l6ZSxcclxuICAgICAgICBhdmVyYWdlT3JkZXJWYWx1ZTpcclxuICAgICAgICAgIG0ub3JkZXJzUHJvY2Vzc2VkID4gMCA/IG0ucmV2ZW51ZSAvIG0ub3JkZXJzUHJvY2Vzc2VkIDogMCxcclxuICAgICAgfSkpO1xyXG5cclxuICAgICAgaWYgKHNwLnN0YWZmTWV0cmljcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgY29uc3QgdG9wU2VsbGVyID0gT2JqZWN0LnZhbHVlcyhzdGFmZk1ldHJpY3MpLnNvcnQoXHJcbiAgICAgICAgICAoYSwgYikgPT4gYi5yZXZlbnVlIC0gYS5yZXZlbnVlXHJcbiAgICAgICAgKVswXTtcclxuICAgICAgICBzcC50b3BTYWxlc1BlcnNvbiA9IHtcclxuICAgICAgICAgIHN0YWZmSWQ6IHRvcFNlbGxlci5zdGFmZklkLFxyXG4gICAgICAgICAgc3RhZmZOYW1lOiB0b3BTZWxsZXIuc3RhZmZOYW1lLFxyXG4gICAgICAgICAgcmV2ZW51ZTogdG9wU2VsbGVyLnJldmVudWUsXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gPT09IEN1c3RvbWVyIE1ldHJpY3MgPT09XHJcbiAgICAgIGNvbnN0IGNtID0gZGFpbHlSZXBvcnQuY3VzdG9tZXJNZXRyaWNzO1xyXG4gICAgICBjb25zdCBjdXN0b21lcklkcyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xyXG4gICAgICBjb21wbGV0ZWRPcmRlcnMuZm9yRWFjaCgobykgPT4ge1xyXG4gICAgICAgIGlmIChvLmN1c3RvbWVySWQpIGN1c3RvbWVySWRzLmFkZChvLmN1c3RvbWVySWQpO1xyXG4gICAgICB9KTtcclxuICAgICAgY20udG90YWxDdXN0b21lcnMgPSBjdXN0b21lcklkcy5zaXplO1xyXG4gICAgICBcclxuICAgICAgLy8gPT09IFNhdmUgUmVwb3J0ID09PVxyXG4gICAgICBhd2FpdCBzZXREb2MocmVwb3J0UmVmLCBkYWlseVJlcG9ydCwgeyBtZXJnZTogdHJ1ZSB9KTtcclxuXHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGRhaWx5UmVwb3J0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgY29uc29sZS5lcnJvcihgRXJyb3IgZ2V0dGluZyBvciBnZW5lcmF0aW5nIGRhaWx5IHJlcG9ydCBmb3IgJHtyZXBvcnREYXRlU3RyfTpgLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiB0aGlzLmhhbmRsZUVycm9yKGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEdlbmVyYXRlcyBhbmQgc2F2ZXMgYSBkYWlseSBzYWxlcyByZXBvcnQgZm9yIGEgZ2l2ZW4gZGF0ZS5cclxuICAgKiBUaGlzIG9wZXJhdGlvbiBjYW4gYmUgcmVzb3VyY2UtaW50ZW5zaXZlIGFuZCBzaG91bGQgYmUgcnVuIGluIGEgdHJ1c3RlZCBlbnZpcm9ubWVudCAoZS5nLiwgYmFja2VuZCwgY2xvdWQgZnVuY3Rpb24pLlxyXG4gICAqIEBwYXJhbSByZXBvcnREYXRlIFRoZSBkYXRlIGZvciB3aGljaCB0byBnZW5lcmF0ZSB0aGUgcmVwb3J0LlxyXG4gICAqIEBwYXJhbSB1c2VySWQgVGhlIElEIG9mIHRoZSB1c2VyIHRyaWdnZXJpbmcgdGhlIGdlbmVyYXRpb24uXHJcbiAgICovXHJcbiAgYXN5bmMgZ2VuZXJhdGVEYWlseVJlcG9ydChcclxuICAgIHJlcG9ydERhdGU6IERhdGUsXHJcbiAgICB1c2VySWQ6IHN0cmluZyA9IFwic3lzdGVtXCJcclxuICApOiBQcm9taXNlPFNlcnZpY2VSZXNwb25zZTxGaXJlYmFzZURhaWx5UmVwb3J0Pj4ge1xyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgcmVwb3J0RGF0ZVN0ciA9IGZvcm1hdChyZXBvcnREYXRlLCBcInl5eXktTU0tZGRcIik7XHJcbiAgICAgIGNvbnN0IHJlcG9ydFRpbWVzdGFtcCA9IFRpbWVzdGFtcC5mcm9tRGF0ZShyZXBvcnREYXRlKTtcclxuICAgICAgY29uc3QgZGFpbHlSZXBvcnQgPSBjcmVhdGVFbXB0eURhaWx5UmVwb3J0KHJlcG9ydERhdGVTdHIsIHJlcG9ydFRpbWVzdGFtcCk7XHJcbiAgICAgIGRhaWx5UmVwb3J0LmdlbmVyYXRlZEJ5ID0gdXNlcklkO1xyXG4gICAgICBkYWlseVJlcG9ydC5jcmVhdGVkQnkgPSB1c2VySWQ7XHJcbiAgICAgIGRhaWx5UmVwb3J0LnVwZGF0ZWRCeSA9IHVzZXJJZDtcclxuXHJcbiAgICAgIGNvbnN0IHN0YXJ0ID0gc3RhcnRPZkRheShyZXBvcnREYXRlKTtcclxuICAgICAgY29uc3QgZW5kID0gZW5kT2ZEYXkocmVwb3J0RGF0ZSk7XHJcblxyXG4gICAgICAvLyAxLiBGZXRjaCBhbGwgc2FsZXMgb3JkZXJzIGZvciB0aGUgZ2l2ZW4gZGF5XHJcbiAgICAgIGNvbnN0IG9yZGVyc1JlZiA9IGNvbGxlY3Rpb24oZGIsIENPTExFQ1RJT05TLlNBTEVTX09SREVSUyk7XHJcbiAgICAgIGNvbnN0IHEgPSBxdWVyeShcclxuICAgICAgICBvcmRlcnNSZWYsXHJcbiAgICAgICAgd2hlcmUoXCJvcmRlckRhdGVcIiwgXCI+PVwiLCBUaW1lc3RhbXAuZnJvbURhdGUoc3RhcnQpKSxcclxuICAgICAgICB3aGVyZShcIm9yZGVyRGF0ZVwiLCBcIjw9XCIsIFRpbWVzdGFtcC5mcm9tRGF0ZShlbmQpKVxyXG4gICAgICApO1xyXG4gICAgICBjb25zdCBvcmRlclNuYXBzaG90cyA9IGF3YWl0IGdldERvY3MocSk7XHJcbiAgICAgIGNvbnN0IG9yZGVycyA9IG9yZGVyU25hcHNob3RzLmRvY3MubWFwKFxyXG4gICAgICAgIChkb2MpID0+ICh7IGlkOiBkb2MuaWQsIC4uLmRvYy5kYXRhKCkgfSBhcyBGaXJlYmFzZVNhbGVzT3JkZXIpXHJcbiAgICAgICk7XHJcblxyXG4gICAgICBpZiAob3JkZXJzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIC8vIE5vIHNhbGVzLCBzYXZlIGFuIGVtcHR5IHJlcG9ydFxyXG4gICAgICAgIGNvbnN0IGVtcHR5UmVwb3J0UmVmID0gZG9jKGRiLCB0aGlzLmNvbGxlY3Rpb25OYW1lLCByZXBvcnREYXRlU3RyKTtcclxuICAgICAgICBhd2FpdCBzZXREb2MoZW1wdHlSZXBvcnRSZWYsIGRhaWx5UmVwb3J0KTtcclxuICAgICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBkYWlseVJlcG9ydCB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyAyLiBGZXRjaCBhbGwgb3JkZXIgaXRlbXMgZm9yIHRoZXNlIG9yZGVyc1xyXG4gICAgICBsZXQgYWxsSXRlbXM6IEZpcmViYXNlU2FsZXNPcmRlckl0ZW1bXSA9IFtdO1xyXG4gICAgICBmb3IgKGNvbnN0IG9yZGVyIG9mIG9yZGVycykge1xyXG4gICAgICAgIGNvbnN0IGl0ZW1zUmVmID0gY29sbGVjdGlvbihcclxuICAgICAgICAgIGRiLFxyXG4gICAgICAgICAgQ09MTEVDVElPTlMuU0FMRVNfT1JERVJTLFxyXG4gICAgICAgICAgb3JkZXIuaWQsXHJcbiAgICAgICAgICBTVUJDT0xMRUNUSU9OUy5PUkRFUl9JVEVNU1xyXG4gICAgICAgICk7XHJcbiAgICAgICAgY29uc3QgaXRlbXNTbmFwc2hvdCA9IGF3YWl0IGdldERvY3MoaXRlbXNSZWYpO1xyXG4gICAgICAgIGl0ZW1zU25hcHNob3QuZm9yRWFjaCgoZG9jKSA9PiB7XHJcbiAgICAgICAgICBhbGxJdGVtcy5wdXNoKHsgaWQ6IGRvYy5pZCwgLi4uZG9jLmRhdGEoKSB9IGFzIEZpcmViYXNlU2FsZXNPcmRlckl0ZW0pO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyAzLiBQcm9jZXNzIGRhdGEgYW5kIHBvcHVsYXRlIHRoZSByZXBvcnQgb2JqZWN0XHJcbiAgICAgIGNvbnN0IGNvbXBsZXRlZE9yZGVycyA9IG9yZGVycy5maWx0ZXIoKG8pID0+IG8uc3RhdHVzID09PSBcImNvbXBsZXRlZFwiKTtcclxuXHJcbiAgICAgIC8vID09PSBTYWxlcyBNZXRyaWNzID09PVxyXG4gICAgICBjb25zdCBzbSA9IGRhaWx5UmVwb3J0LnNhbGVzTWV0cmljcztcclxuICAgICAgc20udG90YWxPcmRlcnMgPSBvcmRlcnMubGVuZ3RoO1xyXG4gICAgICBzbS5jb21wbGV0ZWRPcmRlcnMgPSBjb21wbGV0ZWRPcmRlcnMubGVuZ3RoO1xyXG4gICAgICBzbS5jYW5jZWxsZWRPcmRlcnMgPSBvcmRlcnMuZmlsdGVyKChvKSA9PiBvLnN0YXR1cyA9PT0gXCJjYW5jZWxsZWRcIikubGVuZ3RoO1xyXG4gICAgICBzbS5wZW5kaW5nT3JkZXJzID0gb3JkZXJzLmZpbHRlcigobykgPT4gby5zdGF0dXMuc3RhcnRzV2l0aChcInBlbmRpbmdcIikpLmxlbmd0aDtcclxuICAgICAgc20udG90YWxSZXZlbnVlID0gY29tcGxldGVkT3JkZXJzLnJlZHVjZSgoc3VtLCBvKSA9PiBzdW0gKyBvLnRvdGFsQW1vdW50LCAwKTtcclxuICAgICAgc20udG90YWxRdWFudGl0eVNvbGQgPSBjb21wbGV0ZWRPcmRlcnMucmVkdWNlKChzdW0sIG8pID0+IHN1bSArIG8udG90YWxRdWFudGl0eSwgMCk7XHJcbiAgICAgIHNtLmF2ZXJhZ2VPcmRlclZhbHVlID0gc20uY29tcGxldGVkT3JkZXJzID4gMCA/IHNtLnRvdGFsUmV2ZW51ZSAvIHNtLmNvbXBsZXRlZE9yZGVycyA6IDA7XHJcbiAgICAgIFxyXG4gICAgICBvcmRlcnMuZm9yRWFjaChvcmRlciA9PiB7XHJcbiAgICAgICAgICAvLyBQYXltZW50IG1ldGhvZHNcclxuICAgICAgICAgIGNvbnN0IHBtID0gb3JkZXIucGF5bWVudE1ldGhvZDtcclxuICAgICAgICAgIGlmICghc20ucGF5bWVudE1ldGhvZHNbcG1dKSB7XHJcbiAgICAgICAgICAgICAgc20ucGF5bWVudE1ldGhvZHNbcG1dID0geyBvcmRlckNvdW50OiAwLCB0b3RhbEFtb3VudDogMCwgcGVyY2VudGFnZTogMCB9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgc20ucGF5bWVudE1ldGhvZHNbcG1dLm9yZGVyQ291bnQrKztcclxuICAgICAgICAgIGlmIChvcmRlci5zdGF0dXMgPT09ICdjb21wbGV0ZWQnKSB7XHJcbiAgICAgICAgICAgICAgc20ucGF5bWVudE1ldGhvZHNbcG1dLnRvdGFsQW1vdW50ICs9IG9yZGVyLnRvdGFsQW1vdW50O1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIC8vIEhvdXJseSBicmVha2Rvd25cclxuICAgICAgICAgIGNvbnN0IGhvdXIgPSBnZXRIb3VycyhvcmRlci5vcmRlckRhdGUudG9EYXRlKCkpO1xyXG4gICAgICAgICAgc20uaG91cmx5QnJlYWtkb3duW2hvdXJdLm9yZGVycysrO1xyXG4gICAgICAgICAgaWYob3JkZXIuc3RhdHVzID09PSAnY29tcGxldGVkJykge1xyXG4gICAgICAgICAgICAgIHNtLmhvdXJseUJyZWFrZG93bltob3VyXS5yZXZlbnVlICs9IG9yZGVyLnRvdGFsQW1vdW50O1xyXG4gICAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgLy8gQ2FsY3VsYXRlIHBheW1lbnQgbWV0aG9kIHBlcmNlbnRhZ2VzXHJcbiAgICAgIGlmIChzbS50b3RhbFJldmVudWUgPiAwKSB7XHJcbiAgICAgICAgT2JqZWN0LmtleXMoc20ucGF5bWVudE1ldGhvZHMpLmZvckVhY2goa2V5ID0+IHtcclxuICAgICAgICAgICAgc20ucGF5bWVudE1ldGhvZHNba2V5XS5wZXJjZW50YWdlID0gKHNtLnBheW1lbnRNZXRob2RzW2tleV0udG90YWxBbW91bnQgLyBzbS50b3RhbFJldmVudWUpICogMTAwO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyA9PT0gRmluYW5jaWFsIFN1bW1hcnkgPT09XHJcbiAgICAgIGNvbnN0IGZzID0gZGFpbHlSZXBvcnQuZmluYW5jaWFsU3VtbWFyeTtcclxuICAgICAgZnMuZ3Jvc3NSZXZlbnVlID0gY29tcGxldGVkT3JkZXJzLnJlZHVjZSgoc3VtLCBvKSA9PiBzdW0gKyBvLnN1YnRvdGFsQW1vdW50LCAwKTtcclxuICAgICAgZnMuZGlzY291bnRBbW91bnQgPSBjb21wbGV0ZWRPcmRlcnMucmVkdWNlKChzdW0sIG8pID0+IHN1bSArIG8uZGlzY291bnRBbW91bnQsIDApO1xyXG4gICAgICBmcy50YXhBbW91bnQgPSBjb21wbGV0ZWRPcmRlcnMucmVkdWNlKChzdW0sIG8pID0+IHN1bSArIG8udGF4QW1vdW50LCAwKTtcclxuICAgICAgZnMubmV0UmV2ZW51ZSA9IGNvbXBsZXRlZE9yZGVycy5yZWR1Y2UoKHN1bSwgbykgPT4gc3VtICsgby50b3RhbEFtb3VudCwgMCk7XHJcbiAgICAgIGZzLnRvdGFsQ29zdCA9IGFsbEl0ZW1zXHJcbiAgICAgICAgLmZpbHRlcihpdGVtID0+IGNvbXBsZXRlZE9yZGVycy5zb21lKG8gPT4gby5pZCA9PT0gaXRlbS5zYWxlc09yZGVySWQpKVxyXG4gICAgICAgIC5yZWR1Y2UoKHN1bSwgaXRlbSkgPT4gc3VtICsgaXRlbS51bml0Q29zdCwgMCk7XHJcbiAgICAgIGZzLmdyb3NzUHJvZml0ID0gZnMuZ3Jvc3NSZXZlbnVlIC0gZnMudG90YWxDb3N0O1xyXG4gICAgICBmcy5ncm9zc1Byb2ZpdE1hcmdpbiA9IGZzLmdyb3NzUmV2ZW51ZSA+IDAgPyAoZnMuZ3Jvc3NQcm9maXQgLyBmcy5ncm9zc1JldmVudWUpICogMTAwIDogMDtcclxuXHJcbiAgICAgIC8vID09PSBQcm9kdWN0IFBlcmZvcm1hbmNlID09PVxyXG4gICAgICBjb25zdCBwcCA9IGRhaWx5UmVwb3J0LnByb2R1Y3RQZXJmb3JtYW5jZTtcclxuICAgICAgY29uc3Qgc29sZEl0ZW1zID0gYWxsSXRlbXMuZmlsdGVyKGl0ZW0gPT4gY29tcGxldGVkT3JkZXJzLnNvbWUobyA9PiBvLmlkID09PSBpdGVtLnNhbGVzT3JkZXJJZCkpO1xyXG4gICAgICBwcC50b3RhbFByb2R1Y3RzU29sZCA9IHNvbGRJdGVtcy5sZW5ndGg7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBwcm9kdWN0U2FsZXM6IHsgW3Byb2R1Y3RJZDogc3RyaW5nXTogeyBwcm9kdWN0SWQ6IHN0cmluZzsgcHJvZHVjdE5hbWU6IHN0cmluZzsgcXVhbnRpdHlTb2xkOiBudW1iZXI7IHJldmVudWU6IG51bWJlcjsgcHJvZml0OiBudW1iZXI7IH0gfSA9IHt9O1xyXG4gICAgICBjb25zdCB2YXJpYW50U2FsZXM6IHsgW3ZhcmlhbnRJZDogc3RyaW5nXTogeyB2YXJpYW50SWQ6IHN0cmluZzsgcHJvZHVjdE5hbWU6IHN0cmluZzsgY29sb3JOYW1lOiBzdHJpbmc7IHN0b3JhZ2VDYXBhY2l0eTogc3RyaW5nOyBxdWFudGl0eVNvbGQ6IG51bWJlcjsgcmV2ZW51ZTogbnVtYmVyOyB9IH0gPSB7fTtcclxuXHJcbiAgICAgIHNvbGRJdGVtcy5mb3JFYWNoKGl0ZW0gPT4ge1xyXG4gICAgICAgICAgLy8gUHJvZHVjdCBhZ2dyZWdhdGlvblxyXG4gICAgICAgICAgaWYoIXByb2R1Y3RTYWxlc1tpdGVtLnByb2R1Y3RJZF0pIHtcclxuICAgICAgICAgICAgICBwcm9kdWN0U2FsZXNbaXRlbS5wcm9kdWN0SWRdID0geyBwcm9kdWN0SWQ6IGl0ZW0ucHJvZHVjdElkLCBwcm9kdWN0TmFtZTogaXRlbS5wcm9kdWN0TmFtZSwgcXVhbnRpdHlTb2xkOiAwLCByZXZlbnVlOiAwLCBwcm9maXQ6IDAgfTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIHByb2R1Y3RTYWxlc1tpdGVtLnByb2R1Y3RJZF0ucXVhbnRpdHlTb2xkICs9IGl0ZW0ucXVhbnRpdHk7XHJcbiAgICAgICAgICBwcm9kdWN0U2FsZXNbaXRlbS5wcm9kdWN0SWRdLnJldmVudWUgKz0gaXRlbS5maW5hbFByaWNlO1xyXG4gICAgICAgICAgcHJvZHVjdFNhbGVzW2l0ZW0ucHJvZHVjdElkXS5wcm9maXQgKz0gKGl0ZW0uZmluYWxQcmljZSAtIGl0ZW0udW5pdENvc3QpO1xyXG5cclxuICAgICAgICAgIC8vIFZhcmlhbnQgYWdncmVnYXRpb25cclxuICAgICAgICAgIGlmKCF2YXJpYW50U2FsZXNbaXRlbS52YXJpYW50SWRdKSB7XHJcbiAgICAgICAgICAgICAgdmFyaWFudFNhbGVzW2l0ZW0udmFyaWFudElkXSA9IHsgdmFyaWFudElkOiBpdGVtLnZhcmlhbnRJZCwgcHJvZHVjdE5hbWU6IGl0ZW0ucHJvZHVjdE5hbWUsIGNvbG9yTmFtZTogaXRlbS5jb2xvck5hbWUsIHN0b3JhZ2VDYXBhY2l0eTogaXRlbS5zdG9yYWdlQ2FwYWNpdHksIHF1YW50aXR5U29sZDogMCwgcmV2ZW51ZTogMCB9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgdmFyaWFudFNhbGVzW2l0ZW0udmFyaWFudElkXS5xdWFudGl0eVNvbGQgKz0gaXRlbS5xdWFudGl0eTtcclxuICAgICAgICAgIHZhcmlhbnRTYWxlc1tpdGVtLnZhcmlhbnRJZF0ucmV2ZW51ZSArPSBpdGVtLmZpbmFsUHJpY2U7XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgcHAudW5pcXVlUHJvZHVjdHNTb2xkID0gT2JqZWN0LmtleXMocHJvZHVjdFNhbGVzKS5sZW5ndGg7XHJcbiAgICAgIHBwLnRvcFByb2R1Y3RzID0gT2JqZWN0LnZhbHVlcyhwcm9kdWN0U2FsZXMpXHJcbiAgICAgICAgLnNvcnQoKGEsIGIpID0+IGIucmV2ZW51ZSAtIGEucmV2ZW51ZSlcclxuICAgICAgICAuc2xpY2UoMCwgMTApIC8vIFRvcCAxMFxyXG4gICAgICAgIC5tYXAocCA9PiAoeyAuLi5wLCBwcm9maXRNYXJnaW46IHAucmV2ZW51ZSA+IDAgPyAocC5wcm9maXQgLyBwLnJldmVudWUpICogMTAwIDogMCwgcHJvZml0OiBwLnByb2ZpdCB9KSk7XHJcbiAgICAgIFxyXG4gICAgICBwcC50b3BWYXJpYW50cyA9IE9iamVjdC52YWx1ZXModmFyaWFudFNhbGVzKVxyXG4gICAgICAgIC5zb3J0KChhLGIpID0+IGIucmV2ZW51ZSAtIGEucmV2ZW51ZSlcclxuICAgICAgICAuc2xpY2UoMCwgMTApO1xyXG5cclxuICAgICAgLy8gPT09IFN0YWZmIFBlcmZvcm1hbmNlID09PVxyXG4gICAgICBjb25zdCBzcCA9IGRhaWx5UmVwb3J0LnN0YWZmUGVyZm9ybWFuY2U7XHJcbiAgICAgIGNvbnN0IHN0YWZmTWV0cmljczogeyBbc3RhZmZJZDogc3RyaW5nXTogeyBzdGFmZklkOiBzdHJpbmc7IHN0YWZmTmFtZTogc3RyaW5nOyBvcmRlcnNQcm9jZXNzZWQ6IG51bWJlcjsgcmV2ZW51ZTogbnVtYmVyOyBjdXN0b21lcnM6IFNldDxzdHJpbmc+OyB9IH0gPSB7fTtcclxuICAgICAgXHJcbiAgICAgIGNvbXBsZXRlZE9yZGVycy5mb3JFYWNoKG9yZGVyID0+IHtcclxuICAgICAgICAgIGlmICghc3RhZmZNZXRyaWNzW29yZGVyLnN0YWZmSWRdKSB7XHJcbiAgICAgICAgICAgICAgc3RhZmZNZXRyaWNzW29yZGVyLnN0YWZmSWRdID0geyBzdGFmZklkOiBvcmRlci5zdGFmZklkLCBzdGFmZk5hbWU6IG9yZGVyLnN0YWZmTmFtZSB8fCAnVW5rbm93bicsIG9yZGVyc1Byb2Nlc3NlZDogMCwgcmV2ZW51ZTogMCwgY3VzdG9tZXJzOiBuZXcgU2V0KCkgfTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGNvbnN0IG1ldHJpYyA9IHN0YWZmTWV0cmljc1tvcmRlci5zdGFmZklkXTtcclxuICAgICAgICAgIG1ldHJpYy5vcmRlcnNQcm9jZXNzZWQrKztcclxuICAgICAgICAgIG1ldHJpYy5yZXZlbnVlICs9IG9yZGVyLnRvdGFsQW1vdW50O1xyXG4gICAgICAgICAgaWYgKG9yZGVyLmN1c3RvbWVySWQpIHtcclxuICAgICAgICAgICAgbWV0cmljLmN1c3RvbWVycy5hZGQob3JkZXIuY3VzdG9tZXJJZCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgc3AuYWN0aXZlU3RhZmYgPSBPYmplY3Qua2V5cyhzdGFmZk1ldHJpY3MpLmxlbmd0aDtcclxuICAgICAgc3Auc3RhZmZNZXRyaWNzID0gT2JqZWN0LnZhbHVlcyhzdGFmZk1ldHJpY3MpLm1hcChtID0+ICh7IFxyXG4gICAgICAgICAgc3RhZmZJZDogbS5zdGFmZklkLCBcclxuICAgICAgICAgIHN0YWZmTmFtZTogbS5zdGFmZk5hbWUsIFxyXG4gICAgICAgICAgb3JkZXJzUHJvY2Vzc2VkOiBtLm9yZGVyc1Byb2Nlc3NlZCwgXHJcbiAgICAgICAgICByZXZlbnVlOiBtLnJldmVudWUsIFxyXG4gICAgICAgICAgY3VzdG9tZXJDb3VudDogbS5jdXN0b21lcnMuc2l6ZSwgXHJcbiAgICAgICAgICBhdmVyYWdlT3JkZXJWYWx1ZTogbS5vcmRlcnNQcm9jZXNzZWQgPiAwID8gbS5yZXZlbnVlIC8gbS5vcmRlcnNQcm9jZXNzZWQgOiAwXHJcbiAgICAgICAgfSkpO1xyXG5cclxuICAgICAgaWYoc3Auc3RhZmZNZXRyaWNzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zdCB0b3BTZWxsZXIgPSBPYmplY3QudmFsdWVzKHN0YWZmTWV0cmljcykuc29ydCgoYSxiKSA9PiBiLnJldmVudWUgLSBhLnJldmVudWUpWzBdXHJcbiAgICAgICAgc3AudG9wU2FsZXNQZXJzb24gPSB7XHJcbiAgICAgICAgICBzdGFmZklkOiB0b3BTZWxsZXIuc3RhZmZJZCxcclxuICAgICAgICAgIHN0YWZmTmFtZTogdG9wU2VsbGVyLnN0YWZmTmFtZSxcclxuICAgICAgICAgIHJldmVudWU6IHRvcFNlbGxlci5yZXZlbnVlLFxyXG4gICAgICAgIH07XHJcbiAgICAgIH1cclxuICAgICAgXHJcbiAgICAgIC8vID09PSBDdXN0b21lciBNZXRyaWNzID09PVxyXG4gICAgICAvLyBUaGlzIGlzIGEgc2ltcGxpZmllZCB2ZXJzaW9uLiBGb3IgYWNjdXJhdGUgbmV3L3JldHVybmluZywgd2UgbmVlZCB0byBjaGVjayBjdXN0b21lcidzIGhpc3RvcnkuXHJcbiAgICAgIGNvbnN0IGNtID0gZGFpbHlSZXBvcnQuY3VzdG9tZXJNZXRyaWNzO1xyXG4gICAgICBjb25zdCBjdXN0b21lcklkcyA9IG5ldyBTZXQ8c3RyaW5nPigpO1xyXG4gICAgICBjb21wbGV0ZWRPcmRlcnMuZm9yRWFjaChvID0+IHtcclxuICAgICAgICBpZihvLmN1c3RvbWVySWQpIGN1c3RvbWVySWRzLmFkZChvLmN1c3RvbWVySWQpO1xyXG4gICAgICB9KTtcclxuICAgICAgY20udG90YWxDdXN0b21lcnMgPSBjdXN0b21lcklkcy5zaXplO1xyXG4gICAgICAvLyBUaGlzIHJlcXVpcmVzIGZldGNoaW5nIGVhY2ggY3VzdG9tZXIgZG9jLCBjYW4gYmUgc2xvdy4gQSBiZXR0ZXIgYXBwcm9hY2ggaXMgdG8gdXNlIGEgc3VtbWFyeSBmaWVsZCBvbiB0aGUgY3VzdG9tZXIgZG9jXHJcbiAgICAgIC8vIG9yIHVzZSBhIHNlcGFyYXRlIGFuYWx5dGljcyBzZXJ2aWNlL2Nsb3VkIGZ1bmN0aW9uLiBGb3Igbm93LCB0aGlzIGlzIG9taXR0ZWQgZm9yIHBlcmZvcm1hbmNlIHJlYXNvbnMuXHJcbiAgICAgIC8vIGNtLm5ld0N1c3RvbWVycyA9IC4uLlxyXG4gICAgICAvLyBjbS5yZXR1cm5pbmdDdXN0b21lcnMgPSAuLi5cclxuICAgICAgXHJcbiAgICAgIC8vID09PSBTYXZlIFJlcG9ydCA9PT1cclxuICAgICAgY29uc3QgcmVwb3J0UmVmID0gZG9jKGRiLCB0aGlzLmNvbGxlY3Rpb25OYW1lLCByZXBvcnREYXRlU3RyKTtcclxuICAgICAgYXdhaXQgc2V0RG9jKHJlcG9ydFJlZiwgZGFpbHlSZXBvcnQsIHsgbWVyZ2U6IHRydWUgfSk7XHJcblxyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBkYWlseVJlcG9ydCB9O1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIGdlbmVyYXRpbmcgZGFpbHkgcmVwb3J0OlwiLCBlcnJvcik7XHJcbiAgICAgIHJldHVybiB0aGlzLmhhbmRsZUVycm9yKGVycm9yKTtcclxuICAgIH1cclxuICB9XHJcbn1cclxuXHJcbmV4cG9ydCBjb25zdCByZXBvcnRzU2VydmljZSA9IG5ldyBSZXBvcnRzU2VydmljZSgpOyAiXSwibmFtZXMiOlsiY29sbGVjdGlvbiIsImRvYyIsImdldERvY3MiLCJxdWVyeSIsIndoZXJlIiwiVGltZXN0YW1wIiwiZ2V0RG9jIiwic2V0RG9jIiwiZGIiLCJCYXNlU2VydmljZSIsIkNPTExFQ1RJT05TIiwiU1VCQ09MTEVDVElPTlMiLCJmb3JtYXQiLCJzdGFydE9mRGF5IiwiZW5kT2ZEYXkiLCJnZXRIb3VycyIsImNyZWF0ZUVtcHR5RGFpbHlSZXBvcnQiLCJyZXBvcnREYXRlU3RyIiwicmVwb3J0VGltZXN0YW1wIiwiaWQiLCJyZXBvcnREYXRlIiwiZ2VuZXJhdGVkQXQiLCJub3ciLCJnZW5lcmF0ZWRCeSIsImlzRmluYWxpemVkIiwic2FsZXNNZXRyaWNzIiwidG90YWxPcmRlcnMiLCJjb21wbGV0ZWRPcmRlcnMiLCJjYW5jZWxsZWRPcmRlcnMiLCJwZW5kaW5nT3JkZXJzIiwidG90YWxSZXZlbnVlIiwidG90YWxRdWFudGl0eVNvbGQiLCJhdmVyYWdlT3JkZXJWYWx1ZSIsInBheW1lbnRNZXRob2RzIiwiaG91cmx5QnJlYWtkb3duIiwiQXJyYXkiLCJmcm9tIiwibGVuZ3RoIiwiXyIsImkiLCJob3VyIiwib3JkZXJzIiwicmV2ZW51ZSIsInByb2R1Y3RQZXJmb3JtYW5jZSIsInRvdGFsUHJvZHVjdHNTb2xkIiwidW5pcXVlUHJvZHVjdHNTb2xkIiwidG9wUHJvZHVjdHMiLCJjYXRlZ29yeUJyZWFrZG93biIsInRvcFZhcmlhbnRzIiwic3RhZmZQZXJmb3JtYW5jZSIsImFjdGl2ZVN0YWZmIiwic3RhZmZNZXRyaWNzIiwidG9wU2FsZXNQZXJzb24iLCJzdGFmZklkIiwic3RhZmZOYW1lIiwiY3VzdG9tZXJNZXRyaWNzIiwidG90YWxDdXN0b21lcnMiLCJuZXdDdXN0b21lcnMiLCJyZXR1cm5pbmdDdXN0b21lcnMiLCJ2aXBDdXN0b21lcnMiLCJjdXN0b21lclNlZ21lbnRzIiwiaW52ZW50b3J5TWV0cmljcyIsIml0ZW1zU29sZCIsInN0b2NrTW92ZW1lbnRzIiwibG93U3RvY2tBbGVydHMiLCJvdXRPZlN0b2NrSXRlbXMiLCJ0b3BNb3ZpbmdJdGVtcyIsInJldHVybk1ldHJpY3MiLCJ0b3RhbFJldHVybnMiLCJyZXR1cm5WYWx1ZSIsInJldHVyblJhdGUiLCJleGNoYW5nZUNvdW50IiwicmVmdW5kQW1vdW50IiwicmV0dXJuUmVhc29ucyIsImZpbmFuY2lhbFN1bW1hcnkiLCJncm9zc1JldmVudWUiLCJkaXNjb3VudEFtb3VudCIsInRheEFtb3VudCIsIm5ldFJldmVudWUiLCJ0b3RhbENvc3QiLCJncm9zc1Byb2ZpdCIsImdyb3NzUHJvZml0TWFyZ2luIiwiY29tcGFyYXRpdmVNZXRyaWNzIiwicHJldmlvdXNEYXkiLCJyZXZlbnVlR3Jvd3RoIiwib3JkZXJHcm93dGgiLCJjdXN0b21lckdyb3d0aCIsInByZXZpb3VzV2VlayIsImF2ZXJhZ2VPcmRlclZhbHVlR3Jvd3RoIiwibW9udGhUb0RhdGUiLCJ0YXJnZXRQcm9ncmVzcyIsIm9wZXJhdGlvbmFsTWV0cmljcyIsImF2ZXJhZ2VJdGVtc1Blck9yZGVyIiwib3JkZXJzUGVyU3RhZmYiLCJyZXZlbnVlUGVyU3RhZmYiLCJwZWFrSG91cnMiLCJxdWFsaXR5TWV0cmljcyIsImN1c3RvbWVyQ29tcGxhaW50cyIsIndhcnJhbnR5SXNzdWVzIiwicHJvZHVjdERlZmVjdHMiLCJjcmVhdGVkQXQiLCJ1cGRhdGVkQXQiLCJjcmVhdGVkQnkiLCJ1cGRhdGVkQnkiLCJSZXBvcnRzU2VydmljZSIsImdldE9yR2VuZXJhdGVEYWlseVJlcG9ydCIsInVzZXJJZCIsInJlcG9ydFJlZiIsImNvbGxlY3Rpb25OYW1lIiwicmVwb3J0RG9jIiwiZXhpc3RzIiwiY29uc29sZSIsImxvZyIsInN1Y2Nlc3MiLCJkYXRhIiwiZGFpbHlSZXBvcnQiLCJmcm9tRGF0ZSIsInN0YXJ0IiwiZW5kIiwib3JkZXJzUmVmIiwiU0FMRVNfT1JERVJTIiwicSIsIm9yZGVyU25hcHNob3RzIiwiZG9jcyIsIm1hcCIsImFsbEl0ZW1zIiwib3JkZXIiLCJpdGVtc1JlZiIsIk9SREVSX0lURU1TIiwiaXRlbXNTbmFwc2hvdCIsImZvckVhY2giLCJwdXNoIiwiZmlsdGVyIiwibyIsInN0YXR1cyIsInNtIiwic3RhcnRzV2l0aCIsInJlZHVjZSIsInN1bSIsInRvdGFsQW1vdW50IiwidG90YWxRdWFudGl0eSIsInBtIiwicGF5bWVudE1ldGhvZCIsIm9yZGVyQ291bnQiLCJwZXJjZW50YWdlIiwib3JkZXJEYXRlIiwidG9EYXRlIiwiT2JqZWN0Iiwia2V5cyIsImtleSIsImZzIiwic3VidG90YWxBbW91bnQiLCJpdGVtIiwic29tZSIsInNhbGVzT3JkZXJJZCIsInVuaXRDb3N0IiwicHAiLCJzb2xkSXRlbXMiLCJwcm9kdWN0U2FsZXMiLCJ2YXJpYW50U2FsZXMiLCJwcm9kdWN0SWQiLCJwcm9kdWN0TmFtZSIsInF1YW50aXR5U29sZCIsInByb2ZpdCIsInF1YW50aXR5IiwiZmluYWxQcmljZSIsInZhcmlhbnRJZCIsImNvbG9yTmFtZSIsInN0b3JhZ2VDYXBhY2l0eSIsInZhbHVlcyIsInNvcnQiLCJhIiwiYiIsInNsaWNlIiwicCIsInByb2ZpdE1hcmdpbiIsInNwIiwib3JkZXJzUHJvY2Vzc2VkIiwiY3VzdG9tZXJzIiwiU2V0IiwibWV0cmljIiwiY3VzdG9tZXJJZCIsImFkZCIsIm0iLCJjdXN0b21lckNvdW50Iiwic2l6ZSIsInRvcFNlbGxlciIsImNtIiwiY3VzdG9tZXJJZHMiLCJtZXJnZSIsImVycm9yIiwiaGFuZGxlRXJyb3IiLCJnZW5lcmF0ZURhaWx5UmVwb3J0IiwiZW1wdHlSZXBvcnRSZWYiLCJjb25zdHJ1Y3RvciIsIlJFUE9SVFMiLCJyZXBvcnRzU2VydmljZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/lib/firebase/services/reports.service.ts\n"));

/***/ })

});