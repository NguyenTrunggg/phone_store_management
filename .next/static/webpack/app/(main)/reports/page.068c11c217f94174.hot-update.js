"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
self["webpackHotUpdate_N_E"]("app/(main)/reports/page",{

/***/ "(app-pages-browser)/./src/lib/firebase/services/reports.service.ts":
/*!******************************************************!*\
  !*** ./src/lib/firebase/services/reports.service.ts ***!
  \******************************************************/
/***/ (function(module, __webpack_exports__, __webpack_require__) {

eval(__webpack_require__.ts("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   ReportsService: function() { return /* binding */ ReportsService; },\n/* harmony export */   reportsService: function() { return /* binding */ reportsService; }\n/* harmony export */ });\n/* harmony import */ var firebase_firestore__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! firebase/firestore */ \"(app-pages-browser)/./node_modules/firebase/firestore/dist/esm/index.esm.js\");\n/* harmony import */ var _lib_firebase__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! @/lib/firebase */ \"(app-pages-browser)/./src/lib/firebase.ts\");\n/* harmony import */ var _base_service__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./base.service */ \"(app-pages-browser)/./src/lib/firebase/services/base.service.ts\");\n/* harmony import */ var _constants__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! @/constants */ \"(app-pages-browser)/./src/constants/index.ts\");\n/* harmony import */ var _barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! __barrel_optimize__?names=endOfDay,format,getHours,startOfDay!=!date-fns */ \"(app-pages-browser)/./node_modules/date-fns/esm/format/index.js\");\n/* harmony import */ var _barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! __barrel_optimize__?names=endOfDay,format,getHours,startOfDay!=!date-fns */ \"(app-pages-browser)/./node_modules/date-fns/esm/startOfDay/index.js\");\n/* harmony import */ var _barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! __barrel_optimize__?names=endOfDay,format,getHours,startOfDay!=!date-fns */ \"(app-pages-browser)/./node_modules/date-fns/esm/endOfDay/index.js\");\n/* harmony import */ var _barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! __barrel_optimize__?names=endOfDay,format,getHours,startOfDay!=!date-fns */ \"(app-pages-browser)/./node_modules/date-fns/esm/getHours/index.js\");\n\n\n\n\n\n// A helper to create an empty daily report structure\nconst createEmptyDailyReport = (reportDateStr, reportTimestamp)=>{\n    return {\n        id: reportDateStr,\n        reportDate: reportDateStr,\n        reportTimestamp: reportTimestamp,\n        generatedAt: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.now(),\n        generatedBy: \"system\",\n        isFinalized: false,\n        salesMetrics: {\n            totalOrders: 0,\n            completedOrders: 0,\n            cancelledOrders: 0,\n            pendingOrders: 0,\n            totalRevenue: 0,\n            totalQuantitySold: 0,\n            averageOrderValue: 0,\n            paymentMethods: {},\n            hourlyBreakdown: Array.from({\n                length: 24\n            }, (_, i)=>({\n                    hour: i,\n                    orders: 0,\n                    revenue: 0\n                }))\n        },\n        productPerformance: {\n            totalProductsSold: 0,\n            uniqueProductsSold: 0,\n            topProducts: [],\n            categoryBreakdown: {},\n            topVariants: []\n        },\n        staffPerformance: {\n            activeStaff: 0,\n            staffMetrics: [],\n            topSalesPerson: {\n                staffId: \"\",\n                staffName: \"\",\n                revenue: 0\n            }\n        },\n        customerMetrics: {\n            totalCustomers: 0,\n            newCustomers: 0,\n            returningCustomers: 0,\n            vipCustomers: 0,\n            customerSegments: {}\n        },\n        inventoryMetrics: {\n            itemsSold: 0,\n            stockMovements: 0,\n            lowStockAlerts: 0,\n            outOfStockItems: 0,\n            topMovingItems: []\n        },\n        returnMetrics: {\n            totalReturns: 0,\n            returnValue: 0,\n            returnRate: 0,\n            exchangeCount: 0,\n            refundAmount: 0,\n            returnReasons: {}\n        },\n        financialSummary: {\n            grossRevenue: 0,\n            discountAmount: 0,\n            taxAmount: 0,\n            netRevenue: 0,\n            totalCost: 0,\n            grossProfit: 0,\n            grossProfitMargin: 0\n        },\n        comparativeMetrics: {\n            previousDay: {\n                revenueGrowth: 0,\n                orderGrowth: 0,\n                customerGrowth: 0\n            },\n            previousWeek: {\n                revenueGrowth: 0,\n                orderGrowth: 0,\n                averageOrderValueGrowth: 0\n            },\n            monthToDate: {\n                totalRevenue: 0,\n                totalOrders: 0,\n                targetProgress: 0\n            }\n        },\n        operationalMetrics: {\n            averageItemsPerOrder: 0,\n            ordersPerStaff: 0,\n            revenuePerStaff: 0,\n            peakHours: []\n        },\n        qualityMetrics: {\n            customerComplaints: 0,\n            warrantyIssues: 0,\n            productDefects: 0\n        },\n        createdAt: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.now(),\n        updatedAt: firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.now(),\n        createdBy: \"system\",\n        updatedBy: \"system\"\n    };\n};\nclass ReportsService extends _base_service__WEBPACK_IMPORTED_MODULE_2__.BaseService {\n    /**\r\n   * Gets a daily report for a specific date. If the report doesn't exist,\r\n   * it generates a new one, saves it, and returns it.\r\n   * This is the primary method to be called from the frontend.\r\n   * @param reportDate The date for which to get or generate the report.\r\n   * @param userId The ID of the user triggering the action.\r\n   */ async getOrGenerateDailyReport(reportDate) {\n        let userId = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : \"system\";\n        const reportDateStr = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(reportDate, \"yyyy-MM-dd\");\n        const reportRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, this.collectionName, reportDateStr);\n        try {\n            // First, try to fetch the existing report.\n            const reportDoc = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDoc)(reportRef);\n            if (reportDoc.exists()) {\n                console.log(\"Fetched daily report for \".concat(reportDateStr, \" from cache.\"));\n                return {\n                    success: true,\n                    data: {\n                        id: reportDoc.id,\n                        ...reportDoc.data()\n                    }\n                };\n            }\n            console.log(\"Report for \".concat(reportDateStr, \" not found. Generating new report...\"));\n            // If it doesn't exist, proceed with generation.\n            const dailyReport = createEmptyDailyReport(reportDateStr, firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(reportDate));\n            dailyReport.generatedBy = userId;\n            dailyReport.createdBy = userId;\n            dailyReport.updatedBy = userId;\n            const start = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(reportDate);\n            const end = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(reportDate);\n            // 1. Fetch all sales orders for the given day\n            const ordersRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, _constants__WEBPACK_IMPORTED_MODULE_3__.COLLECTIONS.SALES_ORDERS);\n            const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(ordersRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"orderDate\", \">=\", firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(start)), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"orderDate\", \"<=\", firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(end)));\n            const orderSnapshots = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n            const orders = orderSnapshots.docs.map((doc)=>({\n                    id: doc.id,\n                    ...doc.data()\n                }));\n            // If there are no orders, we still save an empty report to cache this fact.\n            if (orders.length === 0) {\n                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(reportRef, dailyReport);\n                return {\n                    success: true,\n                    data: dailyReport\n                };\n            }\n            // 2. Fetch all order items for these orders\n            let allItems = [];\n            for (const order of orders){\n                const itemsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, _constants__WEBPACK_IMPORTED_MODULE_3__.COLLECTIONS.SALES_ORDERS, order.id, _constants__WEBPACK_IMPORTED_MODULE_3__.SUBCOLLECTIONS.ITEMS);\n                const itemsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(itemsRef);\n                itemsSnapshot.forEach((doc)=>{\n                    allItems.push({\n                        id: doc.id,\n                        ...doc.data()\n                    });\n                });\n            }\n            // 3. Process data and populate the report object (Full logic is preserved)\n            const completedOrders = orders.filter((o)=>o.status === \"completed\");\n            // === Sales Metrics ===\n            const sm = dailyReport.salesMetrics;\n            sm.totalOrders = orders.length;\n            sm.completedOrders = completedOrders.length;\n            sm.cancelledOrders = orders.filter((o)=>o.status === \"cancelled\").length;\n            sm.pendingOrders = orders.filter((o)=>o.status.startsWith(\"pending\")).length;\n            sm.totalRevenue = completedOrders.reduce((sum, o)=>sum + o.totalAmount, 0);\n            sm.totalQuantitySold = completedOrders.reduce((sum, o)=>sum + o.totalQuantity, 0);\n            sm.averageOrderValue = sm.completedOrders > 0 ? sm.totalRevenue / sm.completedOrders : 0;\n            orders.forEach((order)=>{\n                // Payment methods\n                const pm = order.paymentMethod;\n                if (!sm.paymentMethods[pm]) {\n                    sm.paymentMethods[pm] = {\n                        orderCount: 0,\n                        totalAmount: 0,\n                        percentage: 0\n                    };\n                }\n                sm.paymentMethods[pm].orderCount++;\n                if (order.status === \"completed\") {\n                    sm.paymentMethods[pm].totalAmount += order.totalAmount;\n                }\n                // Hourly breakdown\n                const hour = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(order.orderDate.toDate());\n                sm.hourlyBreakdown[hour].orders++;\n                if (order.status === \"completed\") {\n                    sm.hourlyBreakdown[hour].revenue += order.totalAmount;\n                }\n            });\n            // Calculate payment method percentages\n            if (sm.totalRevenue > 0) {\n                Object.keys(sm.paymentMethods).forEach((key)=>{\n                    sm.paymentMethods[key].percentage = sm.paymentMethods[key].totalAmount / sm.totalRevenue * 100;\n                });\n            }\n            // === Financial Summary ===\n            const fs = dailyReport.financialSummary;\n            fs.grossRevenue = completedOrders.reduce((sum, o)=>sum + o.subtotalAmount, 0);\n            fs.discountAmount = completedOrders.reduce((sum, o)=>sum + o.discountAmount, 0);\n            fs.taxAmount = completedOrders.reduce((sum, o)=>sum + o.taxAmount, 0);\n            fs.netRevenue = completedOrders.reduce((sum, o)=>sum + o.totalAmount, 0);\n            fs.totalCost = allItems.filter((item)=>completedOrders.some((o)=>o.id === item.salesOrderId)).reduce((sum, item)=>sum + item.unitCost, 0);\n            fs.grossProfit = fs.grossRevenue - fs.totalCost;\n            fs.grossProfitMargin = fs.grossRevenue > 0 ? fs.grossProfit / fs.grossRevenue * 100 : 0;\n            // === Product Performance ===\n            const pp = dailyReport.productPerformance;\n            const soldItems = allItems.filter((item)=>completedOrders.some((o)=>o.id === item.salesOrderId));\n            pp.totalProductsSold = soldItems.length;\n            const productSales = {};\n            const variantSales = {};\n            soldItems.forEach((item)=>{\n                // Product aggregation\n                if (!productSales[item.productId]) {\n                    productSales[item.productId] = {\n                        productId: item.productId,\n                        productName: item.productName,\n                        quantitySold: 0,\n                        revenue: 0,\n                        profit: 0\n                    };\n                }\n                productSales[item.productId].quantitySold += item.quantity;\n                productSales[item.productId].revenue += item.finalPrice;\n                productSales[item.productId].profit += item.finalPrice - item.unitCost;\n                // Variant aggregation\n                if (!variantSales[item.variantId]) {\n                    variantSales[item.variantId] = {\n                        variantId: item.variantId,\n                        productName: item.productName,\n                        colorName: item.colorName,\n                        storageCapacity: item.storageCapacity,\n                        quantitySold: 0,\n                        revenue: 0\n                    };\n                }\n                variantSales[item.variantId].quantitySold += item.quantity;\n                variantSales[item.variantId].revenue += item.finalPrice;\n            });\n            pp.uniqueProductsSold = Object.keys(productSales).length;\n            pp.topProducts = Object.values(productSales).sort((a, b)=>b.revenue - a.revenue).slice(0, 10) // Top 10\n            .map((p)=>({\n                    ...p,\n                    profitMargin: p.revenue > 0 ? p.profit / p.revenue * 100 : 0\n                }));\n            pp.topVariants = Object.values(variantSales).sort((a, b)=>b.revenue - a.revenue).slice(0, 10);\n            // === Staff Performance ===\n            const sp = dailyReport.staffPerformance;\n            const staffMetrics = {};\n            completedOrders.forEach((order)=>{\n                if (!staffMetrics[order.staffId]) {\n                    staffMetrics[order.staffId] = {\n                        staffId: order.staffId,\n                        staffName: order.staffName || \"Unknown\",\n                        ordersProcessed: 0,\n                        revenue: 0,\n                        customers: new Set()\n                    };\n                }\n                const metric = staffMetrics[order.staffId];\n                metric.ordersProcessed++;\n                metric.revenue += order.totalAmount;\n                if (order.customerId) {\n                    metric.customers.add(order.customerId);\n                }\n            });\n            sp.activeStaff = Object.keys(staffMetrics).length;\n            sp.staffMetrics = Object.values(staffMetrics).map((m)=>({\n                    staffId: m.staffId,\n                    staffName: m.staffName,\n                    ordersProcessed: m.ordersProcessed,\n                    revenue: m.revenue,\n                    customerCount: m.customers.size,\n                    averageOrderValue: m.ordersProcessed > 0 ? m.revenue / m.ordersProcessed : 0\n                }));\n            if (sp.staffMetrics.length > 0) {\n                const topSeller = Object.values(staffMetrics).sort((a, b)=>b.revenue - a.revenue)[0];\n                sp.topSalesPerson = {\n                    staffId: topSeller.staffId,\n                    staffName: topSeller.staffName,\n                    revenue: topSeller.revenue\n                };\n            }\n            // === Customer Metrics ===\n            const cm = dailyReport.customerMetrics;\n            const customerIds = new Set();\n            completedOrders.forEach((o)=>{\n                if (o.customerId) customerIds.add(o.customerId);\n            });\n            cm.totalCustomers = customerIds.size;\n            // === Save Report ===\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(reportRef, dailyReport, {\n                merge: true\n            });\n            return {\n                success: true,\n                data: dailyReport\n            };\n        } catch (error) {\n            console.error(\"Error getting or generating daily report for \".concat(reportDateStr, \":\"), error);\n            return this.handleError(error);\n        }\n    }\n    /**\r\n   * Generates and saves a daily sales report for a given date.\r\n   * This operation can be resource-intensive and should be run in a trusted environment (e.g., backend, cloud function).\r\n   * @param reportDate The date for which to generate the report.\r\n   * @param userId The ID of the user triggering the generation.\r\n   */ async generateDailyReport(reportDate) {\n        let userId = arguments.length > 1 && arguments[1] !== void 0 ? arguments[1] : \"system\";\n        try {\n            const reportDateStr = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_4__[\"default\"])(reportDate, \"yyyy-MM-dd\");\n            const reportTimestamp = firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(reportDate);\n            const dailyReport = createEmptyDailyReport(reportDateStr, reportTimestamp);\n            dailyReport.generatedBy = userId;\n            dailyReport.createdBy = userId;\n            dailyReport.updatedBy = userId;\n            const start = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_5__[\"default\"])(reportDate);\n            const end = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_6__[\"default\"])(reportDate);\n            // 1. Fetch all sales orders for the given day\n            const ordersRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, _constants__WEBPACK_IMPORTED_MODULE_3__.COLLECTIONS.SALES_ORDERS);\n            const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(ordersRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"orderDate\", \">=\", firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(start)), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"orderDate\", \"<=\", firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(end)));\n            const orderSnapshots = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n            const orders = orderSnapshots.docs.map((doc)=>({\n                    id: doc.id,\n                    ...doc.data()\n                }));\n            if (orders.length === 0) {\n                // No sales, save an empty report\n                const emptyReportRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, this.collectionName, reportDateStr);\n                await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(emptyReportRef, dailyReport);\n                return {\n                    success: true,\n                    data: dailyReport\n                };\n            }\n            // 2. Fetch all order items for these orders\n            let allItems = [];\n            for (const order of orders){\n                const itemsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, _constants__WEBPACK_IMPORTED_MODULE_3__.COLLECTIONS.SALES_ORDERS, order.id, _constants__WEBPACK_IMPORTED_MODULE_3__.SUBCOLLECTIONS.ORDER_ITEMS);\n                const itemsSnapshot = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(itemsRef);\n                itemsSnapshot.forEach((doc)=>{\n                    allItems.push({\n                        id: doc.id,\n                        ...doc.data()\n                    });\n                });\n            }\n            // 3. Process data and populate the report object\n            const completedOrders = orders.filter((o)=>o.status === \"completed\");\n            // === Sales Metrics ===\n            const sm = dailyReport.salesMetrics;\n            sm.totalOrders = orders.length;\n            sm.completedOrders = completedOrders.length;\n            sm.cancelledOrders = orders.filter((o)=>o.status === \"cancelled\").length;\n            sm.pendingOrders = orders.filter((o)=>o.status.startsWith(\"pending\")).length;\n            sm.totalRevenue = completedOrders.reduce((sum, o)=>sum + o.totalAmount, 0);\n            sm.totalQuantitySold = completedOrders.reduce((sum, o)=>sum + o.totalQuantity, 0);\n            sm.averageOrderValue = sm.completedOrders > 0 ? sm.totalRevenue / sm.completedOrders : 0;\n            orders.forEach((order)=>{\n                // Payment methods\n                const pm = order.paymentMethod;\n                if (!sm.paymentMethods[pm]) {\n                    sm.paymentMethods[pm] = {\n                        orderCount: 0,\n                        totalAmount: 0,\n                        percentage: 0\n                    };\n                }\n                sm.paymentMethods[pm].orderCount++;\n                if (order.status === \"completed\") {\n                    sm.paymentMethods[pm].totalAmount += order.totalAmount;\n                }\n                // Hourly breakdown\n                const hour = (0,_barrel_optimize_names_endOfDay_format_getHours_startOfDay_date_fns__WEBPACK_IMPORTED_MODULE_7__[\"default\"])(order.orderDate.toDate());\n                sm.hourlyBreakdown[hour].orders++;\n                if (order.status === \"completed\") {\n                    sm.hourlyBreakdown[hour].revenue += order.totalAmount;\n                }\n            });\n            // Calculate payment method percentages\n            if (sm.totalRevenue > 0) {\n                Object.keys(sm.paymentMethods).forEach((key)=>{\n                    sm.paymentMethods[key].percentage = sm.paymentMethods[key].totalAmount / sm.totalRevenue * 100;\n                });\n            }\n            // === Financial Summary ===\n            const fs = dailyReport.financialSummary;\n            fs.grossRevenue = completedOrders.reduce((sum, o)=>sum + o.subtotalAmount, 0);\n            fs.discountAmount = completedOrders.reduce((sum, o)=>sum + o.discountAmount, 0);\n            fs.taxAmount = completedOrders.reduce((sum, o)=>sum + o.taxAmount, 0);\n            fs.netRevenue = completedOrders.reduce((sum, o)=>sum + o.totalAmount, 0);\n            fs.totalCost = allItems.filter((item)=>completedOrders.some((o)=>o.id === item.salesOrderId)).reduce((sum, item)=>sum + item.unitCost, 0);\n            fs.grossProfit = fs.grossRevenue - fs.totalCost;\n            fs.grossProfitMargin = fs.grossRevenue > 0 ? fs.grossProfit / fs.grossRevenue * 100 : 0;\n            // === Product Performance ===\n            const pp = dailyReport.productPerformance;\n            const soldItems = allItems.filter((item)=>completedOrders.some((o)=>o.id === item.salesOrderId));\n            pp.totalProductsSold = soldItems.length;\n            const productSales = {};\n            const variantSales = {};\n            soldItems.forEach((item)=>{\n                // Product aggregation\n                if (!productSales[item.productId]) {\n                    productSales[item.productId] = {\n                        productId: item.productId,\n                        productName: item.productName,\n                        quantitySold: 0,\n                        revenue: 0,\n                        profit: 0\n                    };\n                }\n                productSales[item.productId].quantitySold += item.quantity;\n                productSales[item.productId].revenue += item.finalPrice;\n                productSales[item.productId].profit += item.finalPrice - item.unitCost;\n                // Variant aggregation\n                if (!variantSales[item.variantId]) {\n                    variantSales[item.variantId] = {\n                        variantId: item.variantId,\n                        productName: item.productName,\n                        colorName: item.colorName,\n                        storageCapacity: item.storageCapacity,\n                        quantitySold: 0,\n                        revenue: 0\n                    };\n                }\n                variantSales[item.variantId].quantitySold += item.quantity;\n                variantSales[item.variantId].revenue += item.finalPrice;\n            });\n            pp.uniqueProductsSold = Object.keys(productSales).length;\n            pp.topProducts = Object.values(productSales).sort((a, b)=>b.revenue - a.revenue).slice(0, 10) // Top 10\n            .map((p)=>({\n                    ...p,\n                    profitMargin: p.revenue > 0 ? p.profit / p.revenue * 100 : 0,\n                    profit: p.profit\n                }));\n            pp.topVariants = Object.values(variantSales).sort((a, b)=>b.revenue - a.revenue).slice(0, 10);\n            // === Staff Performance ===\n            const sp = dailyReport.staffPerformance;\n            const staffMetrics = {};\n            completedOrders.forEach((order)=>{\n                if (!staffMetrics[order.staffId]) {\n                    staffMetrics[order.staffId] = {\n                        staffId: order.staffId,\n                        staffName: order.staffName || \"Unknown\",\n                        ordersProcessed: 0,\n                        revenue: 0,\n                        customers: new Set()\n                    };\n                }\n                const metric = staffMetrics[order.staffId];\n                metric.ordersProcessed++;\n                metric.revenue += order.totalAmount;\n                if (order.customerId) {\n                    metric.customers.add(order.customerId);\n                }\n            });\n            sp.activeStaff = Object.keys(staffMetrics).length;\n            sp.staffMetrics = Object.values(staffMetrics).map((m)=>({\n                    staffId: m.staffId,\n                    staffName: m.staffName,\n                    ordersProcessed: m.ordersProcessed,\n                    revenue: m.revenue,\n                    customerCount: m.customers.size,\n                    averageOrderValue: m.ordersProcessed > 0 ? m.revenue / m.ordersProcessed : 0\n                }));\n            if (sp.staffMetrics.length > 0) {\n                const topSeller = Object.values(staffMetrics).sort((a, b)=>b.revenue - a.revenue)[0];\n                sp.topSalesPerson = {\n                    staffId: topSeller.staffId,\n                    staffName: topSeller.staffName,\n                    revenue: topSeller.revenue\n                };\n            }\n            // === Customer Metrics ===\n            // This is a simplified version. For accurate new/returning, we need to check customer's history.\n            const cm = dailyReport.customerMetrics;\n            const customerIds = new Set();\n            completedOrders.forEach((o)=>{\n                if (o.customerId) customerIds.add(o.customerId);\n            });\n            cm.totalCustomers = customerIds.size;\n            // This requires fetching each customer doc, can be slow. A better approach is to use a summary field on the customer doc\n            // or use a separate analytics service/cloud function. For now, this is omitted for performance reasons.\n            // cm.newCustomers = ...\n            // cm.returningCustomers = ...\n            // === Save Report ===\n            const reportRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.doc)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, this.collectionName, reportDateStr);\n            await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.setDoc)(reportRef, dailyReport, {\n                merge: true\n            });\n            return {\n                success: true,\n                data: dailyReport\n            };\n        } catch (error) {\n            console.error(\"Error generating daily report:\", error);\n            return this.handleError(error);\n        }\n    }\n    /**\r\n   * Generates a monthly report by aggregating daily reports for a given month and year.\r\n   * @param year The year of the report.\r\n   * @param month The month of the report (1-12).\r\n   * @param userId The ID of the user triggering the generation.\r\n   */ async getMonthlyReport(year, month) {\n        let userId = arguments.length > 2 && arguments[2] !== void 0 ? arguments[2] : \"system\";\n        try {\n            const startDate = new Date(year, month - 1, 1);\n            const endDate = new Date(year, month, 0);\n            // 1. Fetch all daily reports within the month\n            const dailyReportsRef = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.collection)(_lib_firebase__WEBPACK_IMPORTED_MODULE_1__.db, this.collectionName);\n            const q = (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.query)(dailyReportsRef, (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"reportTimestamp\", \">=\", firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(startDate)), (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.where)(\"reportTimestamp\", \"<=\", firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.Timestamp.fromDate(endDate)));\n            const snapshots = await (0,firebase_firestore__WEBPACK_IMPORTED_MODULE_0__.getDocs)(q);\n            if (snapshots.empty) {\n                return {\n                    success: false,\n                    error: \"Kh\\xf4ng c\\xf3 dữ liệu b\\xe1o c\\xe1o cho th\\xe1ng \".concat(month, \"/\").concat(year, \".\"),\n                    errorCode: \"NO_DATA\"\n                };\n            }\n            const dailyReports = snapshots.docs.map((doc)=>doc.data());\n            // 2. Aggregate the data\n            // Note: This is a simplified aggregation. A full implementation would create a FirebaseMonthlyReport object.\n            // For now, we'll return an aggregated summary.\n            const monthlySummary = {\n                reportMonth: \"\".concat(year, \"-\").concat(month.toString().padStart(2, \"0\")),\n                totalDaysReported: dailyReports.length,\n                totalRevenue: 0,\n                totalOrders: 0,\n                totalQuantitySold: 0,\n                grossProfit: 0,\n                topProducts: new Map(),\n                staffPerformance: new Map()\n            };\n            for (const daily of dailyReports){\n                monthlySummary.totalRevenue += daily.salesMetrics.totalRevenue;\n                monthlySummary.totalOrders += daily.salesMetrics.completedOrders;\n                monthlySummary.totalQuantitySold += daily.salesMetrics.totalQuantitySold;\n                monthlySummary.grossProfit += daily.financialSummary.grossProfit;\n                // Aggregate product performance\n                daily.productPerformance.topProducts.forEach((p)=>{\n                    const existing = monthlySummary.topProducts.get(p.productId);\n                    if (existing) {\n                        existing.quantitySold += p.quantitySold;\n                        existing.revenue += p.revenue;\n                    } else {\n                        monthlySummary.topProducts.set(p.productId, {\n                            productName: p.productName,\n                            quantitySold: p.quantitySold,\n                            revenue: p.revenue\n                        });\n                    }\n                });\n                // Aggregate staff performance\n                daily.staffPerformance.staffMetrics.forEach((s)=>{\n                    const existing = monthlySummary.staffPerformance.get(s.staffId);\n                    if (existing) {\n                        existing.revenue += s.revenue;\n                        existing.ordersProcessed += s.ordersProcessed;\n                    } else {\n                        monthlySummary.staffPerformance.set(s.staffId, {\n                            staffName: s.staffName,\n                            revenue: s.revenue,\n                            ordersProcessed: s.ordersProcessed\n                        });\n                    }\n                });\n            }\n            // Convert maps to arrays for the final output\n            const finalReport = {\n                ...monthlySummary,\n                topProducts: Array.from(monthlySummary.topProducts.values()).sort((a, b)=>b.revenue - a.revenue).slice(0, 10),\n                staffPerformance: Array.from(monthlySummary.staffPerformance.values()).sort((a, b)=>b.revenue - a.revenue)\n            };\n            return {\n                success: true,\n                data: finalReport\n            };\n        } catch (error) {\n            console.error(\"Error generating monthly report for \".concat(month, \"/\").concat(year, \":\"), error);\n            return this.handleError(error);\n        }\n    }\n    constructor(){\n        super(_constants__WEBPACK_IMPORTED_MODULE_3__.COLLECTIONS.REPORTS);\n    }\n}\nconst reportsService = new ReportsService();\n\n\n;\n    // Wrapped in an IIFE to avoid polluting the global scope\n    ;\n    (function () {\n        var _a, _b;\n        // Legacy CSS implementations will `eval` browser code in a Node.js context\n        // to extract CSS. For backwards compatibility, we need to check we're in a\n        // browser context before continuing.\n        if (typeof self !== 'undefined' &&\n            // AMP / No-JS mode does not inject these helpers:\n            '$RefreshHelpers$' in self) {\n            // @ts-ignore __webpack_module__ is global\n            var currentExports = module.exports;\n            // @ts-ignore __webpack_module__ is global\n            var prevSignature = (_b = (_a = module.hot.data) === null || _a === void 0 ? void 0 : _a.prevSignature) !== null && _b !== void 0 ? _b : null;\n            // This cannot happen in MainTemplate because the exports mismatch between\n            // templating and execution.\n            self.$RefreshHelpers$.registerExportsForReactRefresh(currentExports, module.id);\n            // A module can be accepted automatically based on its exports, e.g. when\n            // it is a Refresh Boundary.\n            if (self.$RefreshHelpers$.isReactRefreshBoundary(currentExports)) {\n                // Save the previous exports signature on update so we can compare the boundary\n                // signatures. We avoid saving exports themselves since it causes memory leaks (https://github.com/vercel/next.js/pull/53797)\n                module.hot.dispose(function (data) {\n                    data.prevSignature =\n                        self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports);\n                });\n                // Unconditionally accept an update to this module, we'll check if it's\n                // still a Refresh Boundary later.\n                // @ts-ignore importMeta is replaced in the loader\n                module.hot.accept();\n                // This field is set when the previous version of this module was a\n                // Refresh Boundary, letting us know we need to check for invalidation or\n                // enqueue an update.\n                if (prevSignature !== null) {\n                    // A boundary can become ineligible if its exports are incompatible\n                    // with the previous exports.\n                    //\n                    // For example, if you add/remove/change exports, we'll want to\n                    // re-execute the importing modules, and force those components to\n                    // re-render. Similarly, if you convert a class component to a\n                    // function, we want to invalidate the boundary.\n                    if (self.$RefreshHelpers$.shouldInvalidateReactRefreshBoundary(prevSignature, self.$RefreshHelpers$.getRefreshBoundarySignature(currentExports))) {\n                        module.hot.invalidate();\n                    }\n                    else {\n                        self.$RefreshHelpers$.scheduleUpdate();\n                    }\n                }\n            }\n            else {\n                // Since we just executed the code for the module, it's possible that the\n                // new exports made it ineligible for being a boundary.\n                // We only care about the case when we were _previously_ a boundary,\n                // because we already accepted this update (accidental side effect).\n                var isNoLongerABoundary = prevSignature !== null;\n                if (isNoLongerABoundary) {\n                    module.hot.invalidate();\n                }\n            }\n        }\n    })();\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwcC1wYWdlcy1icm93c2VyKS8uL3NyYy9saWIvZmlyZWJhc2Uvc2VydmljZXMvcmVwb3J0cy5zZXJ2aWNlLnRzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7QUFVNEI7QUFDUTtBQUlaO0FBTWtDO0FBUXhDO0FBRWxCLHFEQUFxRDtBQUNyRCxNQUFNZ0IseUJBQXlCLENBQzdCQyxlQUNBQztJQUVBLE9BQU87UUFDTEMsSUFBSUY7UUFDSkcsWUFBWUg7UUFDWkMsaUJBQWlCQTtRQUNqQkcsYUFBYWhCLHlEQUFTQSxDQUFDaUIsR0FBRztRQUMxQkMsYUFBYTtRQUNiQyxhQUFhO1FBQ2JDLGNBQWM7WUFDWkMsYUFBYTtZQUNiQyxpQkFBaUI7WUFDakJDLGlCQUFpQjtZQUNqQkMsZUFBZTtZQUNmQyxjQUFjO1lBQ2RDLG1CQUFtQjtZQUNuQkMsbUJBQW1CO1lBQ25CQyxnQkFBZ0IsQ0FBQztZQUNqQkMsaUJBQWlCQyxNQUFNQyxJQUFJLENBQUM7Z0JBQUVDLFFBQVE7WUFBRyxHQUFHLENBQUNDLEdBQUdDLElBQU87b0JBQ3JEQyxNQUFNRDtvQkFDTkUsUUFBUTtvQkFDUkMsU0FBUztnQkFDWDtRQUNGO1FBQ0FDLG9CQUFvQjtZQUNsQkMsbUJBQW1CO1lBQ25CQyxvQkFBb0I7WUFDcEJDLGFBQWEsRUFBRTtZQUNmQyxtQkFBbUIsQ0FBQztZQUNwQkMsYUFBYSxFQUFFO1FBQ2pCO1FBQ0FDLGtCQUFrQjtZQUNoQkMsYUFBYTtZQUNiQyxjQUFjLEVBQUU7WUFDaEJDLGdCQUFnQjtnQkFBRUMsU0FBUztnQkFBSUMsV0FBVztnQkFBSVosU0FBUztZQUFFO1FBQzNEO1FBQ0FhLGlCQUFpQjtZQUNmQyxnQkFBZ0I7WUFDaEJDLGNBQWM7WUFDZEMsb0JBQW9CO1lBQ3BCQyxjQUFjO1lBQ2RDLGtCQUFrQixDQUFDO1FBQ3JCO1FBQ0FDLGtCQUFrQjtZQUNoQkMsV0FBVztZQUNYQyxnQkFBZ0I7WUFDaEJDLGdCQUFnQjtZQUNoQkMsaUJBQWlCO1lBQ2pCQyxnQkFBZ0IsRUFB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QU1BLEVBQUVsSSxPQUFPLEdBQUdpSSxFQUFFakksT0FBTyxFQUFFbUksS0FBSyxDQUFDLEdBQUc7Z0JBQzNHNUgsa0JBQWtCZCxNQUFNQyxJQUFJLENBQUMwSyxlQUFlN0osZ0JBQWdCLENBQUN3SCxNQUFNLElBQUlDLElBQUksQ0FBQyxDQUFDQyxHQUFFQyxJQUFNQSxFQUFFbEksT0FBTyxHQUFHaUksRUFBRWpJLE9BQU87WUFDOUc7WUFFQSxPQUFPO2dCQUFFdUUsU0FBUztnQkFBTUMsTUFBTXVHO1lBQVk7UUFFNUMsRUFBRSxPQUFPM0IsT0FBTztZQUNkL0UsUUFBUStFLEtBQUssQ0FBQyx1Q0FBZ0RNLE9BQVRDLE9BQU0sS0FBUSxPQUFMRCxNQUFLLE1BQUlOO1lBQ3ZFLE9BQU8sSUFBSSxDQUFDQyxXQUFXLENBQUNEO1FBQzFCO0lBQ0Y7SUF0a0JBNEIsYUFBYztRQUNaLEtBQUssQ0FBQ2hOLG1EQUFXQSxDQUFDaU4sT0FBTztJQUMzQjtBQXFrQkY7QUFFTyxNQUFNQyxpQkFBaUIsSUFBSXBILGlCQUFpQiIsInNvdXJjZXMiOlsid2VicGFjazovL19OX0UvLi9zcmMvbGliL2ZpcmViYXNlL3NlcnZpY2VzL3JlcG9ydHMuc2VydmljZS50cz9mMDM2Il0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7XHJcbiAgY29sbGVjdGlvbixcclxuICBkb2MsXHJcbiAgZ2V0RG9jcyxcclxuICBxdWVyeSxcclxuICB3aGVyZSxcclxuICBUaW1lc3RhbXAsXHJcbiAgZ2V0RG9jLFxyXG4gIHNldERvYyxcclxuICBvcmRlckJ5LFxyXG59IGZyb20gXCJmaXJlYmFzZS9maXJlc3RvcmVcIjtcclxuaW1wb3J0IHsgZGIgfSBmcm9tIFwiQC9saWIvZmlyZWJhc2VcIjtcclxuaW1wb3J0IHtcclxuICBCYXNlU2VydmljZSxcclxuICBTZXJ2aWNlUmVzcG9uc2UsXHJcbn0gZnJvbSBcIi4vYmFzZS5zZXJ2aWNlXCI7XHJcbmltcG9ydCB7XHJcbiAgRmlyZWJhc2VTYWxlc09yZGVyLFxyXG4gIEZpcmViYXNlU2FsZXNPcmRlckl0ZW0sXHJcbn0gZnJvbSBcIkAvbGliL2ZpcmViYXNlL21vZGVscy9wb3MubW9kZWxcIjtcclxuaW1wb3J0IHsgRmlyZWJhc2VEYWlseVJlcG9ydCB9IGZyb20gXCJAL2xpYi9maXJlYmFzZS9tb2RlbHMvcmVwb3J0cy5tb2RlbFwiO1xyXG5pbXBvcnQgeyBDT0xMRUNUSU9OUywgU1VCQ09MTEVDVElPTlMgfSBmcm9tIFwiQC9jb25zdGFudHNcIjtcclxuaW1wb3J0IHtcclxuICBmb3JtYXQsXHJcbiAgc3RhcnRPZkRheSxcclxuICBlbmRPZkRheSxcclxuICBzdWJEYXlzLFxyXG4gIGdldEhvdXJzLFxyXG4gIHN0YXJ0T2ZIb3VyLFxyXG59IGZyb20gXCJkYXRlLWZuc1wiO1xyXG5cclxuLy8gQSBoZWxwZXIgdG8gY3JlYXRlIGFuIGVtcHR5IGRhaWx5IHJlcG9ydCBzdHJ1Y3R1cmVcclxuY29uc3QgY3JlYXRlRW1wdHlEYWlseVJlcG9ydCA9IChcclxuICByZXBvcnREYXRlU3RyOiBzdHJpbmcsXHJcbiAgcmVwb3J0VGltZXN0YW1wOiBUaW1lc3RhbXBcclxuKTogRmlyZWJhc2VEYWlseVJlcG9ydCA9PiB7XHJcbiAgcmV0dXJuIHtcclxuICAgIGlkOiByZXBvcnREYXRlU3RyLFxyXG4gICAgcmVwb3J0RGF0ZTogcmVwb3J0RGF0ZVN0cixcclxuICAgIHJlcG9ydFRpbWVzdGFtcDogcmVwb3J0VGltZXN0YW1wLFxyXG4gICAgZ2VuZXJhdGVkQXQ6IFRpbWVzdGFtcC5ub3coKSxcclxuICAgIGdlbmVyYXRlZEJ5OiBcInN5c3RlbVwiLCAvLyBPciBwYXNzIHVzZXJJZFxyXG4gICAgaXNGaW5hbGl6ZWQ6IGZhbHNlLFxyXG4gICAgc2FsZXNNZXRyaWNzOiB7XHJcbiAgICAgIHRvdGFsT3JkZXJzOiAwLFxyXG4gICAgICBjb21wbGV0ZWRPcmRlcnM6IDAsXHJcbiAgICAgIGNhbmNlbGxlZE9yZGVyczogMCxcclxuICAgICAgcGVuZGluZ09yZGVyczogMCxcclxuICAgICAgdG90YWxSZXZlbnVlOiAwLFxyXG4gICAgICB0b3RhbFF1YW50aXR5U29sZDogMCxcclxuICAgICAgYXZlcmFnZU9yZGVyVmFsdWU6IDAsXHJcbiAgICAgIHBheW1lbnRNZXRob2RzOiB7fSxcclxuICAgICAgaG91cmx5QnJlYWtkb3duOiBBcnJheS5mcm9tKHsgbGVuZ3RoOiAyNCB9LCAoXywgaSkgPT4gKHtcclxuICAgICAgICBob3VyOiBpLFxyXG4gICAgICAgIG9yZGVyczogMCxcclxuICAgICAgICByZXZlbnVlOiAwLFxyXG4gICAgICB9KSksXHJcbiAgICB9LFxyXG4gICAgcHJvZHVjdFBlcmZvcm1hbmNlOiB7XHJcbiAgICAgIHRvdGFsUHJvZHVjdHNTb2xkOiAwLFxyXG4gICAgICB1bmlxdWVQcm9kdWN0c1NvbGQ6IDAsXHJcbiAgICAgIHRvcFByb2R1Y3RzOiBbXSxcclxuICAgICAgY2F0ZWdvcnlCcmVha2Rvd246IHt9LFxyXG4gICAgICB0b3BWYXJpYW50czogW10sXHJcbiAgICB9LFxyXG4gICAgc3RhZmZQZXJmb3JtYW5jZToge1xyXG4gICAgICBhY3RpdmVTdGFmZjogMCxcclxuICAgICAgc3RhZmZNZXRyaWNzOiBbXSxcclxuICAgICAgdG9wU2FsZXNQZXJzb246IHsgc3RhZmZJZDogXCJcIiwgc3RhZmZOYW1lOiBcIlwiLCByZXZlbnVlOiAwIH0sXHJcbiAgICB9LFxyXG4gICAgY3VzdG9tZXJNZXRyaWNzOiB7XHJcbiAgICAgIHRvdGFsQ3VzdG9tZXJzOiAwLFxyXG4gICAgICBuZXdDdXN0b21lcnM6IDAsXHJcbiAgICAgIHJldHVybmluZ0N1c3RvbWVyczogMCxcclxuICAgICAgdmlwQ3VzdG9tZXJzOiAwLFxyXG4gICAgICBjdXN0b21lclNlZ21lbnRzOiB7fSxcclxuICAgIH0sXHJcbiAgICBpbnZlbnRvcnlNZXRyaWNzOiB7XHJcbiAgICAgIGl0ZW1zU29sZDogMCxcclxuICAgICAgc3RvY2tNb3ZlbWVudHM6IDAsXHJcbiAgICAgIGxvd1N0b2NrQWxlcnRzOiAwLFxyXG4gICAgICBvdXRPZlN0b2NrSXRlbXM6IDAsXHJcbiAgICAgIHRvcE1vdmluZ0l0ZW1zOiBbXSxcclxuICAgIH0sXHJcbiAgICByZXR1cm5NZXRyaWNzOiB7XHJcbiAgICAgIHRvdGFsUmV0dXJuczogMCxcclxuICAgICAgcmV0dXJuVmFsdWU6IDAsXHJcbiAgICAgIHJldHVyblJhdGU6IDAsXHJcbiAgICAgIGV4Y2hhbmdlQ291bnQ6IDAsXHJcbiAgICAgIHJlZnVuZEFtb3VudDogMCxcclxuICAgICAgcmV0dXJuUmVhc29uczoge30sXHJcbiAgICB9LFxyXG4gICAgZmluYW5jaWFsU3VtbWFyeToge1xyXG4gICAgICBncm9zc1JldmVudWU6IDAsXHJcbiAgICAgIGRpc2NvdW50QW1vdW50OiAwLFxyXG4gICAgICB0YXhBbW91bnQ6IDAsXHJcbiAgICAgIG5ldFJldmVudWU6IDAsXHJcbiAgICAgIHRvdGFsQ29zdDogMCxcclxuICAgICAgZ3Jvc3NQcm9maXQ6IDAsXHJcbiAgICAgIGdyb3NzUHJvZml0TWFyZ2luOiAwLFxyXG4gICAgfSxcclxuICAgIGNvbXBhcmF0aXZlTWV0cmljczoge1xyXG4gICAgICBwcmV2aW91c0RheTogeyByZXZlbnVlR3Jvd3RoOiAwLCBvcmRlckdyb3d0aDogMCwgY3VzdG9tZXJHcm93dGg6IDAgfSxcclxuICAgICAgcHJldmlvdXNXZWVrOiB7XHJcbiAgICAgICAgcmV2ZW51ZUdyb3d0aDogMCxcclxuICAgICAgICBvcmRlckdyb3d0aDogMCxcclxuICAgICAgICBhdmVyYWdlT3JkZXJWYWx1ZUdyb3d0aDogMCxcclxuICAgICAgfSxcclxuICAgICAgbW9udGhUb0RhdGU6IHsgdG90YWxSZXZlbnVlOiAwLCB0b3RhbE9yZGVyczogMCwgdGFyZ2V0UHJvZ3Jlc3M6IDAgfSxcclxuICAgIH0sXHJcbiAgICBvcGVyYXRpb25hbE1ldHJpY3M6IHtcclxuICAgICAgYXZlcmFnZUl0ZW1zUGVyT3JkZXI6IDAsXHJcbiAgICAgIG9yZGVyc1BlclN0YWZmOiAwLFxyXG4gICAgICByZXZlbnVlUGVyU3RhZmY6IDAsXHJcbiAgICAgIHBlYWtIb3VyczogW10sXHJcbiAgICB9LFxyXG4gICAgcXVhbGl0eU1ldHJpY3M6IHtcclxuICAgICAgY3VzdG9tZXJDb21wbGFpbnRzOiAwLFxyXG4gICAgICB3YXJyYW50eUlzc3VlczogMCxcclxuICAgICAgcHJvZHVjdERlZmVjdHM6IDAsXHJcbiAgICB9LFxyXG4gICAgY3JlYXRlZEF0OiBUaW1lc3RhbXAubm93KCksXHJcbiAgICB1cGRhdGVkQXQ6IFRpbWVzdGFtcC5ub3coKSxcclxuICAgIGNyZWF0ZWRCeTogXCJzeXN0ZW1cIixcclxuICAgIHVwZGF0ZWRCeTogXCJzeXN0ZW1cIixcclxuICB9O1xyXG59O1xyXG5cclxuZXhwb3J0IGNsYXNzIFJlcG9ydHNTZXJ2aWNlIGV4dGVuZHMgQmFzZVNlcnZpY2Uge1xyXG4gIGNvbnN0cnVjdG9yKCkge1xyXG4gICAgc3VwZXIoQ09MTEVDVElPTlMuUkVQT1JUUyk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBHZXRzIGEgZGFpbHkgcmVwb3J0IGZvciBhIHNwZWNpZmljIGRhdGUuIElmIHRoZSByZXBvcnQgZG9lc24ndCBleGlzdCxcclxuICAgKiBpdCBnZW5lcmF0ZXMgYSBuZXcgb25lLCBzYXZlcyBpdCwgYW5kIHJldHVybnMgaXQuXHJcbiAgICogVGhpcyBpcyB0aGUgcHJpbWFyeSBtZXRob2QgdG8gYmUgY2FsbGVkIGZyb20gdGhlIGZyb250ZW5kLlxyXG4gICAqIEBwYXJhbSByZXBvcnREYXRlIFRoZSBkYXRlIGZvciB3aGljaCB0byBnZXQgb3IgZ2VuZXJhdGUgdGhlIHJlcG9ydC5cclxuICAgKiBAcGFyYW0gdXNlcklkIFRoZSBJRCBvZiB0aGUgdXNlciB0cmlnZ2VyaW5nIHRoZSBhY3Rpb24uXHJcbiAgICovXHJcbiAgYXN5bmMgZ2V0T3JHZW5lcmF0ZURhaWx5UmVwb3J0KFxyXG4gICAgcmVwb3J0RGF0ZTogRGF0ZSxcclxuICAgIHVzZXJJZDogc3RyaW5nID0gXCJzeXN0ZW1cIlxyXG4gICk6IFByb21pc2U8U2VydmljZVJlc3BvbnNlPEZpcmViYXNlRGFpbHlSZXBvcnQ+PiB7XHJcbiAgICBjb25zdCByZXBvcnREYXRlU3RyID0gZm9ybWF0KHJlcG9ydERhdGUsIFwieXl5eS1NTS1kZFwiKTtcclxuICAgIGNvbnN0IHJlcG9ydFJlZiA9IGRvYyhkYiwgdGhpcy5jb2xsZWN0aW9uTmFtZSwgcmVwb3J0RGF0ZVN0cik7XHJcblxyXG4gICAgdHJ5IHtcclxuICAgICAgLy8gRmlyc3QsIHRyeSB0byBmZXRjaCB0aGUgZXhpc3RpbmcgcmVwb3J0LlxyXG4gICAgICBjb25zdCByZXBvcnREb2MgPSBhd2FpdCBnZXREb2MocmVwb3J0UmVmKTtcclxuICAgICAgaWYgKHJlcG9ydERvYy5leGlzdHMoKSkge1xyXG4gICAgICAgIGNvbnNvbGUubG9nKGBGZXRjaGVkIGRhaWx5IHJlcG9ydCBmb3IgJHtyZXBvcnREYXRlU3RyfSBmcm9tIGNhY2hlLmApO1xyXG4gICAgICAgIHJldHVybiB7XHJcbiAgICAgICAgICBzdWNjZXNzOiB0cnVlLFxyXG4gICAgICAgICAgZGF0YTogeyBpZDogcmVwb3J0RG9jLmlkLCAuLi5yZXBvcnREb2MuZGF0YSgpIH0gYXMgRmlyZWJhc2VEYWlseVJlcG9ydCxcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zb2xlLmxvZyhgUmVwb3J0IGZvciAke3JlcG9ydERhdGVTdHJ9IG5vdCBmb3VuZC4gR2VuZXJhdGluZyBuZXcgcmVwb3J0Li4uYCk7XHJcbiAgICAgIC8vIElmIGl0IGRvZXNuJ3QgZXhpc3QsIHByb2NlZWQgd2l0aCBnZW5lcmF0aW9uLlxyXG4gICAgICBjb25zdCBkYWlseVJlcG9ydCA9IGNyZWF0ZUVtcHR5RGFpbHlSZXBvcnQoXHJcbiAgICAgICAgcmVwb3J0RGF0ZVN0cixcclxuICAgICAgICBUaW1lc3RhbXAuZnJvbURhdGUocmVwb3J0RGF0ZSlcclxuICAgICAgKTtcclxuICAgICAgZGFpbHlSZXBvcnQuZ2VuZXJhdGVkQnkgPSB1c2VySWQ7XHJcbiAgICAgIGRhaWx5UmVwb3J0LmNyZWF0ZWRCeSA9IHVzZXJJZDtcclxuICAgICAgZGFpbHlSZXBvcnQudXBkYXRlZEJ5ID0gdXNlcklkO1xyXG5cclxuICAgICAgY29uc3Qgc3RhcnQgPSBzdGFydE9mRGF5KHJlcG9ydERhdGUpO1xyXG4gICAgICBjb25zdCBlbmQgPSBlbmRPZkRheShyZXBvcnREYXRlKTtcclxuXHJcbiAgICAgIC8vIDEuIEZldGNoIGFsbCBzYWxlcyBvcmRlcnMgZm9yIHRoZSBnaXZlbiBkYXlcclxuICAgICAgY29uc3Qgb3JkZXJzUmVmID0gY29sbGVjdGlvbihkYiwgQ09MTEVDVElPTlMuU0FMRVNfT1JERVJTKTtcclxuICAgICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICAgIG9yZGVyc1JlZixcclxuICAgICAgICB3aGVyZShcIm9yZGVyRGF0ZVwiLCBcIj49XCIsIFRpbWVzdGFtcC5mcm9tRGF0ZShzdGFydCkpLFxyXG4gICAgICAgIHdoZXJlKFwib3JkZXJEYXRlXCIsIFwiPD1cIiwgVGltZXN0YW1wLmZyb21EYXRlKGVuZCkpXHJcbiAgICAgICk7XHJcbiAgICAgIGNvbnN0IG9yZGVyU25hcHNob3RzID0gYXdhaXQgZ2V0RG9jcyhxKTtcclxuICAgICAgY29uc3Qgb3JkZXJzID0gb3JkZXJTbmFwc2hvdHMuZG9jcy5tYXAoXHJcbiAgICAgICAgKGRvYykgPT4gKHsgaWQ6IGRvYy5pZCwgLi4uZG9jLmRhdGEoKSB9IGFzIEZpcmViYXNlU2FsZXNPcmRlcilcclxuICAgICAgKTtcclxuXHJcbiAgICAgIC8vIElmIHRoZXJlIGFyZSBubyBvcmRlcnMsIHdlIHN0aWxsIHNhdmUgYW4gZW1wdHkgcmVwb3J0IHRvIGNhY2hlIHRoaXMgZmFjdC5cclxuICAgICAgaWYgKG9yZGVycy5sZW5ndGggPT09IDApIHtcclxuICAgICAgICBhd2FpdCBzZXREb2MocmVwb3J0UmVmLCBkYWlseVJlcG9ydCk7XHJcbiAgICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogZGFpbHlSZXBvcnQgfTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMi4gRmV0Y2ggYWxsIG9yZGVyIGl0ZW1zIGZvciB0aGVzZSBvcmRlcnNcclxuICAgICAgbGV0IGFsbEl0ZW1zOiBGaXJlYmFzZVNhbGVzT3JkZXJJdGVtW10gPSBbXTtcclxuICAgICAgZm9yIChjb25zdCBvcmRlciBvZiBvcmRlcnMpIHtcclxuICAgICAgICBjb25zdCBpdGVtc1JlZiA9IGNvbGxlY3Rpb24oXHJcbiAgICAgICAgICBkYixcclxuICAgICAgICAgIENPTExFQ1RJT05TLlNBTEVTX09SREVSUyxcclxuICAgICAgICAgIG9yZGVyLmlkLFxyXG4gICAgICAgICAgU1VCQ09MTEVDVElPTlMuSVRFTVNcclxuICAgICAgICApO1xyXG4gICAgICAgIGNvbnN0IGl0ZW1zU25hcHNob3QgPSBhd2FpdCBnZXREb2NzKGl0ZW1zUmVmKTtcclxuICAgICAgICBpdGVtc1NuYXBzaG90LmZvckVhY2goKGRvYykgPT4ge1xyXG4gICAgICAgICAgYWxsSXRlbXMucHVzaCh7IGlkOiBkb2MuaWQsIC4uLmRvYy5kYXRhKCkgfSBhcyBGaXJlYmFzZVNhbGVzT3JkZXJJdGVtKTtcclxuICAgICAgICB9KTtcclxuICAgICAgfVxyXG5cclxuICAgICAgLy8gMy4gUHJvY2VzcyBkYXRhIGFuZCBwb3B1bGF0ZSB0aGUgcmVwb3J0IG9iamVjdCAoRnVsbCBsb2dpYyBpcyBwcmVzZXJ2ZWQpXHJcbiAgICAgIGNvbnN0IGNvbXBsZXRlZE9yZGVycyA9IG9yZGVycy5maWx0ZXIoKG8pID0+IG8uc3RhdHVzID09PSBcImNvbXBsZXRlZFwiKTtcclxuXHJcbiAgICAgIC8vID09PSBTYWxlcyBNZXRyaWNzID09PVxyXG4gICAgICBjb25zdCBzbSA9IGRhaWx5UmVwb3J0LnNhbGVzTWV0cmljcztcclxuICAgICAgc20udG90YWxPcmRlcnMgPSBvcmRlcnMubGVuZ3RoO1xyXG4gICAgICBzbS5jb21wbGV0ZWRPcmRlcnMgPSBjb21wbGV0ZWRPcmRlcnMubGVuZ3RoO1xyXG4gICAgICBzbS5jYW5jZWxsZWRPcmRlcnMgPSBvcmRlcnMuZmlsdGVyKFxyXG4gICAgICAgIChvKSA9PiBvLnN0YXR1cyA9PT0gXCJjYW5jZWxsZWRcIlxyXG4gICAgICApLmxlbmd0aDtcclxuICAgICAgc20ucGVuZGluZ09yZGVycyA9IG9yZGVycy5maWx0ZXIoKG8pID0+XHJcbiAgICAgICAgby5zdGF0dXMuc3RhcnRzV2l0aChcInBlbmRpbmdcIilcclxuICAgICAgKS5sZW5ndGg7XHJcbiAgICAgIHNtLnRvdGFsUmV2ZW51ZSA9IGNvbXBsZXRlZE9yZGVycy5yZWR1Y2UoXHJcbiAgICAgICAgKHN1bSwgbykgPT4gc3VtICsgby50b3RhbEFtb3VudCxcclxuICAgICAgICAwXHJcbiAgICAgICk7XHJcbiAgICAgIHNtLnRvdGFsUXVhbnRpdHlTb2xkID0gY29tcGxldGVkT3JkZXJzLnJlZHVjZShcclxuICAgICAgICAoc3VtLCBvKSA9PiBzdW0gKyBvLnRvdGFsUXVhbnRpdHksXHJcbiAgICAgICAgMFxyXG4gICAgICApO1xyXG4gICAgICBzbS5hdmVyYWdlT3JkZXJWYWx1ZSA9XHJcbiAgICAgICAgc20uY29tcGxldGVkT3JkZXJzID4gMCA/IHNtLnRvdGFsUmV2ZW51ZSAvIHNtLmNvbXBsZXRlZE9yZGVycyA6IDA7XHJcblxyXG4gICAgICBvcmRlcnMuZm9yRWFjaCgob3JkZXIpID0+IHtcclxuICAgICAgICAvLyBQYXltZW50IG1ldGhvZHNcclxuICAgICAgICBjb25zdCBwbSA9IG9yZGVyLnBheW1lbnRNZXRob2Q7XHJcbiAgICAgICAgaWYgKCFzbS5wYXltZW50TWV0aG9kc1twbV0pIHtcclxuICAgICAgICAgIHNtLnBheW1lbnRNZXRob2RzW3BtXSA9IHtcclxuICAgICAgICAgICAgb3JkZXJDb3VudDogMCxcclxuICAgICAgICAgICAgdG90YWxBbW91bnQ6IDAsXHJcbiAgICAgICAgICAgIHBlcmNlbnRhZ2U6IDAsXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBzbS5wYXltZW50TWV0aG9kc1twbV0ub3JkZXJDb3VudCsrO1xyXG4gICAgICAgIGlmIChvcmRlci5zdGF0dXMgPT09IFwiY29tcGxldGVkXCIpIHtcclxuICAgICAgICAgIHNtLnBheW1lbnRNZXRob2RzW3BtXS50b3RhbEFtb3VudCArPSBvcmRlci50b3RhbEFtb3VudDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIC8vIEhvdXJseSBicmVha2Rvd25cclxuICAgICAgICBjb25zdCBob3VyID0gZ2V0SG91cnMob3JkZXIub3JkZXJEYXRlLnRvRGF0ZSgpKTtcclxuICAgICAgICBzbS5ob3VybHlCcmVha2Rvd25baG91cl0ub3JkZXJzKys7XHJcbiAgICAgICAgaWYgKG9yZGVyLnN0YXR1cyA9PT0gXCJjb21wbGV0ZWRcIikge1xyXG4gICAgICAgICAgc20uaG91cmx5QnJlYWtkb3duW2hvdXJdLnJldmVudWUgKz0gb3JkZXIudG90YWxBbW91bnQ7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuICAgICAgLy8gQ2FsY3VsYXRlIHBheW1lbnQgbWV0aG9kIHBlcmNlbnRhZ2VzXHJcbiAgICAgIGlmIChzbS50b3RhbFJldmVudWUgPiAwKSB7XHJcbiAgICAgICAgT2JqZWN0LmtleXMoc20ucGF5bWVudE1ldGhvZHMpLmZvckVhY2goKGtleSkgPT4ge1xyXG4gICAgICAgICAgc20ucGF5bWVudE1ldGhvZHNba2V5XS5wZXJjZW50YWdlID1cclxuICAgICAgICAgICAgKHNtLnBheW1lbnRNZXRob2RzW2tleV0udG90YWxBbW91bnQgLyBzbS50b3RhbFJldmVudWUpICogMTAwO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyA9PT0gRmluYW5jaWFsIFN1bW1hcnkgPT09XHJcbiAgICAgIGNvbnN0IGZzID0gZGFpbHlSZXBvcnQuZmluYW5jaWFsU3VtbWFyeTtcclxuICAgICAgZnMuZ3Jvc3NSZXZlbnVlID0gY29tcGxldGVkT3JkZXJzLnJlZHVjZShcclxuICAgICAgICAoc3VtLCBvKSA9PiBzdW0gKyBvLnN1YnRvdGFsQW1vdW50LFxyXG4gICAgICAgIDBcclxuICAgICAgKTtcclxuICAgICAgZnMuZGlzY291bnRBbW91bnQgPSBjb21wbGV0ZWRPcmRlcnMucmVkdWNlKFxyXG4gICAgICAgIChzdW0sIG8pID0+IHN1bSArIG8uZGlzY291bnRBbW91bnQsXHJcbiAgICAgICAgMFxyXG4gICAgICApO1xyXG4gICAgICBmcy50YXhBbW91bnQgPSBjb21wbGV0ZWRPcmRlcnMucmVkdWNlKChzdW0sIG8pID0+IHN1bSArIG8udGF4QW1vdW50LCAwKTtcclxuICAgICAgZnMubmV0UmV2ZW51ZSA9IGNvbXBsZXRlZE9yZGVycy5yZWR1Y2UoXHJcbiAgICAgICAgKHN1bSwgbykgPT4gc3VtICsgby50b3RhbEFtb3VudCxcclxuICAgICAgICAwXHJcbiAgICAgICk7XHJcbiAgICAgIGZzLnRvdGFsQ29zdCA9IGFsbEl0ZW1zXHJcbiAgICAgICAgLmZpbHRlcigoaXRlbSkgPT5cclxuICAgICAgICAgIGNvbXBsZXRlZE9yZGVycy5zb21lKChvKSA9PiBvLmlkID09PSBpdGVtLnNhbGVzT3JkZXJJZClcclxuICAgICAgICApXHJcbiAgICAgICAgLnJlZHVjZSgoc3VtLCBpdGVtKSA9PiBzdW0gKyBpdGVtLnVuaXRDb3N0LCAwKTtcclxuICAgICAgZnMuZ3Jvc3NQcm9maXQgPSBmcy5ncm9zc1JldmVudWUgLSBmcy50b3RhbENvc3Q7XHJcbiAgICAgIGZzLmdyb3NzUHJvZml0TWFyZ2luID1cclxuICAgICAgICBmcy5ncm9zc1JldmVudWUgPiAwID8gKGZzLmdyb3NzUHJvZml0IC8gZnMuZ3Jvc3NSZXZlbnVlKSAqIDEwMCA6IDA7XHJcblxyXG4gICAgICAvLyA9PT0gUHJvZHVjdCBQZXJmb3JtYW5jZSA9PT1cclxuICAgICAgY29uc3QgcHAgPSBkYWlseVJlcG9ydC5wcm9kdWN0UGVyZm9ybWFuY2U7XHJcbiAgICAgIGNvbnN0IHNvbGRJdGVtcyA9IGFsbEl0ZW1zLmZpbHRlcigoaXRlbSkgPT5cclxuICAgICAgICBjb21wbGV0ZWRPcmRlcnMuc29tZSgobykgPT4gby5pZCA9PT0gaXRlbS5zYWxlc09yZGVySWQpXHJcbiAgICAgICk7XHJcbiAgICAgIHBwLnRvdGFsUHJvZHVjdHNTb2xkID0gc29sZEl0ZW1zLmxlbmd0aDtcclxuXHJcbiAgICAgIGNvbnN0IHByb2R1Y3RTYWxlczoge1xyXG4gICAgICAgIFtwcm9kdWN0SWQ6IHN0cmluZ106IHtcclxuICAgICAgICAgIHByb2R1Y3RJZDogc3RyaW5nO1xyXG4gICAgICAgICAgcHJvZHVjdE5hbWU6IHN0cmluZztcclxuICAgICAgICAgIHF1YW50aXR5U29sZDogbnVtYmVyO1xyXG4gICAgICAgICAgcmV2ZW51ZTogbnVtYmVyO1xyXG4gICAgICAgICAgcHJvZml0OiBudW1iZXI7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSA9IHt9O1xyXG4gICAgICBjb25zdCB2YXJpYW50U2FsZXM6IHtcclxuICAgICAgICBbdmFyaWFudElkOiBzdHJpbmddOiB7XHJcbiAgICAgICAgICB2YXJpYW50SWQ6IHN0cmluZztcclxuICAgICAgICAgIHByb2R1Y3ROYW1lOiBzdHJpbmc7XHJcbiAgICAgICAgICBjb2xvck5hbWU6IHN0cmluZztcclxuICAgICAgICAgIHN0b3JhZ2VDYXBhY2l0eTogc3RyaW5nO1xyXG4gICAgICAgICAgcXVhbnRpdHlTb2xkOiBudW1iZXI7XHJcbiAgICAgICAgICByZXZlbnVlOiBudW1iZXI7XHJcbiAgICAgICAgfTtcclxuICAgICAgfSA9IHt9O1xyXG5cclxuICAgICAgc29sZEl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcclxuICAgICAgICAvLyBQcm9kdWN0IGFnZ3JlZ2F0aW9uXHJcbiAgICAgICAgaWYgKCFwcm9kdWN0U2FsZXNbaXRlbS5wcm9kdWN0SWRdKSB7XHJcbiAgICAgICAgICBwcm9kdWN0U2FsZXNbaXRlbS5wcm9kdWN0SWRdID0ge1xyXG4gICAgICAgICAgICBwcm9kdWN0SWQ6IGl0ZW0ucHJvZHVjdElkLFxyXG4gICAgICAgICAgICBwcm9kdWN0TmFtZTogaXRlbS5wcm9kdWN0TmFtZSxcclxuICAgICAgICAgICAgcXVhbnRpdHlTb2xkOiAwLFxyXG4gICAgICAgICAgICByZXZlbnVlOiAwLFxyXG4gICAgICAgICAgICBwcm9maXQ6IDAsXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBwcm9kdWN0U2FsZXNbaXRlbS5wcm9kdWN0SWRdLnF1YW50aXR5U29sZCArPSBpdGVtLnF1YW50aXR5O1xyXG4gICAgICAgIHByb2R1Y3RTYWxlc1tpdGVtLnByb2R1Y3RJZF0ucmV2ZW51ZSArPSBpdGVtLmZpbmFsUHJpY2U7XHJcbiAgICAgICAgcHJvZHVjdFNhbGVzW2l0ZW0ucHJvZHVjdElkXS5wcm9maXQgKz0gaXRlbS5maW5hbFByaWNlIC0gaXRlbS51bml0Q29zdDtcclxuXHJcbiAgICAgICAgLy8gVmFyaWFudCBhZ2dyZWdhdGlvblxyXG4gICAgICAgIGlmICghdmFyaWFudFNhbGVzW2l0ZW0udmFyaWFudElkXSkge1xyXG4gICAgICAgICAgdmFyaWFudFNhbGVzW2l0ZW0udmFyaWFudElkXSA9IHtcclxuICAgICAgICAgICAgdmFyaWFudElkOiBpdGVtLnZhcmlhbnRJZCxcclxuICAgICAgICAgICAgcHJvZHVjdE5hbWU6IGl0ZW0ucHJvZHVjdE5hbWUsXHJcbiAgICAgICAgICAgIGNvbG9yTmFtZTogaXRlbS5jb2xvck5hbWUsXHJcbiAgICAgICAgICAgIHN0b3JhZ2VDYXBhY2l0eTogaXRlbS5zdG9yYWdlQ2FwYWNpdHksXHJcbiAgICAgICAgICAgIHF1YW50aXR5U29sZDogMCxcclxuICAgICAgICAgICAgcmV2ZW51ZTogMCxcclxuICAgICAgICAgIH07XHJcbiAgICAgICAgfVxyXG4gICAgICAgIHZhcmlhbnRTYWxlc1tpdGVtLnZhcmlhbnRJZF0ucXVhbnRpdHlTb2xkICs9IGl0ZW0ucXVhbnRpdHk7XHJcbiAgICAgICAgdmFyaWFudFNhbGVzW2l0ZW0udmFyaWFudElkXS5yZXZlbnVlICs9IGl0ZW0uZmluYWxQcmljZTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBwcC51bmlxdWVQcm9kdWN0c1NvbGQgPSBPYmplY3Qua2V5cyhwcm9kdWN0U2FsZXMpLmxlbmd0aDtcclxuICAgICAgcHAudG9wUHJvZHVjdHMgPSBPYmplY3QudmFsdWVzKHByb2R1Y3RTYWxlcylcclxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5yZXZlbnVlIC0gYS5yZXZlbnVlKVxyXG4gICAgICAgIC5zbGljZSgwLCAxMCkgLy8gVG9wIDEwXHJcbiAgICAgICAgLm1hcCgocCkgPT4gKHtcclxuICAgICAgICAgIC4uLnAsXHJcbiAgICAgICAgICBwcm9maXRNYXJnaW46IHAucmV2ZW51ZSA+IDAgPyAocC5wcm9maXQgLyBwLnJldmVudWUpICogMTAwIDogMCxcclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICBwcC50b3BWYXJpYW50cyA9IE9iamVjdC52YWx1ZXModmFyaWFudFNhbGVzKVxyXG4gICAgICAgIC5zb3J0KChhLCBiKSA9PiBiLnJldmVudWUgLSBhLnJldmVudWUpXHJcbiAgICAgICAgLnNsaWNlKDAsIDEwKTtcclxuXHJcbiAgICAgIC8vID09PSBTdGFmZiBQZXJmb3JtYW5jZSA9PT1cclxuICAgICAgY29uc3Qgc3AgPSBkYWlseVJlcG9ydC5zdGFmZlBlcmZvcm1hbmNlO1xyXG4gICAgICBjb25zdCBzdGFmZk1ldHJpY3M6IHtcclxuICAgICAgICBbc3RhZmZJZDogc3RyaW5nXToge1xyXG4gICAgICAgICAgc3RhZmZJZDogc3RyaW5nO1xyXG4gICAgICAgICAgc3RhZmZOYW1lOiBzdHJpbmc7XHJcbiAgICAgICAgICBvcmRlcnNQcm9jZXNzZWQ6IG51bWJlcjtcclxuICAgICAgICAgIHJldmVudWU6IG51bWJlcjtcclxuICAgICAgICAgIGN1c3RvbWVyczogU2V0PHN0cmluZz47XHJcbiAgICAgICAgfTtcclxuICAgICAgfSA9IHt9O1xyXG5cclxuICAgICAgY29tcGxldGVkT3JkZXJzLmZvckVhY2goKG9yZGVyKSA9PiB7XHJcbiAgICAgICAgaWYgKCFzdGFmZk1ldHJpY3Nbb3JkZXIuc3RhZmZJZF0pIHtcclxuICAgICAgICAgIHN0YWZmTWV0cmljc1tvcmRlci5zdGFmZklkXSA9IHtcclxuICAgICAgICAgICAgc3RhZmZJZDogb3JkZXIuc3RhZmZJZCxcclxuICAgICAgICAgICAgc3RhZmZOYW1lOiBvcmRlci5zdGFmZk5hbWUgfHwgXCJVbmtub3duXCIsXHJcbiAgICAgICAgICAgIG9yZGVyc1Byb2Nlc3NlZDogMCxcclxuICAgICAgICAgICAgcmV2ZW51ZTogMCxcclxuICAgICAgICAgICAgY3VzdG9tZXJzOiBuZXcgU2V0KCksXHJcbiAgICAgICAgICB9O1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBtZXRyaWMgPSBzdGFmZk1ldHJpY3Nbb3JkZXIuc3RhZmZJZF07XHJcbiAgICAgICAgbWV0cmljLm9yZGVyc1Byb2Nlc3NlZCsrO1xyXG4gICAgICAgIG1ldHJpYy5yZXZlbnVlICs9IG9yZGVyLnRvdGFsQW1vdW50O1xyXG4gICAgICAgIGlmIChvcmRlci5jdXN0b21lcklkKSB7XHJcbiAgICAgICAgICBtZXRyaWMuY3VzdG9tZXJzLmFkZChvcmRlci5jdXN0b21lcklkKTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgc3AuYWN0aXZlU3RhZmYgPSBPYmplY3Qua2V5cyhzdGFmZk1ldHJpY3MpLmxlbmd0aDtcclxuICAgICAgc3Auc3RhZmZNZXRyaWNzID0gT2JqZWN0LnZhbHVlcyhzdGFmZk1ldHJpY3MpLm1hcCgobSkgPT4gKHtcclxuICAgICAgICBzdGFmZklkOiBtLnN0YWZmSWQsXHJcbiAgICAgICAgc3RhZmZOYW1lOiBtLnN0YWZmTmFtZSxcclxuICAgICAgICBvcmRlcnNQcm9jZXNzZWQ6IG0ub3JkZXJzUHJvY2Vzc2VkLFxyXG4gICAgICAgIHJldmVudWU6IG0ucmV2ZW51ZSxcclxuICAgICAgICBjdXN0b21lckNvdW50OiBtLmN1c3RvbWVycy5zaXplLFxyXG4gICAgICAgIGF2ZXJhZ2VPcmRlclZhbHVlOlxyXG4gICAgICAgICAgbS5vcmRlcnNQcm9jZXNzZWQgPiAwID8gbS5yZXZlbnVlIC8gbS5vcmRlcnNQcm9jZXNzZWQgOiAwLFxyXG4gICAgICB9KSk7XHJcblxyXG4gICAgICBpZiAoc3Auc3RhZmZNZXRyaWNzLmxlbmd0aCA+IDApIHtcclxuICAgICAgICBjb25zdCB0b3BTZWxsZXIgPSBPYmplY3QudmFsdWVzKHN0YWZmTWV0cmljcykuc29ydChcclxuICAgICAgICAgIChhLCBiKSA9PiBiLnJldmVudWUgLSBhLnJldmVudWVcclxuICAgICAgICApWzBdO1xyXG4gICAgICAgIHNwLnRvcFNhbGVzUGVyc29uID0ge1xyXG4gICAgICAgICAgc3RhZmZJZDogdG9wU2VsbGVyLnN0YWZmSWQsXHJcbiAgICAgICAgICBzdGFmZk5hbWU6IHRvcFNlbGxlci5zdGFmZk5hbWUsXHJcbiAgICAgICAgICByZXZlbnVlOiB0b3BTZWxsZXIucmV2ZW51ZSxcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyA9PT0gQ3VzdG9tZXIgTWV0cmljcyA9PT1cclxuICAgICAgY29uc3QgY20gPSBkYWlseVJlcG9ydC5jdXN0b21lck1ldHJpY3M7XHJcbiAgICAgIGNvbnN0IGN1c3RvbWVySWRzID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcbiAgICAgIGNvbXBsZXRlZE9yZGVycy5mb3JFYWNoKChvKSA9PiB7XHJcbiAgICAgICAgaWYgKG8uY3VzdG9tZXJJZCkgY3VzdG9tZXJJZHMuYWRkKG8uY3VzdG9tZXJJZCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBjbS50b3RhbEN1c3RvbWVycyA9IGN1c3RvbWVySWRzLnNpemU7XHJcbiAgICAgIFxyXG4gICAgICAvLyA9PT0gU2F2ZSBSZXBvcnQgPT09XHJcbiAgICAgIGF3YWl0IHNldERvYyhyZXBvcnRSZWYsIGRhaWx5UmVwb3J0LCB7IG1lcmdlOiB0cnVlIH0pO1xyXG5cclxuICAgICAgcmV0dXJuIHsgc3VjY2VzczogdHJ1ZSwgZGF0YTogZGFpbHlSZXBvcnQgfTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgICBjb25zb2xlLmVycm9yKGBFcnJvciBnZXR0aW5nIG9yIGdlbmVyYXRpbmcgZGFpbHkgcmVwb3J0IGZvciAke3JlcG9ydERhdGVTdHJ9OmAsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGVzIGFuZCBzYXZlcyBhIGRhaWx5IHNhbGVzIHJlcG9ydCBmb3IgYSBnaXZlbiBkYXRlLlxyXG4gICAqIFRoaXMgb3BlcmF0aW9uIGNhbiBiZSByZXNvdXJjZS1pbnRlbnNpdmUgYW5kIHNob3VsZCBiZSBydW4gaW4gYSB0cnVzdGVkIGVudmlyb25tZW50IChlLmcuLCBiYWNrZW5kLCBjbG91ZCBmdW5jdGlvbikuXHJcbiAgICogQHBhcmFtIHJlcG9ydERhdGUgVGhlIGRhdGUgZm9yIHdoaWNoIHRvIGdlbmVyYXRlIHRoZSByZXBvcnQuXHJcbiAgICogQHBhcmFtIHVzZXJJZCBUaGUgSUQgb2YgdGhlIHVzZXIgdHJpZ2dlcmluZyB0aGUgZ2VuZXJhdGlvbi5cclxuICAgKi9cclxuICBhc3luYyBnZW5lcmF0ZURhaWx5UmVwb3J0KFxyXG4gICAgcmVwb3J0RGF0ZTogRGF0ZSxcclxuICAgIHVzZXJJZDogc3RyaW5nID0gXCJzeXN0ZW1cIlxyXG4gICk6IFByb21pc2U8U2VydmljZVJlc3BvbnNlPEZpcmViYXNlRGFpbHlSZXBvcnQ+PiB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCByZXBvcnREYXRlU3RyID0gZm9ybWF0KHJlcG9ydERhdGUsIFwieXl5eS1NTS1kZFwiKTtcclxuICAgICAgY29uc3QgcmVwb3J0VGltZXN0YW1wID0gVGltZXN0YW1wLmZyb21EYXRlKHJlcG9ydERhdGUpO1xyXG4gICAgICBjb25zdCBkYWlseVJlcG9ydCA9IGNyZWF0ZUVtcHR5RGFpbHlSZXBvcnQocmVwb3J0RGF0ZVN0ciwgcmVwb3J0VGltZXN0YW1wKTtcclxuICAgICAgZGFpbHlSZXBvcnQuZ2VuZXJhdGVkQnkgPSB1c2VySWQ7XHJcbiAgICAgIGRhaWx5UmVwb3J0LmNyZWF0ZWRCeSA9IHVzZXJJZDtcclxuICAgICAgZGFpbHlSZXBvcnQudXBkYXRlZEJ5ID0gdXNlcklkO1xyXG5cclxuICAgICAgY29uc3Qgc3RhcnQgPSBzdGFydE9mRGF5KHJlcG9ydERhdGUpO1xyXG4gICAgICBjb25zdCBlbmQgPSBlbmRPZkRheShyZXBvcnREYXRlKTtcclxuXHJcbiAgICAgIC8vIDEuIEZldGNoIGFsbCBzYWxlcyBvcmRlcnMgZm9yIHRoZSBnaXZlbiBkYXlcclxuICAgICAgY29uc3Qgb3JkZXJzUmVmID0gY29sbGVjdGlvbihkYiwgQ09MTEVDVElPTlMuU0FMRVNfT1JERVJTKTtcclxuICAgICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICAgIG9yZGVyc1JlZixcclxuICAgICAgICB3aGVyZShcIm9yZGVyRGF0ZVwiLCBcIj49XCIsIFRpbWVzdGFtcC5mcm9tRGF0ZShzdGFydCkpLFxyXG4gICAgICAgIHdoZXJlKFwib3JkZXJEYXRlXCIsIFwiPD1cIiwgVGltZXN0YW1wLmZyb21EYXRlKGVuZCkpXHJcbiAgICAgICk7XHJcbiAgICAgIGNvbnN0IG9yZGVyU25hcHNob3RzID0gYXdhaXQgZ2V0RG9jcyhxKTtcclxuICAgICAgY29uc3Qgb3JkZXJzID0gb3JkZXJTbmFwc2hvdHMuZG9jcy5tYXAoXHJcbiAgICAgICAgKGRvYykgPT4gKHsgaWQ6IGRvYy5pZCwgLi4uZG9jLmRhdGEoKSB9IGFzIEZpcmViYXNlU2FsZXNPcmRlcilcclxuICAgICAgKTtcclxuXHJcbiAgICAgIGlmIChvcmRlcnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgLy8gTm8gc2FsZXMsIHNhdmUgYW4gZW1wdHkgcmVwb3J0XHJcbiAgICAgICAgY29uc3QgZW1wdHlSZXBvcnRSZWYgPSBkb2MoZGIsIHRoaXMuY29sbGVjdGlvbk5hbWUsIHJlcG9ydERhdGVTdHIpO1xyXG4gICAgICAgIGF3YWl0IHNldERvYyhlbXB0eVJlcG9ydFJlZiwgZGFpbHlSZXBvcnQpO1xyXG4gICAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGRhaWx5UmVwb3J0IH07XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIDIuIEZldGNoIGFsbCBvcmRlciBpdGVtcyBmb3IgdGhlc2Ugb3JkZXJzXHJcbiAgICAgIGxldCBhbGxJdGVtczogRmlyZWJhc2VTYWxlc09yZGVySXRlbVtdID0gW107XHJcbiAgICAgIGZvciAoY29uc3Qgb3JkZXIgb2Ygb3JkZXJzKSB7XHJcbiAgICAgICAgY29uc3QgaXRlbXNSZWYgPSBjb2xsZWN0aW9uKFxyXG4gICAgICAgICAgZGIsXHJcbiAgICAgICAgICBDT0xMRUNUSU9OUy5TQUxFU19PUkRFUlMsXHJcbiAgICAgICAgICBvcmRlci5pZCxcclxuICAgICAgICAgIFNVQkNPTExFQ1RJT05TLk9SREVSX0lURU1TXHJcbiAgICAgICAgKTtcclxuICAgICAgICBjb25zdCBpdGVtc1NuYXBzaG90ID0gYXdhaXQgZ2V0RG9jcyhpdGVtc1JlZik7XHJcbiAgICAgICAgaXRlbXNTbmFwc2hvdC5mb3JFYWNoKChkb2MpID0+IHtcclxuICAgICAgICAgIGFsbEl0ZW1zLnB1c2goeyBpZDogZG9jLmlkLCAuLi5kb2MuZGF0YSgpIH0gYXMgRmlyZWJhc2VTYWxlc09yZGVySXRlbSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vIDMuIFByb2Nlc3MgZGF0YSBhbmQgcG9wdWxhdGUgdGhlIHJlcG9ydCBvYmplY3RcclxuICAgICAgY29uc3QgY29tcGxldGVkT3JkZXJzID0gb3JkZXJzLmZpbHRlcigobykgPT4gby5zdGF0dXMgPT09IFwiY29tcGxldGVkXCIpO1xyXG5cclxuICAgICAgLy8gPT09IFNhbGVzIE1ldHJpY3MgPT09XHJcbiAgICAgIGNvbnN0IHNtID0gZGFpbHlSZXBvcnQuc2FsZXNNZXRyaWNzO1xyXG4gICAgICBzbS50b3RhbE9yZGVycyA9IG9yZGVycy5sZW5ndGg7XHJcbiAgICAgIHNtLmNvbXBsZXRlZE9yZGVycyA9IGNvbXBsZXRlZE9yZGVycy5sZW5ndGg7XHJcbiAgICAgIHNtLmNhbmNlbGxlZE9yZGVycyA9IG9yZGVycy5maWx0ZXIoKG8pID0+IG8uc3RhdHVzID09PSBcImNhbmNlbGxlZFwiKS5sZW5ndGg7XHJcbiAgICAgIHNtLnBlbmRpbmdPcmRlcnMgPSBvcmRlcnMuZmlsdGVyKChvKSA9PiBvLnN0YXR1cy5zdGFydHNXaXRoKFwicGVuZGluZ1wiKSkubGVuZ3RoO1xyXG4gICAgICBzbS50b3RhbFJldmVudWUgPSBjb21wbGV0ZWRPcmRlcnMucmVkdWNlKChzdW0sIG8pID0+IHN1bSArIG8udG90YWxBbW91bnQsIDApO1xyXG4gICAgICBzbS50b3RhbFF1YW50aXR5U29sZCA9IGNvbXBsZXRlZE9yZGVycy5yZWR1Y2UoKHN1bSwgbykgPT4gc3VtICsgby50b3RhbFF1YW50aXR5LCAwKTtcclxuICAgICAgc20uYXZlcmFnZU9yZGVyVmFsdWUgPSBzbS5jb21wbGV0ZWRPcmRlcnMgPiAwID8gc20udG90YWxSZXZlbnVlIC8gc20uY29tcGxldGVkT3JkZXJzIDogMDtcclxuICAgICAgXHJcbiAgICAgIG9yZGVycy5mb3JFYWNoKG9yZGVyID0+IHtcclxuICAgICAgICAgIC8vIFBheW1lbnQgbWV0aG9kc1xyXG4gICAgICAgICAgY29uc3QgcG0gPSBvcmRlci5wYXltZW50TWV0aG9kO1xyXG4gICAgICAgICAgaWYgKCFzbS5wYXltZW50TWV0aG9kc1twbV0pIHtcclxuICAgICAgICAgICAgICBzbS5wYXltZW50TWV0aG9kc1twbV0gPSB7IG9yZGVyQ291bnQ6IDAsIHRvdGFsQW1vdW50OiAwLCBwZXJjZW50YWdlOiAwIH07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICBzbS5wYXltZW50TWV0aG9kc1twbV0ub3JkZXJDb3VudCsrO1xyXG4gICAgICAgICAgaWYgKG9yZGVyLnN0YXR1cyA9PT0gJ2NvbXBsZXRlZCcpIHtcclxuICAgICAgICAgICAgICBzbS5wYXltZW50TWV0aG9kc1twbV0udG90YWxBbW91bnQgKz0gb3JkZXIudG90YWxBbW91bnQ7XHJcbiAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgLy8gSG91cmx5IGJyZWFrZG93blxyXG4gICAgICAgICAgY29uc3QgaG91ciA9IGdldEhvdXJzKG9yZGVyLm9yZGVyRGF0ZS50b0RhdGUoKSk7XHJcbiAgICAgICAgICBzbS5ob3VybHlCcmVha2Rvd25baG91cl0ub3JkZXJzKys7XHJcbiAgICAgICAgICBpZihvcmRlci5zdGF0dXMgPT09ICdjb21wbGV0ZWQnKSB7XHJcbiAgICAgICAgICAgICAgc20uaG91cmx5QnJlYWtkb3duW2hvdXJdLnJldmVudWUgKz0gb3JkZXIudG90YWxBbW91bnQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG4gICAgICAvLyBDYWxjdWxhdGUgcGF5bWVudCBtZXRob2QgcGVyY2VudGFnZXNcclxuICAgICAgaWYgKHNtLnRvdGFsUmV2ZW51ZSA+IDApIHtcclxuICAgICAgICBPYmplY3Qua2V5cyhzbS5wYXltZW50TWV0aG9kcykuZm9yRWFjaChrZXkgPT4ge1xyXG4gICAgICAgICAgICBzbS5wYXltZW50TWV0aG9kc1trZXldLnBlcmNlbnRhZ2UgPSAoc20ucGF5bWVudE1ldGhvZHNba2V5XS50b3RhbEFtb3VudCAvIHNtLnRvdGFsUmV2ZW51ZSkgKiAxMDA7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIC8vID09PSBGaW5hbmNpYWwgU3VtbWFyeSA9PT1cclxuICAgICAgY29uc3QgZnMgPSBkYWlseVJlcG9ydC5maW5hbmNpYWxTdW1tYXJ5O1xyXG4gICAgICBmcy5ncm9zc1JldmVudWUgPSBjb21wbGV0ZWRPcmRlcnMucmVkdWNlKChzdW0sIG8pID0+IHN1bSArIG8uc3VidG90YWxBbW91bnQsIDApO1xyXG4gICAgICBmcy5kaXNjb3VudEFtb3VudCA9IGNvbXBsZXRlZE9yZGVycy5yZWR1Y2UoKHN1bSwgbykgPT4gc3VtICsgby5kaXNjb3VudEFtb3VudCwgMCk7XHJcbiAgICAgIGZzLnRheEFtb3VudCA9IGNvbXBsZXRlZE9yZGVycy5yZWR1Y2UoKHN1bSwgbykgPT4gc3VtICsgby50YXhBbW91bnQsIDApO1xyXG4gICAgICBmcy5uZXRSZXZlbnVlID0gY29tcGxldGVkT3JkZXJzLnJlZHVjZSgoc3VtLCBvKSA9PiBzdW0gKyBvLnRvdGFsQW1vdW50LCAwKTtcclxuICAgICAgZnMudG90YWxDb3N0ID0gYWxsSXRlbXNcclxuICAgICAgICAuZmlsdGVyKGl0ZW0gPT4gY29tcGxldGVkT3JkZXJzLnNvbWUobyA9PiBvLmlkID09PSBpdGVtLnNhbGVzT3JkZXJJZCkpXHJcbiAgICAgICAgLnJlZHVjZSgoc3VtLCBpdGVtKSA9PiBzdW0gKyBpdGVtLnVuaXRDb3N0LCAwKTtcclxuICAgICAgZnMuZ3Jvc3NQcm9maXQgPSBmcy5ncm9zc1JldmVudWUgLSBmcy50b3RhbENvc3Q7XHJcbiAgICAgIGZzLmdyb3NzUHJvZml0TWFyZ2luID0gZnMuZ3Jvc3NSZXZlbnVlID4gMCA/IChmcy5ncm9zc1Byb2ZpdCAvIGZzLmdyb3NzUmV2ZW51ZSkgKiAxMDAgOiAwO1xyXG5cclxuICAgICAgLy8gPT09IFByb2R1Y3QgUGVyZm9ybWFuY2UgPT09XHJcbiAgICAgIGNvbnN0IHBwID0gZGFpbHlSZXBvcnQucHJvZHVjdFBlcmZvcm1hbmNlO1xyXG4gICAgICBjb25zdCBzb2xkSXRlbXMgPSBhbGxJdGVtcy5maWx0ZXIoaXRlbSA9PiBjb21wbGV0ZWRPcmRlcnMuc29tZShvID0+IG8uaWQgPT09IGl0ZW0uc2FsZXNPcmRlcklkKSk7XHJcbiAgICAgIHBwLnRvdGFsUHJvZHVjdHNTb2xkID0gc29sZEl0ZW1zLmxlbmd0aDtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHByb2R1Y3RTYWxlczogeyBbcHJvZHVjdElkOiBzdHJpbmddOiB7IHByb2R1Y3RJZDogc3RyaW5nOyBwcm9kdWN0TmFtZTogc3RyaW5nOyBxdWFudGl0eVNvbGQ6IG51bWJlcjsgcmV2ZW51ZTogbnVtYmVyOyBwcm9maXQ6IG51bWJlcjsgfSB9ID0ge307XHJcbiAgICAgIGNvbnN0IHZhcmlhbnRTYWxlczogeyBbdmFyaWFudElkOiBzdHJpbmddOiB7IHZhcmlhbnRJZDogc3RyaW5nOyBwcm9kdWN0TmFtZTogc3RyaW5nOyBjb2xvck5hbWU6IHN0cmluZzsgc3RvcmFnZUNhcGFjaXR5OiBzdHJpbmc7IHF1YW50aXR5U29sZDogbnVtYmVyOyByZXZlbnVlOiBudW1iZXI7IH0gfSA9IHt9O1xyXG5cclxuICAgICAgc29sZEl0ZW1zLmZvckVhY2goaXRlbSA9PiB7XHJcbiAgICAgICAgICAvLyBQcm9kdWN0IGFnZ3JlZ2F0aW9uXHJcbiAgICAgICAgICBpZighcHJvZHVjdFNhbGVzW2l0ZW0ucHJvZHVjdElkXSkge1xyXG4gICAgICAgICAgICAgIHByb2R1Y3RTYWxlc1tpdGVtLnByb2R1Y3RJZF0gPSB7IHByb2R1Y3RJZDogaXRlbS5wcm9kdWN0SWQsIHByb2R1Y3ROYW1lOiBpdGVtLnByb2R1Y3ROYW1lLCBxdWFudGl0eVNvbGQ6IDAsIHJldmVudWU6IDAsIHByb2ZpdDogMCB9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgcHJvZHVjdFNhbGVzW2l0ZW0ucHJvZHVjdElkXS5xdWFudGl0eVNvbGQgKz0gaXRlbS5xdWFudGl0eTtcclxuICAgICAgICAgIHByb2R1Y3RTYWxlc1tpdGVtLnByb2R1Y3RJZF0ucmV2ZW51ZSArPSBpdGVtLmZpbmFsUHJpY2U7XHJcbiAgICAgICAgICBwcm9kdWN0U2FsZXNbaXRlbS5wcm9kdWN0SWRdLnByb2ZpdCArPSAoaXRlbS5maW5hbFByaWNlIC0gaXRlbS51bml0Q29zdCk7XHJcblxyXG4gICAgICAgICAgLy8gVmFyaWFudCBhZ2dyZWdhdGlvblxyXG4gICAgICAgICAgaWYoIXZhcmlhbnRTYWxlc1tpdGVtLnZhcmlhbnRJZF0pIHtcclxuICAgICAgICAgICAgICB2YXJpYW50U2FsZXNbaXRlbS52YXJpYW50SWRdID0geyB2YXJpYW50SWQ6IGl0ZW0udmFyaWFudElkLCBwcm9kdWN0TmFtZTogaXRlbS5wcm9kdWN0TmFtZSwgY29sb3JOYW1lOiBpdGVtLmNvbG9yTmFtZSwgc3RvcmFnZUNhcGFjaXR5OiBpdGVtLnN0b3JhZ2VDYXBhY2l0eSwgcXVhbnRpdHlTb2xkOiAwLCByZXZlbnVlOiAwIH07XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgICB2YXJpYW50U2FsZXNbaXRlbS52YXJpYW50SWRdLnF1YW50aXR5U29sZCArPSBpdGVtLnF1YW50aXR5O1xyXG4gICAgICAgICAgdmFyaWFudFNhbGVzW2l0ZW0udmFyaWFudElkXS5yZXZlbnVlICs9IGl0ZW0uZmluYWxQcmljZTtcclxuICAgICAgfSk7XHJcblxyXG4gICAgICBwcC51bmlxdWVQcm9kdWN0c1NvbGQgPSBPYmplY3Qua2V5cyhwcm9kdWN0U2FsZXMpLmxlbmd0aDtcclxuICAgICAgcHAudG9wUHJvZHVjdHMgPSBPYmplY3QudmFsdWVzKHByb2R1Y3RTYWxlcylcclxuICAgICAgICAuc29ydCgoYSwgYikgPT4gYi5yZXZlbnVlIC0gYS5yZXZlbnVlKVxyXG4gICAgICAgIC5zbGljZSgwLCAxMCkgLy8gVG9wIDEwXHJcbiAgICAgICAgLm1hcChwID0+ICh7IC4uLnAsIHByb2ZpdE1hcmdpbjogcC5yZXZlbnVlID4gMCA/IChwLnByb2ZpdCAvIHAucmV2ZW51ZSkgKiAxMDAgOiAwLCBwcm9maXQ6IHAucHJvZml0IH0pKTtcclxuICAgICAgXHJcbiAgICAgIHBwLnRvcFZhcmlhbnRzID0gT2JqZWN0LnZhbHVlcyh2YXJpYW50U2FsZXMpXHJcbiAgICAgICAgLnNvcnQoKGEsYikgPT4gYi5yZXZlbnVlIC0gYS5yZXZlbnVlKVxyXG4gICAgICAgIC5zbGljZSgwLCAxMCk7XHJcblxyXG4gICAgICAvLyA9PT0gU3RhZmYgUGVyZm9ybWFuY2UgPT09XHJcbiAgICAgIGNvbnN0IHNwID0gZGFpbHlSZXBvcnQuc3RhZmZQZXJmb3JtYW5jZTtcclxuICAgICAgY29uc3Qgc3RhZmZNZXRyaWNzOiB7IFtzdGFmZklkOiBzdHJpbmddOiB7IHN0YWZmSWQ6IHN0cmluZzsgc3RhZmZOYW1lOiBzdHJpbmc7IG9yZGVyc1Byb2Nlc3NlZDogbnVtYmVyOyByZXZlbnVlOiBudW1iZXI7IGN1c3RvbWVyczogU2V0PHN0cmluZz47IH0gfSA9IHt9O1xyXG4gICAgICBcclxuICAgICAgY29tcGxldGVkT3JkZXJzLmZvckVhY2gob3JkZXIgPT4ge1xyXG4gICAgICAgICAgaWYgKCFzdGFmZk1ldHJpY3Nbb3JkZXIuc3RhZmZJZF0pIHtcclxuICAgICAgICAgICAgICBzdGFmZk1ldHJpY3Nbb3JkZXIuc3RhZmZJZF0gPSB7IHN0YWZmSWQ6IG9yZGVyLnN0YWZmSWQsIHN0YWZmTmFtZTogb3JkZXIuc3RhZmZOYW1lIHx8ICdVbmtub3duJywgb3JkZXJzUHJvY2Vzc2VkOiAwLCByZXZlbnVlOiAwLCBjdXN0b21lcnM6IG5ldyBTZXQoKSB9O1xyXG4gICAgICAgICAgfVxyXG4gICAgICAgICAgY29uc3QgbWV0cmljID0gc3RhZmZNZXRyaWNzW29yZGVyLnN0YWZmSWRdO1xyXG4gICAgICAgICAgbWV0cmljLm9yZGVyc1Byb2Nlc3NlZCsrO1xyXG4gICAgICAgICAgbWV0cmljLnJldmVudWUgKz0gb3JkZXIudG90YWxBbW91bnQ7XHJcbiAgICAgICAgICBpZiAob3JkZXIuY3VzdG9tZXJJZCkge1xyXG4gICAgICAgICAgICBtZXRyaWMuY3VzdG9tZXJzLmFkZChvcmRlci5jdXN0b21lcklkKTtcclxuICAgICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBzcC5hY3RpdmVTdGFmZiA9IE9iamVjdC5rZXlzKHN0YWZmTWV0cmljcykubGVuZ3RoO1xyXG4gICAgICBzcC5zdGFmZk1ldHJpY3MgPSBPYmplY3QudmFsdWVzKHN0YWZmTWV0cmljcykubWFwKG0gPT4gKHsgXHJcbiAgICAgICAgICBzdGFmZklkOiBtLnN0YWZmSWQsIFxyXG4gICAgICAgICAgc3RhZmZOYW1lOiBtLnN0YWZmTmFtZSwgXHJcbiAgICAgICAgICBvcmRlcnNQcm9jZXNzZWQ6IG0ub3JkZXJzUHJvY2Vzc2VkLCBcclxuICAgICAgICAgIHJldmVudWU6IG0ucmV2ZW51ZSwgXHJcbiAgICAgICAgICBjdXN0b21lckNvdW50OiBtLmN1c3RvbWVycy5zaXplLCBcclxuICAgICAgICAgIGF2ZXJhZ2VPcmRlclZhbHVlOiBtLm9yZGVyc1Byb2Nlc3NlZCA+IDAgPyBtLnJldmVudWUgLyBtLm9yZGVyc1Byb2Nlc3NlZCA6IDBcclxuICAgICAgICB9KSk7XHJcblxyXG4gICAgICBpZihzcC5zdGFmZk1ldHJpY3MubGVuZ3RoID4gMCkge1xyXG4gICAgICAgIGNvbnN0IHRvcFNlbGxlciA9IE9iamVjdC52YWx1ZXMoc3RhZmZNZXRyaWNzKS5zb3J0KChhLGIpID0+IGIucmV2ZW51ZSAtIGEucmV2ZW51ZSlbMF1cclxuICAgICAgICBzcC50b3BTYWxlc1BlcnNvbiA9IHtcclxuICAgICAgICAgIHN0YWZmSWQ6IHRvcFNlbGxlci5zdGFmZklkLFxyXG4gICAgICAgICAgc3RhZmZOYW1lOiB0b3BTZWxsZXIuc3RhZmZOYW1lLFxyXG4gICAgICAgICAgcmV2ZW51ZTogdG9wU2VsbGVyLnJldmVudWUsXHJcbiAgICAgICAgfTtcclxuICAgICAgfVxyXG4gICAgICBcclxuICAgICAgLy8gPT09IEN1c3RvbWVyIE1ldHJpY3MgPT09XHJcbiAgICAgIC8vIFRoaXMgaXMgYSBzaW1wbGlmaWVkIHZlcnNpb24uIEZvciBhY2N1cmF0ZSBuZXcvcmV0dXJuaW5nLCB3ZSBuZWVkIHRvIGNoZWNrIGN1c3RvbWVyJ3MgaGlzdG9yeS5cclxuICAgICAgY29uc3QgY20gPSBkYWlseVJlcG9ydC5jdXN0b21lck1ldHJpY3M7XHJcbiAgICAgIGNvbnN0IGN1c3RvbWVySWRzID0gbmV3IFNldDxzdHJpbmc+KCk7XHJcbiAgICAgIGNvbXBsZXRlZE9yZGVycy5mb3JFYWNoKG8gPT4ge1xyXG4gICAgICAgIGlmKG8uY3VzdG9tZXJJZCkgY3VzdG9tZXJJZHMuYWRkKG8uY3VzdG9tZXJJZCk7XHJcbiAgICAgIH0pO1xyXG4gICAgICBjbS50b3RhbEN1c3RvbWVycyA9IGN1c3RvbWVySWRzLnNpemU7XHJcbiAgICAgIC8vIFRoaXMgcmVxdWlyZXMgZmV0Y2hpbmcgZWFjaCBjdXN0b21lciBkb2MsIGNhbiBiZSBzbG93LiBBIGJldHRlciBhcHByb2FjaCBpcyB0byB1c2UgYSBzdW1tYXJ5IGZpZWxkIG9uIHRoZSBjdXN0b21lciBkb2NcclxuICAgICAgLy8gb3IgdXNlIGEgc2VwYXJhdGUgYW5hbHl0aWNzIHNlcnZpY2UvY2xvdWQgZnVuY3Rpb24uIEZvciBub3csIHRoaXMgaXMgb21pdHRlZCBmb3IgcGVyZm9ybWFuY2UgcmVhc29ucy5cclxuICAgICAgLy8gY20ubmV3Q3VzdG9tZXJzID0gLi4uXHJcbiAgICAgIC8vIGNtLnJldHVybmluZ0N1c3RvbWVycyA9IC4uLlxyXG4gICAgICBcclxuICAgICAgLy8gPT09IFNhdmUgUmVwb3J0ID09PVxyXG4gICAgICBjb25zdCByZXBvcnRSZWYgPSBkb2MoZGIsIHRoaXMuY29sbGVjdGlvbk5hbWUsIHJlcG9ydERhdGVTdHIpO1xyXG4gICAgICBhd2FpdCBzZXREb2MocmVwb3J0UmVmLCBkYWlseVJlcG9ydCwgeyBtZXJnZTogdHJ1ZSB9KTtcclxuXHJcbiAgICAgIHJldHVybiB7IHN1Y2Nlc3M6IHRydWUsIGRhdGE6IGRhaWx5UmVwb3J0IH07XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZ2VuZXJhdGluZyBkYWlseSByZXBvcnQ6XCIsIGVycm9yKTtcclxuICAgICAgcmV0dXJuIHRoaXMuaGFuZGxlRXJyb3IoZXJyb3IpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogR2VuZXJhdGVzIGEgbW9udGhseSByZXBvcnQgYnkgYWdncmVnYXRpbmcgZGFpbHkgcmVwb3J0cyBmb3IgYSBnaXZlbiBtb250aCBhbmQgeWVhci5cclxuICAgKiBAcGFyYW0geWVhciBUaGUgeWVhciBvZiB0aGUgcmVwb3J0LlxyXG4gICAqIEBwYXJhbSBtb250aCBUaGUgbW9udGggb2YgdGhlIHJlcG9ydCAoMS0xMikuXHJcbiAgICogQHBhcmFtIHVzZXJJZCBUaGUgSUQgb2YgdGhlIHVzZXIgdHJpZ2dlcmluZyB0aGUgZ2VuZXJhdGlvbi5cclxuICAgKi9cclxuICBhc3luYyBnZXRNb250aGx5UmVwb3J0KFxyXG4gICAgeWVhcjogbnVtYmVyLFxyXG4gICAgbW9udGg6IG51bWJlciwgLy8gMS0xMlxyXG4gICAgdXNlcklkOiBzdHJpbmcgPSBcInN5c3RlbVwiXHJcbiAgKTogUHJvbWlzZTxTZXJ2aWNlUmVzcG9uc2U8YW55Pj4geyAvLyBSZXBsYWNlICdhbnknIHdpdGggRmlyZWJhc2VNb250aGx5UmVwb3J0IGxhdGVyXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzdGFydERhdGUgPSBuZXcgRGF0ZSh5ZWFyLCBtb250aCAtIDEsIDEpO1xyXG4gICAgICBjb25zdCBlbmREYXRlID0gbmV3IERhdGUoeWVhciwgbW9udGgsIDApO1xyXG5cclxuICAgICAgLy8gMS4gRmV0Y2ggYWxsIGRhaWx5IHJlcG9ydHMgd2l0aGluIHRoZSBtb250aFxyXG4gICAgICBjb25zdCBkYWlseVJlcG9ydHNSZWYgPSBjb2xsZWN0aW9uKGRiLCB0aGlzLmNvbGxlY3Rpb25OYW1lKTtcclxuICAgICAgY29uc3QgcSA9IHF1ZXJ5KFxyXG4gICAgICAgIGRhaWx5UmVwb3J0c1JlZixcclxuICAgICAgICB3aGVyZShcInJlcG9ydFRpbWVzdGFtcFwiLCBcIj49XCIsIFRpbWVzdGFtcC5mcm9tRGF0ZShzdGFydERhdGUpKSxcclxuICAgICAgICB3aGVyZShcInJlcG9ydFRpbWVzdGFtcFwiLCBcIjw9XCIsIFRpbWVzdGFtcC5mcm9tRGF0ZShlbmREYXRlKSlcclxuICAgICAgKTtcclxuICAgICAgXHJcbiAgICAgIGNvbnN0IHNuYXBzaG90cyA9IGF3YWl0IGdldERvY3MocSk7XHJcbiAgICAgIGlmIChzbmFwc2hvdHMuZW1wdHkpIHtcclxuICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgc3VjY2VzczogZmFsc2UsXHJcbiAgICAgICAgICBlcnJvcjogYEtow7RuZyBjw7MgZOG7ryBsaeG7h3UgYsOhbyBjw6FvIGNobyB0aMOhbmcgJHttb250aH0vJHt5ZWFyfS5gLFxyXG4gICAgICAgICAgZXJyb3JDb2RlOiBcIk5PX0RBVEFcIixcclxuICAgICAgICB9O1xyXG4gICAgICB9XHJcblxyXG4gICAgICBjb25zdCBkYWlseVJlcG9ydHMgPSBzbmFwc2hvdHMuZG9jcy5tYXAoZG9jID0+IGRvYy5kYXRhKCkgYXMgRmlyZWJhc2VEYWlseVJlcG9ydCk7XHJcblxyXG4gICAgICAvLyAyLiBBZ2dyZWdhdGUgdGhlIGRhdGFcclxuICAgICAgLy8gTm90ZTogVGhpcyBpcyBhIHNpbXBsaWZpZWQgYWdncmVnYXRpb24uIEEgZnVsbCBpbXBsZW1lbnRhdGlvbiB3b3VsZCBjcmVhdGUgYSBGaXJlYmFzZU1vbnRobHlSZXBvcnQgb2JqZWN0LlxyXG4gICAgICAvLyBGb3Igbm93LCB3ZSdsbCByZXR1cm4gYW4gYWdncmVnYXRlZCBzdW1tYXJ5LlxyXG4gICAgICBjb25zdCBtb250aGx5U3VtbWFyeSA9IHtcclxuICAgICAgICAgIHJlcG9ydE1vbnRoOiBgJHt5ZWFyfS0ke21vbnRoLnRvU3RyaW5nKCkucGFkU3RhcnQoMiwgJzAnKX1gLFxyXG4gICAgICAgICAgdG90YWxEYXlzUmVwb3J0ZWQ6IGRhaWx5UmVwb3J0cy5sZW5ndGgsXHJcbiAgICAgICAgICB0b3RhbFJldmVudWU6IDAsXHJcbiAgICAgICAgICB0b3RhbE9yZGVyczogMCxcclxuICAgICAgICAgIHRvdGFsUXVhbnRpdHlTb2xkOiAwLFxyXG4gICAgICAgICAgZ3Jvc3NQcm9maXQ6IDAsXHJcbiAgICAgICAgICB0b3BQcm9kdWN0czogbmV3IE1hcDxzdHJpbmcsIHtwcm9kdWN0TmFtZTogc3RyaW5nLCBxdWFudGl0eVNvbGQ6IG51bWJlciwgcmV2ZW51ZTogbnVtYmVyfT4oKSxcclxuICAgICAgICAgIHN0YWZmUGVyZm9ybWFuY2U6IG5ldyBNYXA8c3RyaW5nLCB7c3RhZmZOYW1lOiBzdHJpbmcsIHJldmVudWU6IG51bWJlciwgb3JkZXJzUHJvY2Vzc2VkOiBudW1iZXJ9PigpXHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGZvciAoY29uc3QgZGFpbHkgb2YgZGFpbHlSZXBvcnRzKSB7XHJcbiAgICAgICAgICBtb250aGx5U3VtbWFyeS50b3RhbFJldmVudWUgKz0gZGFpbHkuc2FsZXNNZXRyaWNzLnRvdGFsUmV2ZW51ZTtcclxuICAgICAgICAgIG1vbnRobHlTdW1tYXJ5LnRvdGFsT3JkZXJzICs9IGRhaWx5LnNhbGVzTWV0cmljcy5jb21wbGV0ZWRPcmRlcnM7XHJcbiAgICAgICAgICBtb250aGx5U3VtbWFyeS50b3RhbFF1YW50aXR5U29sZCArPSBkYWlseS5zYWxlc01ldHJpY3MudG90YWxRdWFudGl0eVNvbGQ7XHJcbiAgICAgICAgICBtb250aGx5U3VtbWFyeS5ncm9zc1Byb2ZpdCArPSBkYWlseS5maW5hbmNpYWxTdW1tYXJ5Lmdyb3NzUHJvZml0O1xyXG4gICAgICAgICAgXHJcbiAgICAgICAgICAvLyBBZ2dyZWdhdGUgcHJvZHVjdCBwZXJmb3JtYW5jZVxyXG4gICAgICAgICAgZGFpbHkucHJvZHVjdFBlcmZvcm1hbmNlLnRvcFByb2R1Y3RzLmZvckVhY2gocCA9PiB7XHJcbiAgICAgICAgICAgICAgY29uc3QgZXhpc3RpbmcgPSBtb250aGx5U3VtbWFyeS50b3BQcm9kdWN0cy5nZXQocC5wcm9kdWN0SWQpO1xyXG4gICAgICAgICAgICAgIGlmKGV4aXN0aW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgIGV4aXN0aW5nLnF1YW50aXR5U29sZCArPSBwLnF1YW50aXR5U29sZDtcclxuICAgICAgICAgICAgICAgICAgZXhpc3RpbmcucmV2ZW51ZSArPSBwLnJldmVudWU7XHJcbiAgICAgICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgbW9udGhseVN1bW1hcnkudG9wUHJvZHVjdHMuc2V0KHAucHJvZHVjdElkLCB7IHByb2R1Y3ROYW1lOiBwLnByb2R1Y3ROYW1lLCBxdWFudGl0eVNvbGQ6IHAucXVhbnRpdHlTb2xkLCByZXZlbnVlOiBwLnJldmVudWUgfSk7XHJcbiAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgLy8gQWdncmVnYXRlIHN0YWZmIHBlcmZvcm1hbmNlXHJcbiAgICAgICAgICAgZGFpbHkuc3RhZmZQZXJmb3JtYW5jZS5zdGFmZk1ldHJpY3MuZm9yRWFjaChzID0+IHtcclxuICAgICAgICAgICAgICBjb25zdCBleGlzdGluZyA9IG1vbnRobHlTdW1tYXJ5LnN0YWZmUGVyZm9ybWFuY2UuZ2V0KHMuc3RhZmZJZCk7XHJcbiAgICAgICAgICAgICAgaWYoZXhpc3RpbmcpIHtcclxuICAgICAgICAgICAgICAgICAgZXhpc3RpbmcucmV2ZW51ZSArPSBzLnJldmVudWU7XHJcbiAgICAgICAgICAgICAgICAgIGV4aXN0aW5nLm9yZGVyc1Byb2Nlc3NlZCArPSBzLm9yZGVyc1Byb2Nlc3NlZDtcclxuICAgICAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICAgICAgICBtb250aGx5U3VtbWFyeS5zdGFmZlBlcmZvcm1hbmNlLnNldChzLnN0YWZmSWQsIHsgc3RhZmZOYW1lOiBzLnN0YWZmTmFtZSwgcmV2ZW51ZTogcy5yZXZlbnVlLCBvcmRlcnNQcm9jZXNzZWQ6IHMub3JkZXJzUHJvY2Vzc2VkIH0pO1xyXG4gICAgICAgICAgICAgIH1cclxuICAgICAgICAgIH0pO1xyXG4gICAgICB9XHJcblxyXG4gICAgICAvLyBDb252ZXJ0IG1hcHMgdG8gYXJyYXlzIGZvciB0aGUgZmluYWwgb3V0cHV0XHJcbiAgICAgIGNvbnN0IGZpbmFsUmVwb3J0ID0ge1xyXG4gICAgICAgICAgLi4ubW9udGhseVN1bW1hcnksXHJcbiAgICAgICAgICB0b3BQcm9kdWN0czogQXJyYXkuZnJvbShtb250aGx5U3VtbWFyeS50b3BQcm9kdWN0cy52YWx1ZXMoKSkuc29ydCgoYSxiKSA9PiBiLnJldmVudWUgLSBhLnJldmVudWUpLnNsaWNlKDAsIDEwKSxcclxuICAgICAgICAgIHN0YWZmUGVyZm9ybWFuY2U6IEFycmF5LmZyb20obW9udGhseVN1bW1hcnkuc3RhZmZQZXJmb3JtYW5jZS52YWx1ZXMoKSkuc29ydCgoYSxiKSA9PiBiLnJldmVudWUgLSBhLnJldmVudWUpXHJcbiAgICAgIH07XHJcblxyXG4gICAgICByZXR1cm4geyBzdWNjZXNzOiB0cnVlLCBkYXRhOiBmaW5hbFJlcG9ydCB9O1xyXG5cclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoYEVycm9yIGdlbmVyYXRpbmcgbW9udGhseSByZXBvcnQgZm9yICR7bW9udGh9LyR7eWVhcn06YCwgZXJyb3IpO1xyXG4gICAgICByZXR1cm4gdGhpcy5oYW5kbGVFcnJvcihlcnJvcik7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgY29uc3QgcmVwb3J0c1NlcnZpY2UgPSBuZXcgUmVwb3J0c1NlcnZpY2UoKTsgIl0sIm5hbWVzIjpbImNvbGxlY3Rpb24iLCJkb2MiLCJnZXREb2NzIiwicXVlcnkiLCJ3aGVyZSIsIlRpbWVzdGFtcCIsImdldERvYyIsInNldERvYyIsImRiIiwiQmFzZVNlcnZpY2UiLCJDT0xMRUNUSU9OUyIsIlNVQkNPTExFQ1RJT05TIiwiZm9ybWF0Iiwic3RhcnRPZkRheSIsImVuZE9mRGF5IiwiZ2V0SG91cnMiLCJjcmVhdGVFbXB0eURhaWx5UmVwb3J0IiwicmVwb3J0RGF0ZVN0ciIsInJlcG9ydFRpbWVzdGFtcCIsImlkIiwicmVwb3J0RGF0ZSIsImdlbmVyYXRlZEF0Iiwibm93IiwiZ2VuZXJhdGVkQnkiLCJpc0ZpbmFsaXplZCIsInNhbGVzTWV0cmljcyIsInRvdGFsT3JkZXJzIiwiY29tcGxldGVkT3JkZXJzIiwiY2FuY2VsbGVkT3JkZXJzIiwicGVuZGluZ09yZGVycyIsInRvdGFsUmV2ZW51ZSIsInRvdGFsUXVhbnRpdHlTb2xkIiwiYXZlcmFnZU9yZGVyVmFsdWUiLCJwYXltZW50TWV0aG9kcyIsImhvdXJseUJyZWFrZG93biIsIkFycmF5IiwiZnJvbSIsImxlbmd0aCIsIl8iLCJpIiwiaG91ciIsIm9yZGVycyIsInJldmVudWUiLCJwcm9kdWN0UGVyZm9ybWFuY2UiLCJ0b3RhbFByb2R1Y3RzU29sZCIsInVuaXF1ZVByb2R1Y3RzU29sZCIsInRvcFByb2R1Y3RzIiwiY2F0ZWdvcnlCcmVha2Rvd24iLCJ0b3BWYXJpYW50cyIsInN0YWZmUGVyZm9ybWFuY2UiLCJhY3RpdmVTdGFmZiIsInN0YWZmTWV0cmljcyIsInRvcFNhbGVzUGVyc29uIiwic3RhZmZJZCIsInN0YWZmTmFtZSIsImN1c3RvbWVyTWV0cmljcyIsInRvdGFsQ3VzdG9tZXJzIiwibmV3Q3VzdG9tZXJzIiwicmV0dXJuaW5nQ3VzdG9tZXJzIiwidmlwQ3VzdG9tZXJzIiwiY3VzdG9tZXJTZWdtZW50cyIsImludmVudG9yeU1ldHJpY3MiLCJpdGVtc1NvbGQiLCJzdG9ja01vdmVtZW50cyIsImxvd1N0b2NrQWxlcnRzIiwib3V0T2ZTdG9ja0l0ZW1zIiwidG9wTW92aW5nSXRlbXMiLCJyZXR1cm5NZXRyaWNzIiwidG90YWxSZXR1cm5zIiwicmV0dXJuVmFsdWUiLCJyZXR1cm5SYXRlIiwiZXhjaGFuZ2VDb3VudCIsInJlZnVuZEFtb3VudCIsInJldHVyblJlYXNvbnMiLCJmaW5hbmNpYWxTdW1tYXJ5IiwiZ3Jvc3NSZXZlbnVlIiwiZGlzY291bnRBbW91bnQiLCJ0YXhBbW91bnQiLCJuZXRSZXZlbnVlIiwidG90YWxDb3N0IiwiZ3Jvc3NQcm9maXQiLCJncm9zc1Byb2ZpdE1hcmdpbiIsImNvbXBhcmF0aXZlTWV0cmljcyIsInByZXZpb3VzRGF5IiwicmV2ZW51ZUdyb3d0aCIsIm9yZGVyR3Jvd3RoIiwiY3VzdG9tZXJHcm93dGgiLCJwcmV2aW91c1dlZWsiLCJhdmVyYWdlT3JkZXJWYWx1ZUdyb3d0aCIsIm1vbnRoVG9EYXRlIiwidGFyZ2V0UHJvZ3Jlc3MiLCJvcGVyYXRpb25hbE1ldHJpY3MiLCJhdmVyYWdlSXRlbXNQZXJPcmRlciIsIm9yZGVyc1BlclN0YWZmIiwicmV2ZW51ZVBlclN0YWZmIiwicGVha0hvdXJzIiwicXVhbGl0eU1ldHJpY3MiLCJjdXN0b21lckNvbXBsYWludHMiLCJ3YXJyYW50eUlzc3VlcyIsInByb2R1Y3REZWZlY3RzIiwiY3JlYXRlZEF0IiwidXBkYXRlZEF0IiwiY3JlYXRlZEJ5IiwidXBkYXRlZEJ5IiwiUmVwb3J0c1NlcnZpY2UiLCJnZXRPckdlbmVyYXRlRGFpbHlSZXBvcnQiLCJ1c2VySWQiLCJyZXBvcnRSZWYiLCJjb2xsZWN0aW9uTmFtZSIsInJlcG9ydERvYyIsImV4aXN0cyIsImNvbnNvbGUiLCJsb2ciLCJzdWNjZXNzIiwiZGF0YSIsImRhaWx5UmVwb3J0IiwiZnJvbURhdGUiLCJzdGFydCIsImVuZCIsIm9yZGVyc1JlZiIsIlNBTEVTX09SREVSUyIsInEiLCJvcmRlclNuYXBzaG90cyIsImRvY3MiLCJtYXAiLCJhbGxJdGVtcyIsIm9yZGVyIiwiaXRlbXNSZWYiLCJJVEVNUyIsIml0ZW1zU25hcHNob3QiLCJmb3JFYWNoIiwicHVzaCIsImZpbHRlciIsIm8iLCJzdGF0dXMiLCJzbSIsInN0YXJ0c1dpdGgiLCJyZWR1Y2UiLCJzdW0iLCJ0b3RhbEFtb3VudCIsInRvdGFsUXVhbnRpdHkiLCJwbSIsInBheW1lbnRNZXRob2QiLCJvcmRlckNvdW50IiwicGVyY2VudGFnZSIsIm9yZGVyRGF0ZSIsInRvRGF0ZSIsIk9iamVjdCIsImtleXMiLCJrZXkiLCJmcyIsInN1YnRvdGFsQW1vdW50IiwiaXRlbSIsInNvbWUiLCJzYWxlc09yZGVySWQiLCJ1bml0Q29zdCIsInBwIiwic29sZEl0ZW1zIiwicHJvZHVjdFNhbGVzIiwidmFyaWFudFNhbGVzIiwicHJvZHVjdElkIiwicHJvZHVjdE5hbWUiLCJxdWFudGl0eVNvbGQiLCJwcm9maXQiLCJxdWFudGl0eSIsImZpbmFsUHJpY2UiLCJ2YXJpYW50SWQiLCJjb2xvck5hbWUiLCJzdG9yYWdlQ2FwYWNpdHkiLCJ2YWx1ZXMiLCJzb3J0IiwiYSIsImIiLCJzbGljZSIsInAiLCJwcm9maXRNYXJnaW4iLCJzcCIsIm9yZGVyc1Byb2Nlc3NlZCIsImN1c3RvbWVycyIsIlNldCIsIm1ldHJpYyIsImN1c3RvbWVySWQiLCJhZGQiLCJtIiwiY3VzdG9tZXJDb3VudCIsInNpemUiLCJ0b3BTZWxsZXIiLCJjbSIsImN1c3RvbWVySWRzIiwibWVyZ2UiLCJlcnJvciIsImhhbmRsZUVycm9yIiwiZ2VuZXJhdGVEYWlseVJlcG9ydCIsImVtcHR5UmVwb3J0UmVmIiwiT1JERVJfSVRFTVMiLCJnZXRNb250aGx5UmVwb3J0IiwieWVhciIsIm1vbnRoIiwic3RhcnREYXRlIiwiRGF0ZSIsImVuZERhdGUiLCJkYWlseVJlcG9ydHNSZWYiLCJzbmFwc2hvdHMiLCJlbXB0eSIsImVycm9yQ29kZSIsImRhaWx5UmVwb3J0cyIsIm1vbnRobHlTdW1tYXJ5IiwicmVwb3J0TW9udGgiLCJ0b1N0cmluZyIsInBhZFN0YXJ0IiwidG90YWxEYXlzUmVwb3J0ZWQiLCJNYXAiLCJkYWlseSIsImV4aXN0aW5nIiwiZ2V0Iiwic2V0IiwicyIsImZpbmFsUmVwb3J0IiwiY29uc3RydWN0b3IiLCJSRVBPUlRTIiwicmVwb3J0c1NlcnZpY2UiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(app-pages-browser)/./src/lib/firebase/services/reports.service.ts\n"));

/***/ })

});