exports.id=530,exports.ids=[530],exports.modules={38018:(e,r,t)=>{Promise.resolve().then(t.t.bind(t,12994,23)),Promise.resolve().then(t.t.bind(t,96114,23)),Promise.resolve().then(t.t.bind(t,9727,23)),Promise.resolve().then(t.t.bind(t,79671,23)),Promise.resolve().then(t.t.bind(t,41868,23)),Promise.resolve().then(t.t.bind(t,84759,23))},40506:(e,r,t)=>{Promise.resolve().then(t.bind(t,26005)),Promise.resolve().then(t.bind(t,94001)),Promise.resolve().then(t.bind(t,10049))},26005:(e,r,t)=>{"use strict";t.d(r,{QueryProvider:()=>i});var s=t(10326);t(17577);var a=t(2659),o=t(44976);let n=new a.S({defaultOptions:{queries:{staleTime:3e5,gcTime:6e5,retry:(e,r)=>!(r?.status>=400&&r?.status<500)&&e<3,refetchOnWindowFocus:!1},mutations:{retry:1}}}),i=({children:e})=>(0,s.jsxs)(o.aH,{client:n,children:[e,!1]})},94001:(e,r,t)=>{"use strict";t.d(r,{AuthProvider:()=>d,aC:()=>u});var s=t(10326),a=t(17577),o=t(35957),n=t(76),i=t(90445),l=t(99106);let c=(0,a.createContext)(void 0);function d({children:e}){let[r,t]=(0,a.useState)(null),[d,u]=(0,a.useState)(null),[m,p]=(0,a.useState)(!1),[h,w]=(0,a.useState)(!0),y=(0,a.useCallback)((e,r)=>({uid:e.uid,email:e.email,displayName:r.displayName,role:r.role,isActive:r.isActive,permissions:r.permissions}),[]),g=(0,a.useCallback)(async e=>{try{let r=(0,n.JU)(i.db,"users",e);await (0,n.r7)(r,{lastLoginAt:n.EK.now(),totalLogins:(d?.totalLogins||0)+1,updatedAt:n.EK.now()})}catch(e){console.error("Failed to update last login:",e)}},[d?.totalLogins]),v=(0,a.useCallback)(async e=>{p(!0);try{let r=(await (0,o.e5)(i.I8,e.email,e.password)).user,s=(0,n.JU)(i.db,"users",r.uid),a=await (0,n.QT)(s);if(!a.exists())throw Error("User profile not found. Please contact administrator.");let l=a.data();if(!l.isActive)throw await (0,o.w7)(i.I8),Error("Account is deactivated. Please contact administrator.");if(l.isDeleted)throw await (0,o.w7)(i.I8),Error("Account not found. Please contact administrator.");if(l.accountLockedUntil&&l.accountLockedUntil.toDate()>new Date){await (0,o.w7)(i.I8);let e=l.accountLockedUntil.toDate().toLocaleString();throw Error(`Account is locked until ${e}. Please contact administrator.`)}await g(r.uid);let c=y(r,l);return t(c),u(l),c}catch(e){throw console.error("Login failed:",e),Error(e.message||"Login failed. Please try again.")}finally{p(!1)}},[y,g]),f=(0,a.useCallback)(async()=>{p(!0);try{await (0,o.w7)(i.I8),t(null),u(null)}catch(e){throw console.error("Logout failed:",e),Error("Logout failed. Please try again.")}finally{p(!1)}},[]),P=(0,a.useCallback)(async e=>{p(!0);try{let r=(await (0,o.Xb)(i.I8,e.email,e.password)).user,s={id:r.uid,email:e.email,displayName:e.displayName,firstName:e.firstName,lastName:e.lastName,phone:e.phone,role:e.role,permissions:[],customPermissions:[],employeeId:e.employeeId,department:e.department,position:e.position,assignedStores:e.assignedStores||[],primaryStore:e.primaryStore,canAccessAllStores:"admin"===e.role,isActive:!0,isEmailVerified:!1,isPhoneVerified:!1,totalLogins:0,twoFactorEnabled:!1,preferences:{theme:"light",language:"vi",notifications:{email:!0,sms:!1,push:!0,lowStock:!0,newOrders:!0,returns:!0},dashboard:{defaultView:"overview",widgets:["sales","inventory","orders"]}},performance:"sales_staff"===e.role?{currentMonthSales:0,lastMonthSales:0,salesGrowth:0,averageOrderValue:0,totalOrdersProcessed:0,returnRate:0}:void 0,failedLoginAttempts:0,isDeleted:!1,createdAt:n.EK.now(),updatedAt:n.EK.now(),createdBy:i.I8.currentUser?.uid||"system",updatedBy:i.I8.currentUser?.uid||"system",mustChangePassword:e.mustChangePassword||!1,notes:e.notes,tags:e.tags},a=(0,n.JU)(i.db,"users",r.uid);await (0,n.pl)(a,s);let l=y(r,s);return t(l),u(s),l}catch(e){throw console.error("Registration failed:",e),Error(e.message||"Registration failed. Please try again.")}finally{p(!1)}},[y]),_=(0,a.useCallback)(async e=>{p(!0);try{await (0,o.LS)(i.I8,e)}catch(e){throw console.error("Password reset failed:",e),Error(e.message||"Failed to send password reset email.")}finally{p(!1)}},[]),x=(0,a.useCallback)(async e=>{if(!i.I8.currentUser)throw Error("No authenticated user found.");if(e.newPassword!==e.confirmPassword)throw Error("New passwords do not match.");p(!0);try{let r=o.w9.credential(i.I8.currentUser.email,e.currentPassword);if(await (0,o.aF)(i.I8.currentUser,r),await (0,o.gQ)(i.I8.currentUser,e.newPassword),d){let e=(0,n.JU)(i.db,"users",i.I8.currentUser.uid);await (0,n.r7)(e,{passwordLastChanged:n.EK.now(),mustChangePassword:!1,updatedAt:n.EK.now()})}}catch(e){throw console.error("Password change failed:",e),Error(e.message||"Failed to change password.")}finally{p(!1)}},[d]),b=(0,a.useCallback)(async()=>{if(i.I8.currentUser)try{let e=(0,n.JU)(i.db,"users",i.I8.currentUser.uid),r=await (0,n.QT)(e);if(r.exists()){let e=r.data(),s=y(i.I8.currentUser,e);t(s),u(e)}}catch(e){console.error("Failed to refresh user:",e)}},[y]),S=(0,a.useCallback)(async e=>{if(!i.I8.currentUser||!d)throw Error("No authenticated user found.");p(!0);try{let r=(0,n.JU)(i.db,"users",i.I8.currentUser.uid),t={...e,updatedAt:n.EK.now(),updatedBy:i.I8.currentUser.uid};await (0,n.r7)(r,t),await b()}catch(e){throw console.error("Failed to update user profile:",e),Error(e.message||"Failed to update profile.")}finally{p(!1)}},[d,b]),I=(0,a.useCallback)(e=>!!d&&(0,l.Fs)(d,e),[d]),A=(0,a.useCallback)((e,r,t)=>d?(0,l.av)(d,e,r,t):{hasPermission:!1,reason:"User not authenticated"},[d]),C=(0,a.useCallback)(e=>!!d&&(Array.isArray(e)?e.includes(d.role):d.role===e),[d]),k=(0,a.useCallback)(()=>r&&i.I8.currentUser?{user:r,accessToken:"",expiresAt:Date.now()+864e5}:null,[r]),E=(0,a.useCallback)(()=>!!r&&!!i.I8.currentUser,[r]),U=(0,a.useCallback)(()=>!!r&&r.isActive,[r]);return s.jsx(c.Provider,{value:{user:r,userDocument:d,loading:m,initializing:h,login:v,logout:f,register:P,resetPassword:_,changePassword:x,refreshUser:b,updateUserProfile:S,hasPermission:I,canAccess:A,isRole:C,getSession:k,isAuthenticated:E,isActive:U},children:e})}function u(){let e=(0,a.useContext)(c);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}},10049:(e,r,t)=>{"use strict";t.d(r,{ThemeProvider:()=>n});var s=t(10326),a=t(17577);let o=(0,a.createContext)(void 0),n=({children:e})=>{let[r,t]=(0,a.useState)("system"),[n,i]=(0,a.useState)("light");return(0,a.useEffect)(()=>{let e=localStorage.getItem("theme");e&&t(e)},[]),(0,a.useEffect)(()=>{let e=()=>{let e="light";i(e="system"===r?window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light":r);let t=document.documentElement;t.classList.remove("light","dark"),t.classList.add(e),localStorage.setItem("theme",r)};e();let t=window.matchMedia("(prefers-color-scheme: dark)"),s=()=>{"system"===r&&e()};return t.addEventListener("change",s),()=>t.removeEventListener("change",s)},[r]),s.jsx(o.Provider,{value:{theme:r,setTheme:t,actualTheme:n},children:e})}},90445:(e,r,t)=>{"use strict";t.d(r,{I8:()=>c,db:()=>d});var s=t(42585),a=t(35957),o=t(76),n=t(11552);let i={apiKey:"AIzaSyBPy7aOXz5I8cjrVMxzyDSD-DUM4n4622I",authDomain:"phone-store-management-2025.firebaseapp.com",projectId:"phone-store-management-2025",storageBucket:"phone-store-management-2025.appspot.com",messagingSenderId:"796918304116",appId:"1:796918304116:web:537c49dd91cc9bbdba3021"},l=(0,s.C6)().length?(0,s.Mq)():(0,s.ZF)(i),c=(0,a.v0)(l),d=(0,o.ad)(l);(0,n.cF)(l),i.projectId,i.authDomain,i.storageBucket},99106:(e,r,t)=>{"use strict";t.d(r,{Bv:()=>s,Fs:()=>a,av:()=>o,fi:()=>n});let s={admin:{name:"Administrator",level:100,permissions:["system.*","users.*","roles.*","permissions.*","stores.*","settings.*","audit.*","inventory.*","sales.*","customers.*","suppliers.*","reports.*","returns.*","warranty.*"]},store_manager:{name:"Store Manager",level:80,permissions:["users.read","users.update","users.create","inventory.read","inventory.create","inventory.update","inventory.delete","inventory.adjust","inventory.transfer","sales.read","sales.create","sales.update","sales.process_returns","sales.apply_discounts","sales.override_prices","customers.read","customers.create","customers.update","customers.delete","reports.read","reports.create","reports.export","analytics.read","suppliers.read","suppliers.create","suppliers.update","settings.read","settings.update"]},sales_staff:{name:"Sales Staff",level:50,permissions:["sales.read","sales.create","sales.update_own","sales.process_simple_returns","inventory.read","inventory.check_availability","inventory.reserve","customers.read","customers.create","customers.update","reports.read_own","reports.daily_summary","products.read","warranty.check","users.read_own","users.update_own"]},warehouse_staff:{name:"Warehouse Staff",level:40,permissions:["inventory.read","inventory.create","inventory.update","inventory.receive","inventory.move","inventory.count","inventory.adjust","products.read","products.create","products.update","suppliers.read","purchase_orders.read","purchase_orders.receive","sales.read","sales.process_returns","reports.inventory","reports.stock_movements","users.read_own","users.update_own"]},viewer:{name:"Viewer",level:10,permissions:["products.read","inventory.read","sales.read","customers.read","reports.read","users.read_own","warranty.check"]}};function a(e,r){if("admin"===e.role||e.permissions.includes(r)||e.customPermissions?.includes(r))return!0;let t=r.split(".");for(let r=t.length-1;r>=0;r--){let s=t.slice(0,r).join(".")+".*";if(e.permissions.includes(s)||e.customPermissions?.includes(s))return!0}return!1}function o(e,r,t,s){let o=`${r}.${t}`;return a(e,o)?o.endsWith("_own")&&s&&(s.userId||s.createdBy||s.staffId)!==e.id?{hasPermission:!1,reason:"Can only access own resources"}:{hasPermission:!0}:{hasPermission:!1,reason:"Insufficient permissions",requiredPermissions:[o]}}function n(e){return Array.from(new Set([...s[e.role]?.permissions||[],...e.customPermissions||[]]))}},26682:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>u,metadata:()=>d});var s=t(19510),a=t(25384),o=t.n(a);t(5023);var n=t(68570);let i=(0,n.createProxy)(String.raw`D:\phone_store_management\phone_store_management\src\contexts\AuthContext.tsx#AuthProvider`);(0,n.createProxy)(String.raw`D:\phone_store_management\phone_store_management\src\contexts\AuthContext.tsx#useAuth`),(0,n.createProxy)(String.raw`D:\phone_store_management\phone_store_management\src\contexts\AuthContext.tsx#withAuth`),(0,n.createProxy)(String.raw`D:\phone_store_management\phone_store_management\src\contexts\AuthContext.tsx#PermissionGuard`),(0,n.createProxy)(String.raw`D:\phone_store_management\phone_store_management\src\contexts\AuthContext.tsx#default`);let l=(0,n.createProxy)(String.raw`D:\phone_store_management\phone_store_management\src\components\providers\QueryProvider.tsx#QueryProvider`),c=(0,n.createProxy)(String.raw`D:\phone_store_management\phone_store_management\src\contexts\ThemeContext.tsx#ThemeProvider`);(0,n.createProxy)(String.raw`D:\phone_store_management\phone_store_management\src\contexts\ThemeContext.tsx#useTheme`);let d={title:"iPhone Store POS",description:"Point of Sale system for iPhone retail store"};function u({children:e}){return s.jsx("html",{lang:"vi",suppressHydrationWarning:!0,children:s.jsx("body",{className:o().className,children:s.jsx(c,{children:s.jsx(l,{children:s.jsx(i,{children:e})})})})})}},5023:()=>{}};